import{j as e,B as t,T as r,o,t as i,I as n,O as a,Q as l,U as s,V as c}from"./mui-vendor-DK3B2xlb.js";import{u as d,a as u}from"./react-vendor-ClEFeRSO.js";import{C as p}from"./ConsoleView-DB8WlF7b.js";import{u as h,R as g,a as m}from"./index--WIifFJF.js";import{P as x,c as b,b as f,e as S,C as A,a as I,I as y,V as C,f as E,g as T,h as w,i as D,F as v,J as N,H as j}from"./cesium-vendor-CfPU8cLI.js";import"./chart-vendor-DoSG9uj3.js";import"./three-vendor-h_9TO6AE.js";const L=({open:t=!0,isPopup:r=!1})=>e.jsx(p,{type:"fusionDB",open:t,isPopup:r}),R="/api/north-korea-attacks",O={SOURCE:{NORMAL:b.YELLOW,OUTLINE:b.RED,HIGHLIGHT:b.ORANGE},TARGET:{NORMAL:b.CYAN,OUTLINE:b.BLUE,HIGHLIGHT:b.LIME},HIGHLIGHT_OUTLINE:b.WHITE},k=document.createElement("style");k.textContent="\n  @keyframes pulse {\n    0% { box-shadow: 0 0 10px rgba(124,58,237,0.4); }\n    50% { box-shadow: 0 0 20px rgba(124,58,237,0.6); }\n    100% { box-shadow: 0 0 10px rgba(124,58,237,0.4); }\n  }\n",document.head.appendChild(k),y.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIzODNiZmZiNC04YTUxLTQ1YzgtOWU1Mi1kNDUyY2I2ZDRkNTQiLCJpZCI6MzQyNDEzLCJpYXQiOjE3NTgxNzMyNDh9.zZRyMPovg5ALhNtG2_E-0ED0qHqd_uQQnAG84eQUyG4";const M=e=>{const t={"ì¤‘êµ­":["AS4134 CHINANET","AS4837 CHINA169","AS9808 CMNET","AS24400 ALIBABA"],China:["AS4134 CHINANET","AS4837 CHINA169","AS9808 CMNET","AS24400 ALIBABA"],"ëŸ¬ì‹œì•„":["AS8359 MTS","AS12389 ROSTELECOM","AS31133 MF-MGSM","AS42610 NCNET"],Russia:["AS8359 MTS","AS12389 ROSTELECOM","AS31133 MF-MGSM","AS42610 NCNET"],"ë¶í•œ":["AS131279 STAR-KP","AS9769 DPRK-AS","AS17762 KPTC-AS"],"North Korea":["AS131279 STAR-KP","AS9769 DPRK-AS","AS17762 KPTC-AS"],"ì´ëž€":["AS44244 IRANCELL","AS6736 BARIN","AS197207 MCCI","AS58224 TCI"],Iran:["AS44244 IRANCELL","AS6736 BARIN","AS197207 MCCI","AS58224 TCI"],"ë¯¸êµ­":["AS15169 GOOGLE","AS8075 MICROSOFT","AS16509 AMAZON","AS32934 FACEBOOK"],"United States":["AS15169 GOOGLE","AS8075 MICROSOFT","AS16509 AMAZON","AS32934 FACEBOOK"],"ì¼ë³¸":["AS2516 KDDI","AS4713 NTT","AS2497 IIJ","AS7506 GMO"],Japan:["AS2516 KDDI","AS4713 NTT","AS2497 IIJ","AS7506 GMO"],"ë…ì¼":["AS3320 DEUTSCHE","AS8881 1&1","AS20940 AKAMAI","AS24940 HETZNER"],Germany:["AS3320 DEUTSCHE","AS8881 1&1","AS20940 AKAMAI","AS24940 HETZNER"],"ì˜êµ­":["AS2856 BT","AS5089 VIRGIN","AS12576 EE","AS13037 ZEN"],"United Kingdom":["AS2856 BT","AS5089 VIRGIN","AS12576 EE","AS13037 ZEN"],"ëŒ€í•œë¯¼êµ­":["AS9318 SKB","AS4766 KT","AS9644 LGU","AS17858 LG-DACOM"],"South Korea":["AS9318 SKB","AS4766 KT","AS9644 LGU","AS17858 LG-DACOM"],Burundi:["AS37578 AS-KONNECT","AS37054 USAN","AS36945 ONATEL"],default:["AS0 UNKNOWN"]},r=t[e.name]||t.default;return r[Math.floor(Math.random()*r.length)]},B=(e,t)=>e&&t?e.find(e=>e.id===t||e.id===t.toString()||e.id===parseInt(t)):null,H=(e,t)=>{if(!e||!e.point)return;const r=t.includes("source");e.point.color=r?O.SOURCE.NORMAL:O.TARGET.NORMAL,e.point.outlineColor=r?O.SOURCE.OUTLINE:O.TARGET.OUTLINE,e.point.outlineWidth=2,e.point.pixelSize=6},G=(e,t)=>{e&&e.point&&(e.point.color=t?O.SOURCE.HIGHLIGHT:O.TARGET.HIGHLIGHT,e.point.outlineColor=O.HIGHLIGHT_OUTLINE,e.point.outlineWidth=4,e.point.pixelSize=10,e.point.disableDepthTestDistance=Number.POSITIVE_INFINITY)},F=e=>{const t=document.getElementById(`log-${e}`);t&&(t.scrollIntoView({behavior:"smooth",block:"center"}),t.style.animation="pulse 1.2s ease-out 1",setTimeout(()=>{t.style.animation=""},1300))},P=async(e=null,t=null)=>{try{let r=`http://localhost:5000${R}?limit=20`;e&&(r+=`&startDate=${e.toISOString()}`),t&&(r+=`&endDate=${t.toISOString()}`);const o=await fetch(r);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const i=await o.json();if(!i.success)return[];const n=i.attacks.map(e=>({id:e.id,source:{name:e.source.name,building:{name:e.source.city||e.source.name,lat:e.source.lat,lon:e.source.lon},ip:e.source.ip,port:e.source.port,subnet:e.source.subnet,gateway:e.source.gateway,dns:e.source.dns,as:M({name:e.source.name})},target:{name:e.target.name,building:{name:e.target.city||"North Korea",lat:e.target.lat,lon:e.target.lon},ip:e.target.ip,port:e.target.port,subnet:e.target.subnet,gateway:e.target.gateway,dns:e.target.dns,as:M({name:"North Korea"})},type:e.protocol,severity:Math.min(5,Math.ceil(e.count/5)),timestamp:new Date(e.timestamp),status:e.status,count:e.count}));return n.forEach((e,t)=>{}),n}catch(r){return[]}},U=()=>{const p=d(),y=u.useRef(null),R=u.useRef(null),k=u.useRef(null),[M,U]=u.useState(!1),[_,z]=u.useState(null),[K,$]=u.useState([]),{popups:W,openPopup:V,closePopup:Z}=h(),J=W.fusionDB;u.useEffect(()=>{W.fusionDB},[W.fusionDB]);const[q,Y]=u.useState([]),[Q,X]=u.useState([0,7]),ee=u.useMemo(()=>K&&0!==K.length?{total:K.length,active:K.length,blocked:0,countries:new Set([...K.map(e=>e.source.name),...K.map(e=>e.target.name)]).size}:{total:0,active:0,blocked:0,countries:0},[K]),te=u.useMemo(()=>new Date("2025-09-02T00:00:00Z"),[]),re=u.useMemo(()=>new Date("2025-09-08T23:59:59Z"),[]),oe=u.useMemo(()=>{if(!q||0===q.length)return[];const e=te.getTime(),t=e+24*Q[0]*60*60*1e3,r=e+24*Q[1]*60*60*1e3;return q.filter(e=>{const o=new Date(e.timestamp).getTime(),i=o>=t&&o<=r;return q.indexOf(e),i})},[q,Q,te]);u.useEffect(()=>{$(oe)},[oe]),u.useEffect(()=>{(async()=>{const e=[];for(let r=0;r<7;r++){const t=new Date(Date.UTC(2025,8,2+r,0,0,0,0)),o=new Date(Date.UTC(2025,8,2+r,23,59,59,999));e.push(P(t,o).then(e=>e.slice(0,20).map(e=>({...e,id:`day${r}-${e.id}`}))).catch(e=>[]))}const t=(await Promise.all(e)).flat();t.length,Y(t),X([0,7])})()},[te,re]),u.useEffect(()=>{if(y.current)return(async()=>{try{R.current=new C(y.current,{animation:!1,baseLayerPicker:!0,fullscreenButton:!1,geocoder:!0,homeButton:!0,infoBox:!0,sceneModePicker:!1,scene3DOnly:!1,selectionIndicator:!0,timeline:!1,navigationHelpButton:!1,navigationInstructionsInitiallyVisible:!1,terrainProvider:await E({requestWaterMask:!0,requestVertexNormals:!0}),requestRenderMode:!1,maximumRenderTimeChange:1/0}),R.current.scene.morphTo2D(0);try{const e=await T({style:w.AERIAL_WITH_LABELS});R.current.imageryLayers.addImageryProvider(e)}catch(e){}const t=R.current.scene,r=t.globe;t.skyAtmosphere.show=!0,t.fog.enabled=!0,t.fog.density=1e-4,t.fog.screenSpaceErrorFactor=2,r.enableLighting=!0,r.dynamicAtmosphereLighting=!0,r.atmosphereLightIntensity=10,r.showWaterEffect=!0,r.maximumScreenSpaceError=1,r.tileCacheSize=1e3,t.screenSpaceCameraController.enableRotate=!1,t.screenSpaceCameraController.enableTranslate=!0,t.screenSpaceCameraController.enableZoom=!0,t.screenSpaceCameraController.enableTilt=!1,t.screenSpaceCameraController.enableLook=!1,t.screenSpaceCameraController.enableInputs=!0,t.screenSpaceCameraController.minimumZoomDistance=100,t.screenSpaceCameraController.maximumZoomDistance=4e7,t.screenSpaceCameraController.translateEventTypes=[D.LEFT_DRAG,D.RIGHT_DRAG],t.screenSpaceCameraController.zoomEventTypes=[D.WHEEL,D.PINCH],t.screenSpaceCameraController.zoomFactor=5,t.screenSpaceCameraController.wheelZoomFactor=10,t.screenSpaceCameraController.inertiaSpin=.95,t.screenSpaceCameraController.inertiaTranslate=.95,t.screenSpaceCameraController.inertiaZoom=.9,t.camera.moveEnd.addEventListener(()=>{const e=t.camera.positionCartographic.height;if(e>=38e6){const r=t.camera.positionCartographic,o=125.7625,i=0,n=Math.abs(A.toDegrees(r.longitude)-o),a=Math.abs(A.toDegrees(r.latitude)-i);(n>30||a>30)&&t.camera.flyTo({destination:I.fromDegrees(o,i,e),orientation:{heading:0,pitch:-A.PI_OVER_TWO,roll:0},duration:1})}}),R.current.cesiumWidget.creditContainer.style.display="none",R.current.screenSpaceEventHandler.setInputAction(e=>{const r=R.current.camera.pickEllipsoid(e.position,t.globe.ellipsoid);if(r){const e=S.fromCartesian(r);A.toDegrees(e.longitude),A.toDegrees(e.latitude),e.height}},f.LEFT_CLICK);const o={destination:I.fromDegrees(125.7625,39.0392,5e6),orientation:{heading:0,pitch:-A.PI_OVER_TWO,roll:0}};setTimeout(()=>{R.current.camera.setView(o)},500),R.current.homeButton&&R.current.homeButton.viewModel.command.beforeExecute.addEventListener(e=>{e.cancel=!0,R.current.camera.setView(o)}),v.supportsImageRenderingPixelated()&&(R.current.resolutionScale=window.devicePixelRatio),t.postProcessStages.fxaa.enabled=!0,R.current.clock.shouldAnimate=!0,R.current.clock.multiplier=1,R.current.clock.currentTime=N.now(),t.requestRenderMode=!1,t.maximumRenderTimeChange=1/0;let i=null;const n=()=>{R.current&&!R.current.isDestroyed()&&(t.requestRender(),i=requestAnimationFrame(n))};n();const a=setInterval(()=>{R.current&&!R.current.isDestroyed()&&R.current.clock.tick()},16);R.current._cleanupIds={animationFrameId:i,clockIntervalId:a},U(!0)}catch(e){z(`Cesium ì´ˆê¸°í™” ì‹¤íŒ¨: ${e.message}`)}})(),()=>{R.current&&(R.current._cleanupIds&&(R.current._cleanupIds.animationFrameId&&cancelAnimationFrame(R.current._cleanupIds.animationFrameId),R.current._cleanupIds.clockIntervalId&&clearInterval(R.current._cleanupIds.clockIntervalId)),R.current.destroy(),R.current=null)}},[]);const[ie,ne]=u.useState([]),[ae,le]=u.useState(null),[se,ce]=u.useState([]),[de,ue]=u.useState([]),[pe,he]=u.useState([]),ge=u.useCallback(()=>{if(!R.current)return;const e=R.current.entities.values;for(let t=0;t<e.length;t++){const r=e[t];if(r&&r.id){const e=r.id;(e.startsWith("source-2d-")||e.startsWith("target-2d-"))&&H(r,e)}}for(let t=0;t<e.length;t++){const r=e[t];r&&r.id&&r.id.startsWith("beam-2d-")&&r.polyline&&r.polyline.material&&(r.polyline.material=new x({glowPower:.05,color:b.RED.withAlpha(.08)}))}ue([]),he([])},[]),me=u.useCallback(e=>{if(!R.current||!K)return;const t=B(K,e);if(!t)return;de.forEach(e=>{const t=R.current.entities.getById(e);t&&H(t,e);const r=e.replace(/^(source|target)-2d-/,"beam-2d-"),o=R.current.entities.getById(r);o&&o.polyline&&o.polyline.material&&(o.polyline.material=new x({glowPower:.05,color:b.RED.withAlpha(.08)}))});const r=`target-2d-${t.id}`,o=`source-2d-${t.id}`,i=`beam-2d-${t.id}`,n=R.current.entities.getById(r),a=R.current.entities.getById(o),l=R.current.entities.getById(i),s=[];n&&(G(n,!1),s.push(r)),a&&(G(a,!0),s.push(o)),l&&l.polyline&&l.polyline.material&&(l.polyline.material=new x({glowPower:.15,color:b.BLUE.withAlpha(.6)})),ue(s)},[K,de]),xe=u.useCallback((e,t)=>{if(!R.current||!K)return;ge();const r=t.includes("target"),o=r?e.target.building.lat:e.source.building.lat,i=r?e.target.building.lon:e.source.building.lon,n=r?K.filter(e=>e.target.building.lat===o&&e.target.building.lon===i):K.filter(e=>e.source.building.lat===o&&e.source.building.lon===i);if(0===n.length)return;const a=[];n.forEach(e=>{const t=`source-2d-${e.id}`,r=`target-2d-${e.id}`,o=`beam-2d-${e.id}`,i=R.current.entities.getById(t),n=R.current.entities.getById(r),l=R.current.entities.getById(o);i&&(G(i,!0),a.push(t)),n&&(G(n,!1),a.push(r)),l&&l.polyline&&l.polyline.material&&(l.polyline.material=new x({glowPower:.15,color:b.BLUE.withAlpha(.6)}))}),he(a);const l=n.map(e=>e.id);ce(l),le(null),n.length>0&&F(n[0].id)},[K,ge]);return u.useCallback((e,t)=>{if(!R.current||!K)return;ge();const r=t.includes("source")?e.source.ip:e.target.ip,o=K.filter(e=>e.source.ip===r||e.target.ip===r);if(o.length>0){const e=[];o.forEach(t=>{const o=`source-2d-${t.id}`,i=`target-2d-${t.id}`,n=`beam-2d-${t.id}`,a=R.current.entities.getById(o),l=R.current.entities.getById(i),s=R.current.entities.getById(n);a&&t.source.ip===r&&(G(a,!0),e.push(o)),l&&t.target.ip===r&&(G(l,!1),e.push(i)),s&&s.polyline&&s.polyline.material&&(s.polyline.material=new x({glowPower:.15,color:b.BLUE.withAlpha(.6)}))}),he(e);const t=o.map(e=>e.id);ce(t),le(null),o.length>0&&F(o[0].id)}},[K,ge]),u.useEffect(()=>{if(R.current&&M&&K&&0!==K.length){try{R.current.entities.removeAll(),ie.forEach(e=>{e.interval&&clearInterval(e.interval)}),ne([]),(e=>{if(R.current&&e&&0!==e.length)try{e.forEach((e,t)=>{const r=parseFloat(e.source.building.lon),o=parseFloat(e.source.building.lat),i=parseFloat(e.target.building.lon),n=parseFloat(e.target.building.lat);if(isNaN(r)||isNaN(o)||isNaN(i)||isNaN(n))return;const a=I.fromDegrees(r,o,0),l=I.fromDegrees(i,n,0);R.current.entities.add({id:`source-2d-${e.id}`,position:a,point:{pixelSize:6,color:O.SOURCE.NORMAL,outlineColor:O.SOURCE.OUTLINE,outlineWidth:2,heightReference:j.NONE,disableDepthTestDistance:Number.POSITIVE_INFINITY,show:!0},buildingData:{name:e.source.building.name,country:e.source.name,type:"source"}}),R.current.entities.add({id:`target-2d-${e.id}`,position:l,point:{pixelSize:6,color:O.TARGET.NORMAL,outlineColor:O.TARGET.OUTLINE,outlineWidth:2,heightReference:j.NONE,disableDepthTestDistance:Number.POSITIVE_INFINITY,show:!0},buildingData:{name:e.target.building.name,country:e.target.name,type:"target"}}),R.current.entities.add({id:`beam-2d-${e.id}`,polyline:{positions:[a,l],width:6,material:new x({glowPower:.05,color:b.RED.withAlpha(.08)}),clampToGround:!1,followSurface:!1,granularity:A.RADIANS_PER_DEGREE},description:`ðŸ”´ ì‚¬ì´ë²„ ìž‘ì „: ${e.source.name} â†’ ${e.target.name}`,attackData:e})})}catch(t){}})(K)}catch(e){}R.current.screenSpaceEventHandler&&(R.current.screenSpaceEventHandler.removeInputAction(f.LEFT_CLICK),R.current.screenSpaceEventHandler.removeInputAction(f.LEFT_DOUBLE_CLICK)),R.current.screenSpaceEventHandler.setInputAction(t=>{try{const e=R.current.scene.pick(t.position);if(e&&e.id){let t=null;e.id.id?t=e.id.id:e.id._id?t=e.id._id:"string"==typeof e.id&&(t=e.id),ge();const r=t&&t.startsWith("source-2d-"),o=t&&t.startsWith("target-2d-");if(r||o){let e=null;if(t.startsWith("source-2d-")?e=t.replace("source-2d-",""):t.startsWith("target-2d-")&&(e=t.replace("target-2d-","")),e){const r=B(K,e);if(r)return void xe(r,t)}}}le(null),ce([]),ge()}catch(e){}},f.LEFT_CLICK),R.current.screenSpaceEventHandler.setInputAction(t=>{try{const e=R.current.scene.pick(t.position);if(e&&e.id){let t=null;e.id.id?t=e.id.id:e.id._id?t=e.id._id:"string"==typeof e.id&&(t=e.id);const r=t&&t.startsWith("source-2d-"),o=t&&t.startsWith("target-2d-");if(r||o){const e=R.current.entities.getById(t);if(e&&e.position){const t=e.position.getValue(R.current.clock.currentTime);if(t){const e=S.fromCartesian(t),r=A.toDegrees(e.longitude),o=A.toDegrees(e.latitude);R.current.camera.flyTo({destination:I.fromDegrees(r,o,5e4),duration:1.5,complete:()=>{R.current.scene.screenSpaceCameraController.enableInputs=!0}})}}}}}catch(e){}},f.LEFT_DOUBLE_CLICK)}},[K,M]),_?e.jsxs(t,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",bgcolor:"#f5f5f5",borderRadius:2,p:2},children:[e.jsx(r,{color:"error",sx:{mb:2,textAlign:"center"},children:_}),e.jsxs(r,{variant:"body2",sx:{textAlign:"center",color:"text.secondary"},children:["1. https://cesium.com/ion/ ë°©ë¬¸",e.jsx("br",{}),"2. ë¬´ë£Œ ê³„ì • ìƒì„±",e.jsx("br",{}),"3. Access Token ë°œê¸‰",e.jsx("br",{}),"4. EarthGlobe.jsx íŒŒì¼ì˜ í† í° êµì²´"]})]}):e.jsxs(o,{component:"main",role:"main","aria-label":"2D ì§€ë„ ê¸°ë°˜ ì‚¬ì´ë²„ ê³µê²© ì‹œê°í™”",sx:{width:"100%",height:"calc(100vh - 120px)",bgcolor:"background.paper",boxShadow:3,m:0},children:[e.jsxs(i,{sx:{p:1,height:"100%","&:last-child":{pb:1},display:"flex",flexDirection:{xs:"column",lg:"row"},gap:1,overflow:"hidden"},children:[e.jsx(o,{component:"section","aria-label":"2D ì§€ë„ ì˜ì—­",sx:{flex:1,position:"relative",overflow:"hidden",height:"100%",bgcolor:"#000",border:"1px solid #333",boxShadow:"0 4px 12px rgba(0,0,0,0.3)"},children:e.jsxs(i,{sx:{p:0,height:"100%","&:last-child":{pb:0},position:"relative"},children:[e.jsx(n,{size:"small","aria-label":"3D ë©€í‹°ë ˆì´ì–´ë¡œ ì´ë™",title:"3D ë©€í‹°ë ˆì´ì–´ë¡œ ì´ë™",onClick:()=>p("/CyberObjectInfo/MultilayerVisualization"),sx:{position:"absolute",top:6.5,right:125,zIndex:1e3,bgcolor:"#222b33",color:"#fff",borderRadius:"5%",width:32,height:32,boxShadow:"0 2px 8px #222b33","&:hover":{bgcolor:"#5b89b1ff",color:"#fff"}},children:e.jsx(g,{style:{fontSize:18}})}),e.jsx("div",{ref:y,role:"img","aria-label":"ì‚¬ì´ë²„ ê³µê²© ê²½ë¡œë¥¼ í‘œì‹œí•˜ëŠ” 2D ì§€ë„",style:{width:"100%",height:"100%"}}),!M&&e.jsx(t,{role:"status","aria-live":"polite","aria-label":"ì§€ë„ ë¡œë”© ì¤‘",sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"rgba(0,0,0,0.8)",color:"white"},children:e.jsx(r,{children:"2D ëª¨ë“œ ë¡œë”© ì¤‘..."})}),M&&e.jsx(t,{sx:{position:"absolute",top:8,left:8,background:"rgba(0,0,0,0.7)",color:"white",padding:"4px 8px",borderRadius:1,fontSize:10},children:e.jsx(r,{variant:"caption",color:"inherit",children:"ðŸ—ºï¸ Osint ì •ë³´ ìˆ˜ì§‘"})}),M&&e.jsx(n,{size:"small","aria-label":"ìœµí•© ë°ì´í„°ë² ì´ìŠ¤ ì—´ê¸°",title:"ìœµí•© ë°ì´í„°ë² ì´ìŠ¤ ì—´ê¸°",onClick:()=>V("fusionDB"),sx:{position:"absolute",bottom:"1%",left:"98%",transform:"translateX(-50%)",zIndex:1e3,bgcolor:"#222b33",color:"#fff",borderRadius:"5%",width:48,height:48,boxShadow:"0 4px 12px #222b33","&:hover":{bgcolor:"#5b89b1ff",color:"#fff",transform:"translateX(-50%) scale(1.1)"},transition:"all 0.3s ease"},children:e.jsx(m,{style:{fontSize:24}})})]})}),e.jsxs(t,{component:"aside","aria-label":"ê³µê²© í˜„í™© íŒ¨ë„",sx:{width:{xs:"100%",lg:350},maxWidth:{xs:"100%",lg:400},display:"flex",flexDirection:"column",gap:2,height:"100%",overflow:"hidden"},children:[e.jsx(o,{component:"section","aria-label":"ì‹¤ì‹œê°„ ê³µê²© í†µê³„",sx:{bgcolor:"#f0edfd",color:"#333",border:"1px solid #d0c9f0",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",minHeight:0,flexShrink:0},children:e.jsx(i,{children:e.jsxs(a,{container:!0,spacing:2,children:[e.jsx(a,{item:!0,xs:6,children:e.jsxs(t,{sx:{textAlign:"center"},children:[e.jsx(r,{variant:"h4",sx:{color:"#7c3aed",fontWeight:"bold"},"aria-label":`ì´ ìž‘ì „ ìˆ˜ ${ee.total}ê°œ`,children:ee.total}),e.jsx(r,{variant:"body2",sx:{color:"#666"},children:"ì´ ìž‘ì „ ìˆ˜"})]})}),e.jsx(a,{item:!0,xs:6,children:e.jsxs(t,{sx:{textAlign:"center"},children:[e.jsx(r,{variant:"h4",sx:{color:"#9333ea",fontWeight:"bold"},"aria-label":`í™œì„± ìž‘ì „ ${ee.active}ê°œ`,children:ee.active}),e.jsx(r,{variant:"body2",sx:{color:"#666"},children:"í™œì„± ìž‘ì „"})]})})]})})}),e.jsx(o,{component:"section","aria-label":"ìµœê·¼ ê³µê²© ëª©ë¡",sx:{bgcolor:"transparent",color:"#333",flex:1,minHeight:0,border:"none",boxShadow:"none",display:"flex",flexDirection:"column"},children:e.jsx(i,{sx:{height:"100%",display:"flex",flexDirection:"column",flex:1,"&:last-child":{pb:2}},children:e.jsx(t,{ref:k,role:"list","aria-label":"ê³µê²© ë¡œê·¸ ëª©ë¡",sx:{flex:1,overflow:"auto",minHeight:0},children:K&&K.map((o,i)=>e.jsxs(t,{id:`log-${o.id}`,"data-attack-id":o.id,role:"listitem",tabIndex:0,"aria-label":`ê³µê²© ì •ë³´: ${o.type}, ${o.source.name}ì—ì„œ ${o.target.name}ë¡œ, ì¶œë°œì§€ IP ${o.source.ip}`,"aria-selected":ae===o.id||se.includes(o.id),sx:{p:1,mb:1,bgcolor:ae===o.id||se.includes(o.id)?"rgba(124,58,237,0.2)":"rgba(124,58,237,0.05)",borderRadius:1,borderLeft:"3px solid #7c3aed",border:ae===o.id||se.includes(o.id)?"2px solid #7c3aed":"none",boxShadow:ae===o.id||se.includes(o.id)?"0 0 10px rgba(124,58,237,0.4)":"none",animation:ae===o.id||se.includes(o.id)?"pulse 1.5s infinite":"none",cursor:"pointer",transition:"all 0.3s ease",position:"relative"},onClick:()=>{const e=ae===o.id?null:o.id;le(e),ce([]),e?(ge(),me(o.id)):ge()},children:[e.jsxs(r,{variant:"body2",sx:{fontWeight:"bold",color:"#333"},children:["ðŸ”´ ",o.type," - ì§„í–‰ì¤‘"]}),e.jsxs(r,{variant:"caption",sx:{color:"#666"},children:[o.source.name," â†’ ",o.target.name]}),e.jsxs(r,{variant:"caption",sx:{display:"block",color:"#888",fontSize:"10px"},children:["ì¶œë°œì§€ IP: ",o.source.ip,":",o.source.port]}),e.jsxs(r,{variant:"caption",sx:{display:"block",color:"#888",fontSize:"10px"},children:["ëŒ€ìƒ IP: ",o.target.ip,":",o.target.port]}),e.jsxs(r,{variant:"caption",sx:{display:"block",color:"#888",fontSize:"10px"},children:["Subnet: ",o.target.subnet," | Gateway: ",o.target.gateway]}),e.jsxs(r,{variant:"caption",sx:{display:"block",color:"#888",fontSize:"10px"},children:["DNS: ",o.target.dns," | Count: ",o.count]}),e.jsx(r,{variant:"caption",sx:{display:"block",color:"#888",fontSize:"10px"},children:o.timestamp.toLocaleString("ko-KR",{timeZone:"Asia/Seoul",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}),e.jsx(n,{size:"small","aria-label":"ë‚´ë¶€ë§ í† í´ë¡œì§€ë¡œ ì´ë™",title:"ë‚´ë¶€ë§ í† í´ë¡œì§€ë¡œ ì´ë™",onClick:e=>{e.stopPropagation(),p("/ExtInt/internaltopology")},sx:{position:"absolute",top:4,right:4,color:"#7c3aed",bgcolor:"rgba(124,58,237,0.1)",border:"1px solid rgba(124,58,237,0.3)","&:hover":{bgcolor:"rgba(124,58,237,0.2)",color:"#9333ea"},width:24,height:24},children:e.jsx(g,{style:{fontSize:12}})})]},o.id))})})}),e.jsx(o,{component:"section","aria-label":"ë‚ ì§œ ë²”ìœ„ í•„í„°ë§ ì»¨íŠ¸ë¡¤",sx:{bgcolor:"#f0edfd",color:"#333",border:"1px solid #d0c9f0",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",flexShrink:0,minHeight:0},children:e.jsxs(i,{children:[e.jsx(r,{variant:"body2",component:"h3",sx:{mb:1,fontWeight:"bold",color:"#7c3aed"},children:"ë‚ ì§œ ë²”ìœ„ í•„í„°ë§"}),e.jsx(r,{variant:"caption",sx:{display:"block",mb:1,color:"#666"},children:(()=>{const e=new Date(te);e.setDate(e.getDate()+Q[0]);const t=new Date(te);return t.setDate(t.getDate()+Q[1]-1),`${e.toLocaleDateString("ko-KR")} ~ ${t.toLocaleDateString("ko-KR")} (${Q[1]-Q[0]}ì¼)`})()}),e.jsx(l,{"aria-label":"ë‚ ì§œ ë²”ìœ„ ì„ íƒ",value:Q,onChange:(e,t)=>X(t),min:0,max:7,step:1,marks:[{value:0,label:"9/2"},{value:1,label:"9/3"},{value:2,label:"9/4"},{value:3,label:"9/5"},{value:4,label:"9/6"},{value:5,label:"9/7"},{value:6,label:"9/8"},{value:7,label:"9/9"}],valueLabelDisplay:"auto",valueLabelFormat:e=>{const t=new Date(te);return t.setDate(t.getDate()+e),t.toLocaleDateString("ko-KR",{month:"short",day:"numeric"})},sx:{color:"#7c3aed","& .MuiSlider-thumb":{backgroundColor:"#7c3aed","&:hover, &.Mui-focusVisible":{boxShadow:"0 0 0 8px rgba(124,58,237, 0.16)"}},"& .MuiSlider-track":{backgroundColor:"#7c3aed"},"& .MuiSlider-rail":{backgroundColor:"#d0c9f0"},"& .MuiSlider-mark":{backgroundColor:"#b8aee0"},"& .MuiSlider-markLabel":{color:"#666",fontSize:"9px"},"& .MuiSlider-valueLabel":{backgroundColor:"#7c3aed",color:"#fff"}}}),e.jsxs(r,{variant:"caption",sx:{display:"block",mt:1,color:"#888",fontSize:"10px"},children:["í‘œì‹œëœ ìž‘ì „: ",K.length,"ê°œ / ì „ì²´: ",q.length,"ê°œ (í•˜ë£¨ë‹¹ ìµœëŒ€ 20ê°œ)"]})]})}),e.jsx(o,{component:"section","aria-label":"ì§€ë„ ë²”ë¡€",sx:{bgcolor:"#f0edfd",color:"#333",border:"1px solid #d0c9f0",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",flexShrink:0,minHeight:0},children:e.jsx(i,{children:e.jsxs(t,{component:"ul",role:"list",sx:{display:"flex",flexDirection:"column",gap:1,listStyle:"none",p:0,m:0},children:[e.jsxs(t,{component:"li",sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(t,{"aria-hidden":"true",sx:{width:12,height:12,borderRadius:"50%",bgcolor:"#FFFF00",border:"2px solid #FF0000"}}),e.jsx(r,{variant:"caption",sx:{color:"#666"},children:"ê³µê²© ì¶œë°œì§€"})]}),e.jsxs(t,{component:"li",sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(t,{"aria-hidden":"true",sx:{width:12,height:12,borderRadius:"50%",bgcolor:"#00FFFF",border:"2px solid #0000FF"}}),e.jsx(r,{variant:"caption",sx:{color:"#666"},children:"ê³µê²© ëª©í‘œì§€"})]}),e.jsxs(t,{component:"li",sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(t,{"aria-hidden":"true",sx:{width:20,height:2,bgcolor:"#FF0000",borderRadius:1,boxShadow:"0 0 4px #FF0000"}}),e.jsx(r,{variant:"caption",sx:{color:"#666"},children:"ðŸ”´ ì‚¬ì´ë²„ ìž‘ì „"})]})]})})})]})]}),e.jsxs(s,{open:J,onClose:()=>Z("fusionDB"),maxWidth:"md",fullWidth:!0,PaperProps:{sx:{height:"70vh",maxHeight:"70vh",m:0,position:"relative",overflow:"hidden"}},children:[e.jsx(n,{onClick:()=>Z("fusionDB"),sx:{position:"absolute",right:23,top:8.5,color:"#000000ff",zIndex:1,bgcolor:"#cac7d4ff","&:hover":{bgcolor:"#39306b",color:"#ffffffff"}},children:"âœ•"}),e.jsx(c,{sx:{p:0,height:"100%",overflow:"hidden"},children:e.jsx(L,{open:J,isPopup:!0})})]})]})};export{U as default};
