import{d as e,j as t,o as n,t as r,B as s,T as o,I as l,a1 as i,a8 as d,a9 as a,ab as c}from"./mui-vendor-C1i-sMyb.js";import{a as p,f as h}from"./react-vendor-ClEFeRSO.js";import{n as u}from"./vis-network-yobzVv1I.js";import{D as g}from"./vis-vendor-fIGJlaaL.js";import{N as x}from"./vis-network-CqERLR1V.js";import{C as f}from"./ConsoleView-Ip9mqoKM.js";import{I as m,u as b,R as y}from"./index-Bc1pOM-h.js";import"./chart-vendor-DXktVALM.js";import"./three-vendor-BMDtE1KG.js";var j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M448 224a64 64 0 10128 0 64 64 0 10-128 0zm96 168h-64c-4.4 0-8 3.6-8 8v464c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V400c0-4.4-3.6-8-8-8z"}}]},name:"info",theme:"outlined"},v=function(t,n){return p.createElement(m,e({},t,{ref:n,icon:j}))},w=p.forwardRef(v);const N=({open:e=!0,isPopup:n=!1})=>t.jsx(f,{type:"treatAnalysis",open:e,isPopup:n}),I=e=>{let t=e?.nodeType||e?.type||e?.properties?.type||e?.props?.type;if(!t&&e?.title&&"string"==typeof e.title)try{const n=JSON.parse(e.title);n.type&&(t=n.type)}catch{}const n=String(t||"").toLowerCase();return"switch"===n?"/image/switch.png":"workstation"===n?"/image/workstation.png":"server"===n?"/image/server.png":"router"===n?"/image/router.png":"firewall"===n?"/image/firewall.png":"laptop"===n?"/image/laptop.png":"printer"===n?"/image/printer.png":"sensor"===n?"/image/sensor.png":"plc"===n?"/image/plc.png":"/image/switch.png"},C=u.driver("neo4j+s://eff16eb9.databases.neo4j.io",u.auth.basic("neo4j","_G6MBldCj1gGO_hWjogaMJpleFbjuSZKlMHohGucVrA"));async function S(e="MATCH (n) RETURN n LIMIT 25",t={}){const n=C.session();try{return(await n.run(e,t)).records}finally{await n.close()}}function A({deviceElementId:e,onSelectDevice:h}){const{popups:f,openPopup:m,closePopup:j}=b(),v=f.treatAnalysis;p.useEffect(()=>{},[f.treatAnalysis]);const C=p.useRef(null),A=p.useRef(null),[R,E]=p.useState({nodes:[],edges:[]}),T=p.useRef(null),L=p.useRef(null),[M,F]=p.useState({nodes:[],edges:[]}),[k,W]=p.useState(!1),[H,z]=p.useState(null),[O,$]=p.useState([]),[D,P]=p.useState(null),[B,V]=p.useState(""),U=p.useRef(null),[_,J]=p.useState(0),[G,Y]=p.useState(!1),q=p.useRef(null),X=p.useRef(!1),K=p.useRef(null),[Z,Q]=p.useState(!1),[ee,te]=p.useState(!1),[ne,re]=p.useState(null),[se,oe]=p.useState(null),le=e??se,[ie,de]=p.useState(!e),[ae,ce]=p.useState(0),[pe,he]=p.useState(null),ue=p.useRef(h),ge=p.useRef(M),xe=p.useRef(k),fe=p.useRef(ae),me=p.useRef(se);p.useEffect(()=>{ge.current=M},[M]),p.useEffect(()=>{xe.current=k},[k]),p.useEffect(()=>{ue.current=h},[h]),p.useEffect(()=>{fe.current=ae},[ae]),p.useEffect(()=>{me.current=se},[se]);const be=async e=>{if(!e)return null;const t=await S("MATCH (p:Physical {name:$name, project:'multi-layer'}) RETURN id(p) AS pid",{name:e});if(!t?.length)return null;const n=t[0].get("pid");return u.isInt?.(n)?n.toNumber():n};p.useEffect(()=>{S('\n      MATCH (d:Device{project:"facility"})\n      OPTIONAL MATCH (d)-[r:CONNECTED{project:"facility"}]-(d2:Device{project:"facility"})\n      RETURN d, r, d2\n    ').then(e=>{const t=new Map,n=new Map,r=e=>{if(!e)return null;const t=e.identity;return t&&"function"==typeof t.toNumber?t.toNumber():t},s=e=>{if(!e)return"";const t=e.properties||{};return t.name||t.label||e.labels&&e.labels[0]||t.id||String(r(e))};for(const i of e){const e=i.get("d"),o=i.get("r"),l=i.get("d2"),d=r(e);if(e&&null!=d&&!t.has(d)&&t.set(d,{id:d,label:s(e),elementId:e.elementId,name:e.properties?.name,group:"Device",title:JSON.stringify(e.properties||{},null,2),shape:"image",image:I(e),size:12,color:{border:"#205AAA"},font:{color:"#7c3aed"}}),l){const e=r(l);if(null==e||t.has(e)||t.set(e,{id:e,label:s(l),elementId:l.elementId,name:l.properties?.name,group:"Device",title:JSON.stringify(l.properties||{},null,2),shape:"image",image:I(l),size:12,color:{border:"#205AAA"},font:{color:"#7c3aed"}}),o&&null!=d&&null!=e){const t=Math.min(d,e),r=Math.max(d,e),s=`${t}-${r}`;n.has(s)||n.set(s,{id:s,from:t,to:r,color:{color:"#848484"},width:1})}}}const o=Array.from(t.values()),l=Array.from(n.values());E({nodes:o,edges:l}),T.current||(T.current={nodes:o.map(e=>({...e})),edges:l.map(e=>({...e}))})}).catch(console.error)},[]),p.useEffect(()=>{let e=!1;const t=e=>u.isInt?.(e)?e.toNumber():e;if(!le){const e=ge.current||{nodes:[],edges:[]};return(e.nodes?.length||e.edges?.length)&&F({nodes:[],edges:[]}),xe.current&&W(!1),null!==H&&z(null),void $([])}const n=le;xe.current||W(!0);const r=H;return S("\n      MATCH (start:Physical {project:'multi-layer'}), (target:Physical {name:$targetPhysicalName, project:'multi-layer'})\n      WHERE id(start) = $startId AND start <> target\n      CALL {\n        WITH start, target\n        // ìš°íšŒ ë…¸ë“œ(ì—”ë“œí¬ì¸íŠ¸) ì°¾ê¸° - ì‹œì‘ê³¼ ëª©í‘œê°€ ì•„ë‹Œ ì—”ë“œí¬ì¸íŠ¸ íƒ€ì… ë…¸ë“œ\n        MATCH (via:Physical {project:'multi-layer'})\n        WHERE via <> start AND via <> target \n          AND properties(via).type IS NOT NULL\n          AND (toLower(properties(via).type) CONTAINS 'laptop'\n               OR toLower(properties(via).type) CONTAINS 'workstation'\n               OR toLower(properties(via).type) CONTAINS 'server'\n               OR toLower(properties(via).type) CONTAINS 'printer'\n               OR toLower(properties(via).type) CONTAINS 'sensor'\n               OR toLower(properties(via).type) CONTAINS 'plc'\n               OR toLower(properties(via).type) CONTAINS 'computer'\n               OR toLower(properties(via).type) CONTAINS 'pc'\n               OR toLower(properties(via).type) CONTAINS 'host')\n        WITH start, target, via\n        ORDER BY rand()\n        LIMIT 50\n        \n        // ì‹œì‘ -> ìš°íšŒ ë…¸ë“œ ê²½ë¡œ\n        WITH start, target, via\n        MATCH p1 = shortestPath((start)-[:CONNECTED*1..8]-(via))\n        WHERE ALL(r IN relationships(p1) WHERE r.project = 'multi-layer')\n          AND via <> start\n          AND NONE(n IN nodes(p1)[1..-1] WHERE n = target)\n        \n        // ìš°íšŒ ë…¸ë“œ -> ëª©í‘œ ê²½ë¡œ  \n        WITH start, target, via, nodes(p1) AS p1Nodes, relationships(p1) AS p1Rels\n        MATCH p2 = shortestPath((via)-[:CONNECTED*1..8]-(target))\n        WHERE ALL(r IN relationships(p2) WHERE r.project = 'multi-layer')\n          AND via <> target\n          AND NONE(n IN nodes(p2)[1..-1] WHERE n = start)\n        \n        // ë‘ ê²½ë¡œ ê²°í•©\n        WITH start, target, via,\n             p1Nodes + nodes(p2)[1..] AS pathNodes,\n             p1Rels + relationships(p2) AS pathRels,\n             id(start) AS startId, \n             id(target) AS targetId,\n             id(via) AS viaId\n        \n        // ê²½ë¡œ ê¸¸ì´ê°€ ë„ˆë¬´ ê¸¸ì§€ ì•Šë„ë¡ ì œí•œ (ìµœì†Œ 3ê°œ ë…¸ë“œ = ì‹œì‘ + ìš°íšŒ + ëª©í‘œ)\n        WHERE size(pathNodes) <= 15 AND size(pathNodes) >= 3\n        \n        WITH pathNodes, pathRels, startId, targetId, viaId, range(0, size(pathNodes)-1) AS indices\n        LIMIT 20\n        \n        UNWIND indices AS idx\n        WITH pathNodes, pathRels, startId, targetId, viaId, idx, pathNodes[idx] AS n\n        WITH pathNodes, pathRels, startId, targetId, viaId, idx, n,\n             COUNT { (n)-[:CONNECTED {project:'multi-layer'}]-() } AS deg,\n             properties(n).type AS nodeType,\n             properties(n).ip AS nodeIp,\n             properties(n).name AS nodeName,\n             properties(n).id AS nodeId\n        OPTIONAL MATCH (n)-[:HOSTS]->(l:Logical)\n        OPTIONAL MATCH (l)-[:HAS_CVE]->(c:CveDetail)\n        WITH pathNodes, pathRels, startId, targetId, viaId, idx, n, deg, nodeType, nodeIp, nodeName, nodeId,\n             collect(DISTINCT c) AS cList\n        WITH pathNodes, pathRels, startId, targetId, viaId, idx, n, deg, nodeType, nodeIp, nodeName, nodeId,\n             [ci IN cList WHERE ci IS NOT NULL | { id: id(ci), props: properties(ci) }] AS cveInfos,\n             [ci IN cList WHERE ci IS NOT NULL | coalesce(ci.cve, ci.cveId, ci.id, ci.name)] AS cveIdList,\n             [ci IN cList WHERE ci IS NOT NULL |\n                coalesce(toFloat(ci.cvss3), toFloat(ci.cvss), toFloat(ci.baseScore), toFloat(ci.score), toFloat(ci.score_value), toFloat(ci.severity), toFloat(ci.severity_score))\n             ] AS rawScores\n        WITH pathNodes, pathRels, startId, targetId, viaId, idx, n, deg, nodeType, nodeIp, nodeName, nodeId, cveInfos, cveIdList,\n             [s IN rawScores WHERE s IS NOT NULL] AS scoreVals\n        WITH pathNodes, pathRels, startId, targetId, viaId, idx,\n             {\n               id: id(n), props: properties(n), labels: labels(n), deg: deg, nodeType: nodeType,\n               ip: nodeIp, name: nodeName, nodeId: nodeId, cveInfos: cveInfos, vulnList: cveIdList,\n               vulnScore: CASE WHEN size(scoreVals) > 0 THEN\n                 CASE WHEN (reduce(s=0.0, x IN scoreVals | s + x) / size(scoreVals)) > 10.0\n                   THEN round(100.0 * ((reduce(s=0.0, x IN scoreVals | s + x) / size(scoreVals)) / 10.0)) / 100.0\n                 ELSE round(100.0 * (reduce(s=0.0, x IN scoreVals | s + x) / size(scoreVals))) / 100.0 END\n               ELSE NULL END\n             } AS nodeInfo\n        ORDER BY idx\n        WITH pathNodes, pathRels, startId, targetId, viaId, collect(nodeInfo) AS orderedNodeInfos\n        \n        // ìš°íšŒ ì—”ë“œí¬ì¸íŠ¸ ë…¸ë“œ ìˆ˜ ê³„ì‚° (ëª…ì‹œì ìœ¼ë¡œ ì—”ë“œí¬ì¸íŠ¸ íƒ€ì…ë§Œ ì¹´ìš´íŠ¸)\n        WITH pathRels, orderedNodeInfos, viaId,\n             size([n IN orderedNodeInfos \n                   WHERE n.nodeType IS NOT NULL \n                   AND n.id <> startId \n                   AND n.id <> targetId\n                   AND (toLower(n.nodeType) CONTAINS 'laptop'\n                        OR toLower(n.nodeType) CONTAINS 'workstation'\n                        OR toLower(n.nodeType) CONTAINS 'server'\n                        OR toLower(n.nodeType) CONTAINS 'printer'\n                        OR toLower(n.nodeType) CONTAINS 'sensor'\n                        OR toLower(n.nodeType) CONTAINS 'plc'\n                        OR toLower(n.nodeType) CONTAINS 'computer'\n                        OR toLower(n.nodeType) CONTAINS 'pc'\n                        OR toLower(n.nodeType) CONTAINS 'host')\n                  ]) AS viaCount\n        \n        // ìµœì†Œ 1ê°œ ì´ìƒì˜ ìš°íšŒ ë…¸ë“œê°€ ìˆëŠ” ê²½ë¡œë§Œ ì„ íƒ\n        WHERE viaCount > 0\n        \n        RETURN pathRels, orderedNodeInfos, viaCount, viaId\n      }\n      WITH start, target, pathRels, orderedNodeInfos, viaCount, viaId\n      ORDER BY viaCount ASC, size(pathRels) ASC\n      LIMIT 10\n      RETURN start, target, pathRels, orderedNodeInfos, viaCount, viaId\n    ",{targetPhysicalName:n,startId:r}).then(async n=>{if(e)return;if(!n||0===n.length){const e=[];if(null!=r)try{const t="MATCH (p:Physical {project:'multi-layer'}) WHERE id(p) = $startId RETURN p",n=await S(t,{startId:r});let s=null;n&&n.length>0&&(s=n[0].get("p")),e.push({id:r,label:s?.properties?.name||"Start",group:"StartPhysical",title:"",shape:"image",image:I({}),size:20,color:{border:"#00CC00"},font:{color:"#7c3aed"},properties:{...s?.properties||{},id:s?.properties?.id||`ml:${r}`}})}catch(g){e.push({id:r,label:"Start",group:"StartPhysical",title:"",shape:"image",image:I({}),size:20,color:{border:"#00CC00"},font:{color:"#7c3aed"},properties:{id:`ml:${r}`}})}return F({nodes:e,edges:[],pathsMap:new Map,targetNodeId:null,allStartNodes:new Set([r]),nodeConnections:new Map}),$([]),void(xe.current&&W(!1))}const s=new Map,o=new Set,l=[];let i=null,d=null;const a=[],c=new Map;for(let e=0;e<n.length;e++){const p=n[e],h=p.get("start"),u=p.get("target"),g=p.get("orderedNodeInfos")||[],x=p.get("pathRels")||[];p.get("viaCount"),p.get("viaId")&&t(p.get("viaId")),i=i??(u?.identity?t(u.identity):null),!d&&h&&(d={id:t(h.identity),name:h.properties?.name,elementId:h.properties?.id,properties:h.properties}),g.filter(e=>{const n=t(e.id),s=n!==r&&n!==i,o=e.nodeType?String(e.nodeType).toLowerCase():"",l=o.includes("laptop")||o.includes("workstation")||o.includes("server")||o.includes("printer")||o.includes("sensor")||o.includes("plc")||o.includes("computer")||o.includes("pc")||o.includes("host");return s&&l&&e.nodeType}).length;const f=new Set,m=[],b=new Map;for(let e=0;e<g.length;e++){const n=g[e],r=t(n.id),s=n.nodeType,o=s?String(s).toLowerCase():"",l=o.includes("switch")||o.includes("router")||o.includes("firewall")||o.includes("gateway")||o.includes("ids")||o.includes("ips")||o.includes("load")||o.includes("balancer"),i=o.includes("laptop")||o.includes("workstation")||o.includes("server")||o.includes("printer")||o.includes("sensor")||o.includes("plc")||o.includes("computer")||o.includes("pc")||o.includes("host");if(!(m.length>0&&r===t(m[m.length-1].id)))if(l)m.push(n);else if(i)if(f.has(r)){const e=b.get(r)||0;b.set(r,e+1)}else f.add(r),m.push(n),b.set(r,1);else m.push(n)}if(m.length<2)continue;let y=-1;for(let e=0;e<m.length;e++)if(t(m[e].id)===i){y=e;break}const j=y>=0?m.slice(0,y+1):m;y>=0&&y<m.length-1&&(m.length,j.length);const v=j.map(e=>{const n=t(e.id);return{id:n,label:e.name||e.props?.name||e.props?.label||(Array.isArray(e.labels)?e.labels[0]:void 0)||e.nodeId||e.props?.id||String(n),props:{...e.props||{},cveInfos:e.cveInfos||[],vulnList:e.vulnList||[],vulnScore:e.vulnScore??null},nodeType:e.nodeType||null,ip:e.ip||(e.props?.ip??null)}}),w=v.filter(e=>e.id===r).length,N=v.filter(e=>e.id===i).length,C=v.filter(e=>{const t=(e.nodeType?String(e.nodeType):"").toLowerCase();return(t.includes("laptop")||t.includes("workstation")||t.includes("server")||t.includes("printer")||t.includes("sensor")||t.includes("plc")||t.includes("computer")||t.includes("pc")||t.includes("host"))&&e.id!==r&&e.id!==i}),S=new Map;C.forEach(e=>{S.set(e.id,(S.get(e.id)||0)+1)});const A=Array.from(S.entries()).filter(([e,t])=>t>1).map(([e,t])=>{const n=v.find(t=>t.id===e);return`${n?.label}(${e}): ${t}ë²ˆ`}),R=v[0],E=v[v.length-1],T=R?.id===r,L=E?.id===i,M=(C.length,!T||!L||1!==w||1!==N||A.length,[]);for(let e=0;e<v.length-1;e++)M.push(`${v[e].label}(${v[e].id}) â†’ ${v[e+1].label}(${v[e+1].id})`);A.length,a.push(v);for(let e=0;e<j.length;e++){const n=j[e],o=t(n.id);c.has(o)||c.set(o,[]),c.get(o).push(e);const l=o===r,a=o===i;let p,h,u;if(a)p={border:"#CC0000"},h=25,u="TargetPhysical";else if(l)p={border:"#00CC00"},h=20,u="StartPhysical";else{const e=(n.nodeType?String(n.nodeType):"").toLowerCase();e.includes("switch")||e.includes("router")||e.includes("firewall")||e.includes("gateway")||e.includes("ids")||e.includes("ips")||e.includes("load")||e.includes("balancer")?(p={border:"#205AAA"},h=15,u="Physical"):(p={border:"#FF8C00"},h=18,u="ViaPhysical")}if(!s.has(o)){const e=l&&d&&d.id===o,t={id:o,label:e?d.name:n.name||n.props?.name||n.props?.label||(Array.isArray(n.labels)?n.labels[0]:void 0)||n.nodeId||n.props?.id||String(o),group:u,title:JSON.stringify({...n.props||{},vulnList:n.vulnList||[],vulnScore:n.vulnScore??null},null,2),shape:"image",image:I(n),size:h,color:p,properties:{...e?d.properties:n.props||{},cveInfos:n.cveInfos||[],vulnList:n.vulnList||[],vulnScore:n.vulnScore??null,id:e?d.elementId:n.props?.id||n.nodeId||`ml:${o}`},font:{color:"#7c3aed"}};a||l||(t.x=1600*Math.random()-1200,t.physics=!1),s.set(o,t)}}if(x&&x.length>0){x.length,j.length;for(let e=0;e<x.length;e++)if(x[e]&&e<j.length-1){const n=t(j[e].id),r=t(j[e+1].id),s=`${n}-${r}`,i=`${r}-${n}`;o.has(s)||o.has(i)||(o.add(s),l.push({id:s,from:n,to:r,arrows:"to",color:{color:"#FFD700"},width:3,title:`Attack Path - Hop ${e+1}`}))}}else for(let e=1;e<j.length;e++){const n=j[e-1],r=j[e],s=t(n.id),i=t(r.id),d=`${s}-${i}`,a=`${i}-${s}`;o.has(d)||o.has(a)||(o.add(d),l.push({id:d,from:s,to:i,arrows:"to",color:{color:"#FFD700"},width:3,title:"Attack Path (Fallback)"}))}}s.forEach((e,t)=>{if(t===i)return void(e.tempLevel=999999);const n=c.get(t);if(n?.length){const t=n.reduce((e,t)=>e+t,0)/n.length;e.tempLevel=Math.round(t)}else e.tempLevel=0});const p=[...new Set(Array.from(s.values()).filter(e=>999999!==e.tempLevel).map(e=>e.tempLevel))].sort((e,t)=>e-t),h=new Map;p.forEach((e,t)=>h.set(e,t+1));let u=0;if(s.forEach((e,t)=>{if(t===i)return;const n=c.get(t);if(n?.length){const t=n.reduce((e,t)=>e+t,0)/n.length,r=Math.round(t);e.level=h.get(r),e.level>u&&(u=e.level)}else e.level=1;delete e.tempLevel}),i){const e=s.get(i);e&&(e.level=u+1,delete e.tempLevel)}a.forEach((e,t)=>{e[0],e[e.length-1],e.filter(e=>e.id===r).length,e.filter(e=>e.id===i).length}),$(a),F({nodes:Array.from(s.values()),edges:l,pathsMap:new Map([[r,new Set(l.map(e=>e.id))]]),targetNodeId:i,allStartNodes:new Set([r]),nodeConnections:new Map,pathCount:n.length,paths:a}),xe.current&&W(!1)}).catch(e=>{W(!1)}),()=>{e=!0}},[le,H]);const ye=[{border:"#FF0000",edge:"#FF0000",shadow:"rgba(255, 0, 0, 0.8)",name:"1ìˆœìœ„ (ë¹¨ê°•)"},{border:"#FF6600",edge:"#FF6600",shadow:"rgba(255, 102, 0, 0.7)",name:"2ìˆœìœ„ (ì£¼í™©)"},{border:"#FFCC00",edge:"#FFCC00",shadow:"rgba(255, 204, 0, 0.7)",name:"3ìˆœìœ„ (ë…¸ë‘)"},{border:"#99CC00",edge:"#99CC00",shadow:"rgba(153, 204, 0, 0.6)",name:"4ìˆœìœ„ (ì—°ë‘)"},{border:"#00CC00",edge:"#00CC00",shadow:"rgba(0, 204, 0, 0.6)",name:"5ìˆœìœ„ (ì´ˆë¡)"},{border:"#00CC66",edge:"#00CC66",shadow:"rgba(0, 204, 102, 0.6)",name:"6ìˆœìœ„ (ë¯¼íŠ¸)"},{border:"#00CCCC",edge:"#00CCCC",shadow:"rgba(0, 204, 204, 0.6)",name:"7ìˆœìœ„ (ì²­ë¡)"},{border:"#0099CC",edge:"#0099CC",shadow:"rgba(0, 153, 204, 0.6)",name:"8ìˆœìœ„ (í•˜ëŠ˜)"},{border:"#0066FF",edge:"#0066FF",shadow:"rgba(0, 102, 255, 0.6)",name:"9ìˆœìœ„ (íŒŒë‘)"},{border:"#3333CC",edge:"#3333CC",shadow:"rgba(51, 51, 204, 0.5)",name:"10ìˆœìœ„ (ë‚¨ìƒ‰)"},{border:"#6600CC",edge:"#6600CC",shadow:"rgba(102, 0, 204, 0.5)",name:"11ìˆœìœ„ (ë³´ë¼)"},{border:"#9933CC",edge:"#9933CC",shadow:"rgba(153, 51, 204, 0.5)",name:"12ìˆœìœ„ (ìì£¼)"},{border:"#CC00CC",edge:"#CC00CC",shadow:"rgba(204, 0, 204, 0.5)",name:"13ìˆœìœ„ (ìí™)"},{border:"#CC6699",edge:"#CC6699",shadow:"rgba(204, 102, 153, 0.5)",name:"14ìˆœìœ„ (ë¶„í™)"},{border:"#996633",edge:"#996633",shadow:"rgba(153, 102, 51, 0.5)",name:"15ìˆœìœ„ (ê°ˆìƒ‰)"},{border:"#666666",edge:"#666666",shadow:"rgba(102, 102, 102, 0.5)",name:"16ìˆœìœ„ (íšŒìƒ‰)"}],je=p.useRef(null),ve=p.useRef(null);p.useEffect(()=>{if(!C.current||!R.nodes?.length)return;if(A.current)return;const t=T.current??R,n=(t.nodes||[]).map(e=>({...e,shape:"image",image:I(e),font:{color:"#7c3aed"},borderWidth:2,size:12,color:{border:"#205AAA"},shadow:{enabled:!1}})),r=(t.edges||[]).map(e=>({...e,color:{color:"#848484"},width:1,shadow:{enabled:!1}}));je.current=new g(n),ve.current=new g(r);const s={nodes:je.current,edges:ve.current},o={interaction:{hover:!0,multiselect:!1},nodes:{shape:"image",brokenImage:I({}),size:30,borderWidth:2,color:{border:"#b39ddb"},font:{size:14,color:"#7c3aed"}},edges:{smooth:{enabled:!1}},physics:{stabilization:!0}};return A.current=new x(C.current,s,o),L.current?(A.current.setOptions({physics:!1,edges:{smooth:{enabled:!1}}}),Object.keys(L.current).forEach(e=>{try{A.current.moveNode(e,L.current[e].x,L.current[e].y)}catch(t){}})):A.current.once("stabilizationIterationsDone",()=>{A.current&&(L.current=A.current.getPositions(),A.current.setOptions({physics:!1,edges:{smooth:{enabled:!1}}}))}),A.current.on("selectNode",async t=>{const n=t.nodes&&t.nodes[0];if(!n||!je.current)return;const r=je.current.get(n),s=r?.name;if(e){const e=await be(s);null!=e&&z(e)}else{const e=fe.current,t=me.current;if(0===e)oe(s),he({id:n,name:s,...r}),ce(1);else if(1===e){if(s===t)return;const e=await be(s);null!=e&&(z(e),ce(2))}else{if(s===t)return;const e=await be(s);null!=e&&z(e)}}}),()=>{A.current&&(A.current.destroy(),A.current=null,je.current=null,ve.current=null)}},[R]),p.useEffect(()=>{if(!je.current||!ve.current)return;const e=T.current??R,t=e=>{const t=e?.properties||e?.props||{},n=t.cveInfos||t.vulnerabilities||t.cves||[],r=Array.isArray(n)?n:[],s=[],o=[],l=[],i=[];for(const u of r){const e=u?.props||u||{},t=e.cvss3??e.cvss??e.baseScore??e.score??e.score_value??e.severity_score,n="number"==typeof t?t:parseFloat(t);Number.isNaN(n)||s.push(n);const r=e.vectorString||e.vector||e.cvssVector||null;if(r&&"string"==typeof r){const e={H:1,M:.66,L:.33,N:0},t=t=>{const n=r.match(new RegExp(`${t}:([HNML])`));return n?e[n[1]]??null:null},n=t("C"),s=t("I"),d=t("A");null!=n&&o.push(n),null!=s&&l.push(s),null!=d&&i.push(d)}}const d=e=>e.length?e.reduce((e,t)=>e+t,0)/e.length:null,a=d(s),c=d(o),p=d(l),h=d(i);return null==a||null==c||null==p||null==h?null:a*(c+p+h)/3/10},n=(M.nodes||[]).map(t).filter(e=>"number"==typeof e),r=n.length?n.reduce((e,t)=>e+t,0)/n.length:null,s=(O||[]).map((e,n)=>{const s=(Array.isArray(e)?e:[]).map(e=>{const n=(M.nodes||[]).find(t=>t.id===e.id)||e;return t(n)}).filter(e=>"number"==typeof e),o=s.length?s.reduce((e,t)=>e+t,0)/s.length:null;let l=null;return null!=o&&null!=r&&r>0&&(l=Math.min(Math.max(o/r,0),1)),{index:n,success:l}}),o=new Map;[...s].sort((e,t)=>(t.success??-1)-(e.success??-1)).forEach((e,t)=>{o.set(e.index,t)});const l=new Map,i=new Map;(O||[]).forEach((e,t)=>{const n=o.get(t)??t,r=e||[];r.forEach(e=>{l.has(e.id)||l.set(e.id,{ranks:new Set,lowestRank:n}),l.get(e.id).ranks.add(n),n<l.get(e.id).lowestRank&&(l.get(e.id).lowestRank=n)});for(let s=0;s<r.length-1;s++){const e=r[s].id,t=r[s+1].id,o=`${Math.min(e,t)}-${Math.max(e,t)}`;i.has(o)||i.set(o,{ranks:new Set,lowestRank:n}),i.get(o).ranks.add(n),n<i.get(o).lowestRank&&(i.get(o).lowestRank=n)}});const d=new Set,a=new Set;if(null!==D&&O[D]){const e=O[D];e.forEach(e=>d.add(e.id));for(let t=0;t<e.length-1;t++){const n=e[t].id,r=e[t+1].id;a.add(`${Math.min(n,r)}-${Math.max(n,r)}`)}}const c=new Map,p=new Map;M.nodes&&M.nodes.forEach(e=>{if(e.properties&&e.properties.id){const t=e.properties.id.startsWith("ml:")?e.properties.id.slice(3):e.properties.id;c.set(e.id,t)}const t=e.label||e.properties?.name;t&&p.set(e.id,t)});const h=new Map;(e.nodes||[]).forEach(e=>{for(const[t,n]of c.entries())if(n===e.elementId){h.set(t,e.id);break}for(const[t,n]of p.entries())h.has(t)||n!==e.name||h.set(t,e.id)});const u=new Map;for(const[m,b]of i.entries()){const[e,t]=m.split("-").map(Number),n=h.get(e),r=h.get(t);if(null!=n&&null!=r){const e=`${Math.min(n,r)}-${Math.max(n,r)}`;if(u.has(e)){const t=u.get(e);b.ranks.forEach(e=>t.ranks.add(e)),b.lowestRank<t.lowestRank&&(t.lowestRank=b.lowestRank)}else u.set(e,{ranks:new Set(b.ranks),lowestRank:b.lowestRank})}}const g=new Set;for(const m of a){const[e,t]=m.split("-").map(Number),n=h.get(e),r=h.get(t);null!=n&&null!=r&&g.add(`${Math.min(n,r)}-${Math.max(n,r)}`)}const x=(e.nodes||[]).map(e=>{let t=null,n=null;for(const[o,l]of c.entries())if(l===e.elementId){t=o;break}if(null===t)for(const[o,l]of p.entries())if(l===e.name){t=o;break}null!==t&&l.has(t)&&(n=l.get(t));const r=null!==t&&d.has(t);let s=!1;if(null!=H){const t=c.get(H),n=p.get(H);(t&&t===e.elementId||n&&n===e.name)&&(s=!0)}const i=le&&e.name===le;let a={id:e.id};if(null!==D)if(i)a.size=35,a.borderWidth=4,a.color={border:"#CC0000",background:"#FFE5E5"},a.shadow={enabled:!0,color:"rgba(255, 0, 0, 0.8)",size:25,x:0,y:0};else if(s)a.size=30,a.borderWidth=4,a.color={border:"#00CC00",background:"#E5FFE5"},a.shadow={enabled:!0,color:"rgba(0, 204, 0, 0.8)",size:20,x:0,y:0};else if(r){const e=o.get(D)??0,t=ye[Math.min(e,ye.length-1)];a.size=28,a.borderWidth=4,a.color={border:t.border,background:"#FFFFFF"},a.shadow={enabled:!0,color:t.shadow,size:20,x:0,y:0}}else n?(a.size=12,a.borderWidth=1,a.color={border:"rgba(150, 150, 150, 0.15)",background:"rgba(255, 255, 255, 0.1)"},a.shadow={enabled:!1}):(a.size=12,a.borderWidth=1,a.color={border:"rgba(100, 100, 100, 0.15)"},a.shadow={enabled:!1});else if(i)a.size=35,a.borderWidth=4,a.color={border:"#CC0000",background:"#FFE5E5"},a.shadow={enabled:!0,color:"rgba(255, 0, 0, 0.8)",size:25,x:0,y:0};else if(s)a.size=30,a.borderWidth=4,a.color={border:"#00CC00",background:"#E5FFE5"},a.shadow={enabled:!0,color:"rgba(0, 204, 0, 0.8)",size:20,x:0,y:0};else if(n){const e=n.lowestRank,t=ye[Math.min(e,ye.length-1)];a.size=20,a.borderWidth=3,a.color={border:t.border,background:"#FFFFFF"},a.shadow={enabled:!0,color:t.shadow,size:12,x:0,y:0}}else a.size=12,a.borderWidth=2,a.color={border:"#205AAA"},a.shadow={enabled:!1};return a}),f=(e.edges||[]).map(e=>{const t=u.get(e.id),n=g.has(e.id);let r={id:e.id};if(null!==D)if(n){const e=o.get(D)??0,t=ye[Math.min(e,ye.length-1)];r.color={color:t.edge,highlight:t.edge,hover:t.edge},r.width=10,r.shadow={enabled:!0,color:t.shadow,size:15,x:0,y:0}}else t?(r.color={color:"rgba(200, 200, 200, 0.1)",highlight:"rgba(200, 200, 200, 0.1)",hover:"rgba(200, 200, 200, 0.1)"},r.width=1,r.shadow={enabled:!1}):(r.color={color:"rgba(132, 132, 132, 0.1)"},r.width=.5,r.shadow={enabled:!1});else if(n){const e=o.get(D)??0,t=ye[Math.min(e,ye.length-1)];r.color={color:t.edge,highlight:t.edge,hover:t.edge},r.width=10,r.shadow={enabled:!0,color:t.shadow,size:15,x:0,y:0}}else if(t){const e=t.lowestRank,n=ye[Math.min(e,ye.length-1)];r.color={color:n.edge,highlight:n.edge,hover:n.edge},r.width=5,r.shadow={enabled:!0,color:n.shadow,size:8,x:0,y:0}}else r.color={color:"#848484"},r.width=1,r.shadow={enabled:!1};return r});je.current.update(x),ve.current.update(f)},[R,H,M,le,D,O,ye]),p.useEffect(()=>{if(!(K.current&&A.current&&G&&null!==D&&O[D]))return void(K.current&&K.current.getContext("2d").clearRect(0,0,K.current.width,K.current.height));const e=K.current,t=A.current,n=e.getContext("2d"),r=C.current;r&&(e.width=r.offsetWidth,e.height=r.offsetHeight),n.clearRect(0,0,e.width,e.height);const s=O[D],o=[],l=new Map,i=new Map;M.nodes&&M.nodes.forEach(e=>{if(e.properties&&e.properties.id){const t=e.properties.id.startsWith("ml:")?e.properties.id.slice(3):e.properties.id;l.set(e.id,t)}const t=e.label||e.properties?.name;t&&i.set(e.id,t)});for(const f of s){const e=l.get(f.id),n=i.get(f.id),r=T.current??R;let s=null;if(e&&(s=r.nodes.find(t=>t.elementId===e)),!s&&n&&(s=r.nodes.find(e=>e.name===n)),s)try{const e=t.getPosition(s.id),n=t.canvasToDOM(e);o.push({x:n.x,y:n.y})}catch(x){}}if(o.length<2)return;const d=[];let a=0;for(let f=0;f<o.length-1;f++){const e=o[f+1].x-o[f].x,t=o[f+1].y-o[f].y,n=Math.sqrt(e*e+t*t);d.push(n),a+=n}const c=_*a;let p=0,h=o[0].x,u=o[0].y;for(let f=0;f<d.length;f++){if(p+d[f]>=c){const e=(c-p)/d[f];h=o[f].x+(o[f+1].x-o[f].x)*e,u=o[f].y+(o[f+1].y-o[f].y)*e;break}p+=d[f]}const g=n.createRadialGradient(h,u,0,h,u,25);g.addColorStop(0,"rgba(255, 20, 147, 1)"),g.addColorStop(.4,"rgba(255, 20, 147, 0.8)"),g.addColorStop(.7,"rgba(255, 20, 147, 0.4)"),g.addColorStop(1,"rgba(255, 20, 147, 0)"),n.fillStyle=g,n.beginPath(),n.arc(h,u,25,0,2*Math.PI),n.fill(),n.fillStyle="#FF1493",n.beginPath(),n.arc(h,u,10,0,2*Math.PI),n.fill(),n.strokeStyle="#FFD700",n.lineWidth=3,n.beginPath(),n.arc(h,u,15,0,2*Math.PI),n.stroke(),n.fillStyle="#FFB6C1",n.beginPath(),n.arc(h-3,u-3,4,0,2*Math.PI),n.fill()},[G,_,D,O,R,M]);const we=e=>{const t=e?.properties||e?.props||{};alert(JSON.stringify(t,null,2))},Ne=M.nodes?.find(e=>e.id===H)||null,Ie=M.nodes?.find(e=>e.id===M.targetNodeId)||null,Ce=e=>{if(!e||"string"!=typeof e)return{C:null,I:null,A:null};const t={H:1,M:.66,L:.33,N:0},n=n=>{const r=e.match(new RegExp(`${n}:([HNML])`));return r?t[r[1]]??null:null};return{C:n("C"),I:n("I"),A:n("A")}},Se=e=>{const t=e?.properties||e?.props||{},n=t.cveInfos||t.vulnerabilities||t.cves||[],r=Array.isArray(n)?n:[],s=[],o=[],l=[],i=[];for(const a of r){const e=a?.props||a||{},t=e.cvss3??e.cvss??e.baseScore??e.score??e.score_value??e.severity_score,n="number"==typeof t?t:parseFloat(t);Number.isNaN(n)||s.push(n);const r=e.vectorString||e.vector||e.cvssVector||null,{C:d,I:c,A:p}=Ce(r);null!=d&&o.push(d),null!=c&&l.push(c),null!=p&&i.push(p)}const d=e=>e.length?e.reduce((e,t)=>e+t,0)/e.length:null;return{totalCount:r.length,highRiskCount:s.filter(e=>e>=7).length,avgScore:d(s),avgC:d(o),avgI:d(l),avgA:d(i)}},Ae=p.useMemo(()=>{const e=new Map;return(M.edges||[]).forEach(t=>{e.set(t.from,(e.get(t.from)||0)+1),e.set(t.to,(e.get(t.to)||0)+1)}),e},[M.edges]),Re=p.useMemo(()=>{let e=1/0,t=-1/0,n=!1;return(M.nodes||[]).forEach(r=>{"number"==typeof r.level&&(n=!0,r.level<e&&(e=r.level),r.level>t&&(t=r.level))}),n?{min:e,max:t}:null},[M.nodes]),Ee=p.useMemo(()=>{const e=(M.nodes||[]).map(e=>Se(e).totalCount).filter(e=>"number"==typeof e);return e.length?e.reduce((e,t)=>e+t,0)/e.length:0},[M.nodes]),Te=e=>{const t=Se(e);let n=1;return t.totalCount>0&&t.highRiskCount>=Math.ceil(t.totalCount/2)&&(n+=1),t.totalCount>Ee&&(n+=1),n<1&&(n=1),n>3&&(n=3),n},Le=e=>{if(!Ae||0===Ae.size)return.5;const t=Array.from(Ae.values()),n=Math.min(...t),r=Math.max(...t),s=Ae.get(e)||0;return r===n?.5:(s-n)/(r-n)},Me=e=>{if(!Re||"number"!=typeof e.level)return.5;const{min:t,max:n}=Re;return n===t?.5:1-(e.level-t)/(n-t)},Fe=e=>{if(!e)return.5;const t=(Te(e)+Le(e.id))*Me(e);return Math.max(0,Math.min(t/4,1))},ke=e=>{const{avgScore:t,avgC:n,avgI:r,avgA:s}=Se(e);return null==t||null==n||null==r||null==s?null:t*(n+r+s)/3/10},We=p.useMemo(()=>{const e=(M.nodes||[]).map(ke).filter(e=>"number"==typeof e);return e.length?e.reduce((e,t)=>e+t,0)/e.length:null},[M.nodes]),He=p.useMemo(()=>(O||[]).map((e,t)=>{const n=Array.isArray(e)?e:[],r=n.map(e=>{const t=(M.nodes||[]).find(t=>t.id===e.id)||e;return ke(t)}).filter(e=>"number"==typeof e),s=n.length,o=r.length?r.reduce((e,t)=>e+t,0)/r.length:null;let l=null;return null!=o&&null!=We&&We>0&&(l=Math.min(Math.max(o/We,0),1)),{index:t,path:n,nodeCount:s,success:l}}),[O,M.nodes,We]);p.useMemo(()=>{if(!He||0===He.length)return new Map;const e=[...He].sort((e,t)=>(t.success??-1)-(e.success??-1)),t=new Map;return e.forEach((e,n)=>{t.set(e.index,n)}),t},[He]);const ze=e=>{q.current&&(cancelAnimationFrame(q.current),q.current=null);const t=O[e];if(!t||0===t.length)return;X.current=!0,Y(!0);const n=Date.now(),r=Math.max(1e3,500*t.length),s=()=>{const t=Date.now()-n,o=Math.min(t/r,1);J(o),o<1?q.current=requestAnimationFrame(s):(q.current=null,setTimeout(()=>{X.current?ze(e):Y(!1)},500))};q.current=requestAnimationFrame(s)};return p.useEffect(()=>()=>{X.current=!1,q.current&&cancelAnimationFrame(q.current),U.current&&clearInterval(U.current)},[]),t.jsx(n,{component:"main",role:"main","aria-label":"ê³µê²© ê²½ë¡œ ì‹œê°í™”",className:"offensive-strategy-container",sx:{width:"100%",height:"calc(100vh - 120px)",bgcolor:"background.paper",boxShadow:3,m:0},children:t.jsxs(r,{sx:{p:1,height:"100%","&:last-child":{pb:1},display:"flex",flexDirection:{xs:"column",lg:"row"},gap:1,overflow:"hidden"},children:[t.jsx(n,{component:"section","aria-label":"Device Topology ì˜ì—­",className:"attack-graph-section",sx:{flex:1,position:"relative",overflow:"hidden",height:"100%"},children:t.jsxs(r,{sx:{p:0,height:"100%","&:last-child":{pb:0},position:"relative"},children:[t.jsxs(s,{className:"status-bar",children:[t.jsx(o,{variant:"caption",color:"inherit",children:k?"ê³µê²© ê²½ë¡œ ë¶„ì„ ì¤‘...":e?`ê³µê²© ëª©í‘œ: ${le}${H?" (ì‹œì‘ ë…¸ë“œ ì„ íƒë¨)":""}`:0===ae?"ğŸ¯ ëª©ì ì§€ ë…¸ë“œë¥¼ ë¨¼ì € í´ë¦­í•˜ì„¸ìš”":1===ae?`ğŸ¯ ëª©ì ì§€: ${le} | ğŸš€ ì¶œë°œì§€ ë…¸ë“œë¥¼ í´ë¦­í•˜ì„¸ìš”`:`ğŸ¯ ëª©ì ì§€: ${le} | ğŸš€ ì¶œë°œì§€ ì„ íƒë¨ (ë‹¤ë¥¸ ì¶œë°œì§€ í´ë¦­ ê°€ëŠ¥)`}),t.jsxs(s,{sx:{display:"flex",gap:1},children:[t.jsx(l,{size:"small",onClick:()=>m("treatAnalysis"),sx:{bgcolor:"#7c3aed",color:"white","&:hover":{bgcolor:"#6d28d9"},width:32,height:32},title:"ìœ„í—˜ ë¶„ì„ ë³´ê¸°",children:t.jsx(y,{style:{fontSize:16}})}),!e&&ae>0&&t.jsx(i,{size:"small",variant:"contained",onClick:()=>{X.current=!1,q.current&&(cancelAnimationFrame(q.current),q.current=null),Y(!1),z(null),P(null),oe(null),he(null),ce(0),V(""),$([]);const e=T.current??R;if(je.current&&ve.current){const t=(e.nodes||[]).map(e=>({id:e.id,size:12,borderWidth:2,color:{border:"#205AAA"},shadow:{enabled:!1}})),n=(e.edges||[]).map(e=>({id:e.id,color:{color:"#848484"},width:1,shadow:{enabled:!1}}));je.current.update(t),ve.current.update(n)}},sx:{bgcolor:"#f44336",color:"white","&:hover":{bgcolor:"#d32f2f"},fontSize:11,py:.5,px:1.5},children:"ì „ì²´ ì´ˆê¸°í™”"}),e&&H&&t.jsx(i,{size:"small",variant:"contained",onClick:()=>{X.current=!1,q.current&&(cancelAnimationFrame(q.current),q.current=null),Y(!1),z(null),P(null);const e=T.current??R;if(je.current&&ve.current){const t=(e.nodes||[]).map(e=>({id:e.id,size:12,borderWidth:2,color:{border:"#205AAA"},shadow:{enabled:!1}})),n=(e.edges||[]).map(e=>({id:e.id,color:{color:"#848484"},width:1,shadow:{enabled:!1}}));je.current.update(t),ve.current.update(n)}},sx:{bgcolor:"#4CAF50",color:"white","&:hover":{bgcolor:"#45a049"},fontSize:11,py:.5,px:1.5},children:"ì‹œì‘ ë…¸ë“œ ì´ˆê¸°í™”"})]})]}),t.jsx("div",{ref:C,role:"img","aria-label":"Device Topologyë¥¼ í‘œì‹œí•˜ëŠ” ë„¤íŠ¸ì›Œí¬ ê·¸ë˜í”„",className:"attack-graph-canvas"}),t.jsx("canvas",{ref:K,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",zIndex:5}}),t.jsx(s,{className:"legend-box",sx:{maxHeight:200,overflowY:"auto"},children:t.jsxs("ul",{className:"legend-list",role:"list",children:[t.jsxs("li",{className:"legend-item",children:[t.jsx(s,{className:"legend-dot start","aria-hidden":"true"}),t.jsx(o,{variant:"caption",sx:{color:"#fff"},children:"ì‹œì‘ ë…¸ë“œ"})]}),t.jsxs("li",{className:"legend-item",children:[t.jsx(s,{className:"legend-dot target","aria-hidden":"true"}),t.jsx(o,{variant:"caption",sx:{color:"#fff"},children:"ëª©í‘œ ë…¸ë“œ"})]}),O&&O.length>0&&t.jsxs(t.Fragment,{children:[t.jsx("li",{className:"legend-item",style:{marginTop:8,marginBottom:4},children:t.jsx(o,{variant:"caption",sx:{color:"#fff",fontWeight:"bold"},children:"ìˆœìœ„ë³„ ê²½ë¡œ:"})}),[...Array(Math.min(O.length,5))].map((e,n)=>t.jsxs("li",{className:"legend-item",children:[t.jsx(s,{sx:{width:20,height:4,bgcolor:ye[n].edge,borderRadius:2,boxShadow:`0 0 6px ${ye[n].edge}`},"aria-hidden":"true"}),t.jsxs(o,{variant:"caption",sx:{color:"#fff",ml:.5},children:[n+1,"ìˆœìœ„"]})]},n)),O.length>5&&t.jsx("li",{className:"legend-item",children:t.jsxs(o,{variant:"caption",sx:{color:"#aaa",fontSize:10},children:["...ì™¸ ",O.length-5,"ê°œ"]})})]}),G&&t.jsxs("li",{className:"legend-item",style:{marginTop:8},children:[t.jsx(s,{sx:{width:12,height:12,borderRadius:"50%",bgcolor:"#FF1493",boxShadow:"0 0 10px #FF1493"},"aria-hidden":"true"}),t.jsx(o,{variant:"caption",sx:{color:"#fff"},children:"ê²½ë¡œ ì´ë™ ì¤‘"})]})]})})]})}),(H||!e&&ae>=1)&&t.jsxs(s,{component:"aside","aria-label":"ê²½ë¡œ ì •ë³´ íŒ¨ë„",className:"right-panel",sx:{width:{xs:"100%",lg:400},maxWidth:{xs:"100%",lg:400}},children:[t.jsx(n,{component:"section","aria-label":"ì‹œì‘ ë° ëª©í‘œ ë…¸ë“œ ì •ë³´",className:"info-card",children:t.jsxs(r,{children:[t.jsx(o,{variant:"body2",component:"h3",className:"card-title",children:"ğŸ“ ì‹œì‘ ë° ëª©í‘œ ë…¸ë“œ"}),t.jsxs(s,{sx:{fontSize:12,color:"#555",display:"grid",gap:.5},children:[Ne?t.jsxs(s,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsxs("span",{children:[t.jsx("strong",{children:"ì‹œì‘:"})," ",Ne.label||Ne.id]}),t.jsx(i,{size:"small",variant:"outlined",onClick:()=>we(Ne),sx:{ml:1},children:"ìƒì„¸ì •ë³´"})]}):t.jsx(s,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",bgcolor:"#fff3e0",p:1,borderRadius:1},children:t.jsx(o,{variant:"caption",sx:{color:"#e65100"},children:"ğŸš€ ì¶œë°œì§€ ë…¸ë“œë¥¼ í´ë¦­í•˜ì„¸ìš”"})}),!e&&pe?t.jsxs(s,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsxs("span",{children:[t.jsx("strong",{children:"ëª©í‘œ:"})," ",pe.name||pe.label]}),t.jsx(i,{size:"small",variant:"outlined",onClick:()=>we(pe),sx:{ml:1},children:"ìƒì„¸ì •ë³´"})]}):Ie?t.jsxs(s,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsxs("span",{children:[t.jsx("strong",{children:"ëª©í‘œ:"})," ",Ie.label||Ie.id]}),t.jsx(i,{size:"small",variant:"outlined",onClick:()=>we(Ie),sx:{ml:1},children:"ìƒì„¸ì •ë³´"})]}):t.jsx(o,{variant:"caption",className:"empty-message",children:"ëª©í‘œ ë…¸ë“œ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤"})]})]})}),t.jsx(n,{component:"section","aria-label":"ê²½ë¡œ ë¦¬ìŠ¤íŠ¸",className:"info-card scrollable",sx:{flex:1,minHeight:0},children:t.jsxs(r,{sx:{height:"100%",display:"flex",flexDirection:"column",flex:1,"&:last-child":{pb:2}},children:[t.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[t.jsx(o,{variant:"body2",component:"h3",className:"card-title",children:"ğŸ›¤ï¸ ë°©ì±… ë¦¬ìŠ¤íŠ¸"}),null!==D&&t.jsx(i,{size:"small",variant:"outlined",onClick:()=>P(null),sx:{fontSize:11,py:.5,px:1},children:"ì´ˆê¸°í™”"})]}),t.jsx(s,{className:"card-content-scroll",sx:{overflowX:"auto"},children:0===He.length?t.jsx(o,{variant:"caption",className:"empty-message",children:"ê²½ë¡œê°€ ì—†ìŠµë‹ˆë‹¤"}):t.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{style:{textAlign:"left",padding:"6px 8px",borderBottom:"1px solid #ccc"},children:"ìˆœìœ„"}),t.jsx("th",{style:{textAlign:"left",padding:"6px 8px",borderBottom:"1px solid #ccc"},children:"ë°©ì±… No."}),t.jsx("th",{style:{textAlign:"left",padding:"6px 8px",borderBottom:"1px solid #ccc"},children:"ë…¸ë“œ ìˆ˜"}),t.jsx("th",{style:{textAlign:"left",padding:"6px 8px",borderBottom:"1px solid #ccc"},children:"ì„±ê³µ ê°€ëŠ¥ì„±"})]})}),t.jsx("tbody",{children:[...He].sort((e,t)=>(t.success??-1)-(e.success??-1)).map((e,n)=>{const r=n+1,o=ye[Math.min(n,ye.length-1)],l=null==e.success?"N/A":`${(100*e.success).toFixed(2)}%`,i=D===e.index,d=null!==D&&D!==e.index;return t.jsxs("tr",{onClick:()=>{return t=e.index,X.current=!1,q.current&&(cancelAnimationFrame(q.current),q.current=null),Y(!1),J(0),P(t),(e=>{U.current&&clearInterval(U.current),V("");let t=0;const n=setInterval(()=>{t+=1,V(e.slice(0,t)),t>=e.length&&(clearInterval(n),U.current=null)},12);U.current=n})((e=>{const t=O?.[e]||[],n=[];n.push(`ë°©ì±… ${e+1} ê³„ì‚° ì‹œì‘`);const r=[];for(let s=0;s<t.length;s++){const e=t[s],o=(M.nodes||[]).find(t=>t.id===e.id)||e,l=Te(o),i=Le(o.id),d=Me(o),a=Fe(o);n.push(`- ë…¸ë“œ ${s+1}: ${o.label||o.id} â†’ HRN ${l.toFixed(2)}, NLS ${i.toFixed(2)}, CPS ${d.toFixed(2)} â‡’ ê°€ëŠ¥ë„ ${(100*a).toFixed(2)}%`);const c=ke(o);"number"==typeof c&&r.push(c)}if(r.length&&null!=We&&We>0){const t=r.reduce((e,t)=>e+t,0)/r.length;n.push(`RS í‰ê· (ê²½ë¡œ) = ${(100*t).toFixed(2)}%, RS í‰ê· (ë„¤íŠ¸ì›Œí¬) = ${(100*We).toFixed(2)}%`);const s=Math.min(Math.max(t/We,0),1);n.push(`ê²°ë¡ : ë°©ì±… ${e+1}ì˜ ì„±ê³µ ê°€ëŠ¥ì„± = ${(100*s).toFixed(2)}%`)}else n.push("RS ë°ì´í„°ë¥¼ ì¶©ë¶„íˆ ìˆ˜ì§‘í•˜ì§€ ëª»í•´ ë°©ì±… ì„±ê³µ ê°€ëŠ¥ì„±ì„ ê³„ì‚°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");return n.join("\n")})(t)),void setTimeout(()=>{ze(t)},100);var t},style:{background:i?o.edge+"30":"#f9f9f9",opacity:d?.35:1,cursor:"pointer",borderLeft:`4px solid ${o.edge}`,borderBottom:"1px solid #eee",transition:"all 0.2s ease"},children:[t.jsx("td",{style:{padding:"8px",display:"flex",alignItems:"center",gap:6},children:t.jsx(s,{sx:{width:20,height:20,borderRadius:"50%",bgcolor:o.edge,color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:"bold",boxShadow:`0 0 6px ${o.shadow}`},children:r})}),t.jsx("td",{style:{padding:"8px"},children:`ë°©ì±… ${e.index+1}`}),t.jsx("td",{style:{padding:"8px"},children:e.nodeCount}),t.jsx("td",{style:{padding:"8px",fontWeight:i?"bold":"normal"},children:l})]},e.index)})})]})})]})}),t.jsx(n,{component:"section","aria-label":"ê²½ë¡œ ë…¸ë“œ ì •ë³´",className:"info-card scrollable",sx:{flex:1,minHeight:0},children:t.jsxs(r,{sx:{height:"100%",display:"flex",flexDirection:"column",flex:1,"&:last-child":{pb:2}},children:[t.jsx(o,{variant:"body2",component:"h3",className:"card-title",children:"ğŸ”— ê²½ë¡œ ë…¸ë“œ ì •ë³´"}),t.jsxs(s,{className:"card-content-scroll",sx:{overflowX:"auto"},children:[t.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{style:{textAlign:"left",padding:"6px 8px",borderBottom:"1px solid #ccc"},children:"ë…¸ë“œ No"}),t.jsx("th",{style:{textAlign:"left",padding:"6px 8px",borderBottom:"1px solid #ccc"},children:"ê²½ë¡œ No"}),t.jsx("th",{style:{textAlign:"left",padding:"6px 8px",borderBottom:"1px solid #ccc"},children:"ë…¸ë“œ ì •ë³´"}),t.jsx("th",{style:{textAlign:"left",padding:"6px 8px",borderBottom:"1px solid #ccc"},children:"ì·¨ì•½ì  ê°œìˆ˜/í‰ê· "}),t.jsx("th",{style:{textAlign:"left",padding:"6px 8px",borderBottom:"1px solid #ccc"},children:"ê°€ëŠ¥ë„"})]})}),t.jsx("tbody",{children:null!==D&&O[D]?O[D].map((e,n)=>{const r=(M.nodes||[]).find(t=>t.id===e.id)||e,s=r?.properties||r?.props||{},o=s.cveInfos||[],l=Array.isArray(o)?o.length:0;let i=0;if(l>0&&Array.isArray(o)){const e=o.map(e=>{const t=e?.props||e||{},n=t.cvss3??t.cvss??t.baseScore??t.score??t.score_value??t.severity_score;return"number"==typeof n?n:parseFloat(n)||0}).filter(e=>!isNaN(e)&&e>0);e.length>0&&(i=e.reduce((e,t)=>e+t,0)/e.length)}const d=Fe(r),a=r?.label||r?.name||s?.name||s?.label||e?.label||`Node ${n+1}`;return t.jsxs("tr",{style:{borderBottom:"1px solid #eee",cursor:"default"},children:[t.jsx("td",{style:{padding:"8px",verticalAlign:"top"},children:n+1}),t.jsx("td",{style:{padding:"8px",verticalAlign:"top"},children:D+1}),t.jsx("td",{style:{padding:"8px",verticalAlign:"top",maxWidth:180,wordBreak:"break-word",color:"#1976d2",cursor:"pointer",textDecoration:"underline"},onClick:()=>{re(r),te(!0)},children:a}),t.jsx("td",{style:{padding:"8px",verticalAlign:"top"},children:l>0?`${l}ê°œ / ${i.toFixed(2)}ì `:"0ê°œ / N/A"}),t.jsxs("td",{style:{padding:"8px",verticalAlign:"top"},children:[(100*d).toFixed(2),"%"]})]},`${D}-${n}`)}):(O||[]).flatMap((e,n)=>(e||[]).map((e,r)=>{const s=(M.nodes||[]).find(t=>t.id===e.id)||e,o=s?.properties||s?.props||{},l=o.cveInfos||[],i=Array.isArray(l)?l.length:0;let d=0;if(i>0&&Array.isArray(l)){const e=l.map(e=>{const t=e?.props||e||{},n=t.cvss3??t.cvss??t.baseScore??t.score??t.score_value??t.severity_score;return"number"==typeof n?n:parseFloat(n)||0}).filter(e=>!isNaN(e)&&e>0);e.length>0&&(d=e.reduce((e,t)=>e+t,0)/e.length)}const a=Fe(s),c=s?.label||s?.name||o?.name||o?.label||e?.label||`Node ${r+1}`;return t.jsxs("tr",{style:{borderBottom:"1px solid #eee",cursor:"default"},children:[t.jsx("td",{style:{padding:"8px",verticalAlign:"top"},children:r+1}),t.jsx("td",{style:{padding:"8px",verticalAlign:"top"},children:n+1}),t.jsx("td",{style:{padding:"8px",verticalAlign:"top",maxWidth:180,wordBreak:"break-word",color:"#1976d2",cursor:"pointer",textDecoration:"underline"},onClick:()=>{re(s),te(!0)},children:c}),t.jsx("td",{style:{padding:"8px",verticalAlign:"top"},children:i>0?`${i}ê°œ / ${d.toFixed(2)}ì `:"0ê°œ / N/A"}),t.jsxs("td",{style:{padding:"8px",verticalAlign:"top"},children:[(100*a).toFixed(2),"%"]})]},`${n}-${r}`)}))})]}),(!O||0===O.length)&&t.jsx(o,{variant:"caption",className:"empty-message",sx:{mt:1},children:"ê²½ë¡œê°€ ì—†ìŠµë‹ˆë‹¤"})]})]})}),t.jsx(n,{component:"section","aria-label":"ê³„ì‚° ë¡œê·¸",className:"info-card scrollable",sx:{flex:1,minHeight:0},children:t.jsxs(r,{sx:{height:"100%",display:"flex",flexDirection:"column",flex:1,"&:last-child":{pb:2}},children:[t.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[t.jsx(o,{variant:"body2",component:"h3",className:"card-title",children:"ğŸ“‹ ê³„ì‚° ë¡œê·¸"}),t.jsx(l,{size:"small",onClick:()=>Q(!0),sx:{width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"#e3f2fd",border:"1px solid #90caf9",borderRadius:"50%","&:hover":{bgcolor:"#bbdefb"}},children:t.jsx(w,{style:{fontSize:16,color:"#1976d2"}})})]}),t.jsx(s,{className:"card-content-scroll",sx:{fontFamily:"monospace",whiteSpace:"pre-wrap",fontSize:11},children:B&&B.length>0?B:t.jsx(o,{variant:"caption",className:"empty-message",children:"ë°©ì±… ë¦¬ìŠ¤íŠ¸ì—ì„œ ê²½ë¡œë¥¼ ì„ íƒí•˜ë©´ ê³„ì‚° ê³¼ì •ì„ íƒ€ì´í•‘ ì• ë‹ˆë©”ì´ì…˜ìœ¼ë¡œ í‘œì‹œí•©ë‹ˆë‹¤."})})]})})]}),t.jsxs(d,{open:v,onClose:()=>j("treatAnalysis"),maxWidth:"md",fullWidth:!0,PaperProps:{sx:{height:"70vh",maxHeight:"70vh",m:0,position:"relative",overflow:"hidden"}},children:[t.jsx(l,{onClick:()=>j("treatAnalysis"),sx:{position:"absolute",right:23,top:8.5,color:"#000000ff",zIndex:1,bgcolor:"#cac7d4ff","&:hover":{bgcolor:"#39306b",color:"#ffffffff"}},children:"x"}),t.jsx(a,{sx:{p:0,height:"100%",overflow:"hidden"},children:t.jsx(N,{open:v,isPopup:!0})})]}),t.jsxs(d,{open:Z,onClose:()=>Q(!1),maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:2,bgcolor:"#f0edfd"}},children:[t.jsx(s,{sx:{p:3,bgcolor:"#7c3aed",color:"white"},children:t.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:0},children:[t.jsx(o,{variant:"h6",sx:{fontWeight:"bold"},children:"ğŸ“Š ê³µê²© ê°€ëŠ¥ë„ & ì„±ê³µ ê°€ëŠ¥ì„± ë¶„ì„"}),t.jsx(l,{onClick:()=>Q(!1),sx:{color:"white","&:hover":{bgcolor:"rgba(255,255,255,0.2)"}},children:"âœ•"})]})}),t.jsx(a,{sx:{p:3,bgcolor:"#f0edfd"},children:t.jsxs(s,{sx:{display:"flex",flexDirection:"column",gap:3},children:[t.jsxs(c,{sx:{p:2,bgcolor:"#fff",borderLeft:"4px solid #ff6b6b",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[t.jsx(o,{variant:"subtitle1",sx:{fontWeight:"bold",color:"#ff6b6b",mb:1},children:"ğŸ”´ HRN (ê³ ìœ„í—˜ ë…¸ë“œ ì ìˆ˜)"}),t.jsxs(o,{variant:"body2",sx:{lineHeight:1.6,color:"#333"},children:["ë…¸ë“œì˜ ë³´ì•ˆ ìœ„í—˜ë„ë¥¼ ì¸¡ì •í•˜ëŠ” ì ìˆ˜ì…ë‹ˆë‹¤.",t.jsx("br",{}),t.jsx("strong",{children:"ì¸¡ì • ê¸°ì¤€:"}),t.jsxs("ul",{style:{margin:"8px 0",paddingLeft:"20px"},children:[t.jsx("li",{children:"ë…¸ë“œì˜ ê³ ìœ„í—˜ ì·¨ì•½ì  ê°œìˆ˜ â‰¥ ì „ì²´ ì·¨ì•½ì  ê°œìˆ˜ì˜ 50% ì´ìƒ â†’ ê³ ìœ„í—˜ ì ìˆ˜ ë¶€ì—¬"}),t.jsx("li",{children:"ë…¸ë“œì˜ CVE ê°œìˆ˜ > í‰ê·  CVE ê°œìˆ˜ â†’ ê³ ìœ„í—˜ ì ìˆ˜(HRN) ë¶€ì—¬"}),t.jsx("li",{children:"ì ìˆ˜ ë²”ìœ„: 1~3 (1: ë‚®ìŒ, 3: ë†’ìŒ)"})]})]})]}),t.jsxs(c,{sx:{p:2,bgcolor:"#fff",borderLeft:"4px solid #4ecdc4",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[t.jsx(o,{variant:"subtitle1",sx:{fontWeight:"bold",color:"#4ecdc4",mb:1},children:"ğŸ”— NLS (ì—°ê²° ì¤‘ìš”ë„ ì ìˆ˜)"}),t.jsxs(o,{variant:"body2",sx:{lineHeight:1.6,color:"#333"},children:["ë„¤íŠ¸ì›Œí¬ ë‚´ì—ì„œ ë‹¤ë¥¸ ë…¸ë“œì™€ì˜ ì—°ê²° ì¤‘ìš”ë„ì…ë‹ˆë‹¤.",t.jsx("br",{}),t.jsx("strong",{children:"íŠ¹ì§•:"}),t.jsxs("ul",{style:{margin:"8px 0",paddingLeft:"20px"},children:[t.jsx("li",{children:"ë†’ì„ìˆ˜ë¡ ë³´ì•ˆ ìœ„í—˜ë„ ìƒìŠ¹ â¬†ï¸"}),t.jsx("li",{children:"ë§ì€ ì—°ê²°ì„ í†µí•´ ê³µê²©ì´ ë¹ ë¥´ê²Œ í™•ì‚°ë  ìˆ˜ ìˆìŒ"}),t.jsx("li",{children:"ë„¤íŠ¸ì›Œí¬ í—ˆë¸Œ ì—­í• ì„ í•˜ëŠ” ë…¸ë“œê°€ ë†’ì€ NLSë¥¼ ê°€ì§"})]})]})]}),t.jsxs(c,{sx:{p:2,bgcolor:"#fff",borderLeft:"4px solid #ffa502",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[t.jsx(o,{variant:"subtitle1",sx:{fontWeight:"bold",color:"#ffa502",mb:1},children:"âš”ï¸ ê³µê²© ê°€ëŠ¥ë„ (Exploitability)"}),t.jsxs(o,{variant:"body2",sx:{lineHeight:1.6,color:"#333"},children:["ë„¤íŠ¸ì›Œí¬ ê²½ë¡œë¥¼ í†µí•œ ì‹¤ì œ ê³µê²© ê°€ëŠ¥ì„±ì„ ì¸¡ì •í•©ë‹ˆë‹¤.",t.jsx("br",{}),t.jsx("strong",{children:"ê³„ì‚° ê³µì‹:"}),t.jsx("div",{style:{bgcolor:"#fff9e6",padding:"12px",borderRadius:"4px",fontFamily:"monospace",fontSize:"13px",margin:"8px 0",border:"1px solid #ffe58f"},children:"ê³µê²© ê°€ëŠ¥ë„ = (HRN + NLS) Ã— CPS"}),t.jsx("strong",{children:"êµ¬ì„± ìš”ì†Œ:"}),t.jsxs("ul",{style:{margin:"8px 0",paddingLeft:"20px"},children:[t.jsxs("li",{children:[t.jsx("strong",{children:"HRN:"})," ê³ ìœ„í—˜ ë…¸ë“œ ì ìˆ˜"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"NLS:"})," ì—°ê²° ì¤‘ìš”ë„ ì ìˆ˜"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"CPS:"})," ë„¤íŠ¸ì›Œí¬ ì¤‘ì‹¬ ì ìˆ˜ (1 - ì¤‘ì‹¬ì„±) ",t.jsx("br",{}),"â†’ ë‚®ì„ìˆ˜ë¡ ê°ì‹œê°€ ì–´ë ¤ì›Œ ìœ„í—˜ë„ ìƒìŠ¹"]})]})]})]}),t.jsxs(c,{sx:{p:2,bgcolor:"#fff",borderLeft:"4px solid #00b4d8",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[t.jsx(o,{variant:"subtitle1",sx:{fontWeight:"bold",color:"#00b4d8",mb:1},children:"âœ… ê³µê²© ì„±ê³µ ê°€ëŠ¥ì„± (Success Probability)"}),t.jsxs(o,{variant:"body2",sx:{lineHeight:1.6,color:"#333"},children:["íŠ¹ì • ê²½ë¡œì—ì„œ ê³µê²©ì´ ì„±ê³µí•  ê°€ëŠ¥ì„±ì„ ì¸¡ì •í•©ë‹ˆë‹¤.",t.jsx("br",{}),t.jsx("strong",{children:"ì¸¡ì • ë‹¨ê³„:"}),t.jsxs("ol",{style:{margin:"8px 0",paddingLeft:"20px"},children:[t.jsxs("li",{children:[t.jsx("strong",{children:"RS ì ìˆ˜ ì‚°ì¶œ:"})," ê° ë…¸ë“œì˜ ì·¨ì•½ì  ì‹¬ê°ë„ì™€ ì˜í–¥ë„ ê³„ì‚°",t.jsx("div",{style:{fontSize:"12px",margin:"4px 0",color:"#666"},children:"RS = (ì·¨ì•½ì  ì ìˆ˜ í‰ê·  Ã— (Cë²¡í„° + Ië²¡í„° + Aë²¡í„°) / 3)"})]}),t.jsxs("li",{children:[t.jsx("strong",{children:"ê²½ë¡œì˜ RS í‰ê· :"})," ì—°ê²°ëœ ëª¨ë“  ë…¸ë“œì˜ RS ì ìˆ˜ í‰ê· "]}),t.jsxs("li",{children:[t.jsx("strong",{children:"ì „ì²´ ë„¤íŠ¸ì›Œí¬ RS í‰ê· :"})," ë§ ì „ì²´ì˜ í‰ê·  RS ì ìˆ˜"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"ì„±ê³µ ê°€ëŠ¥ì„±:"})," ê²½ë¡œ RS í‰ê·  Ã· ì „ì²´ ë„¤íŠ¸ì›Œí¬ RS í‰ê· ",t.jsx("div",{style:{fontSize:"12px",margin:"4px 0",color:"#666"},children:"= ê²½ë¡œì˜ í‰ê·  ì·¨ì•½ì„± / ì „ì²´ ë„¤íŠ¸ì›Œí¬ í‰ê·  ì·¨ì•½ì„±"})]})]}),t.jsx("strong",{children:"í•´ì„:"}),t.jsxs("ul",{style:{margin:"8px 0",paddingLeft:"20px"},children:[t.jsx("li",{children:"> 100%: í‰ê· ë³´ë‹¤ ì·¨ì•½í•œ ê²½ë¡œ"}),t.jsx("li",{children:"= 100%: í‰ê·  ìˆ˜ì¤€ì˜ ì·¨ì•½ì„±"}),t.jsx("li",{children:"< 100%: í‰ê· ë³´ë‹¤ ì•ˆì „í•œ ê²½ë¡œ"})]})]})]}),t.jsxs(c,{sx:{p:2,bgcolor:"#e8f0fd",borderLeft:"4px solid #7c3aed",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[t.jsx(o,{variant:"subtitle1",sx:{fontWeight:"bold",mb:1,color:"#7c3aed"},children:"ğŸ¯ ì¢…í•© ë¶„ì„"}),t.jsx(o,{variant:"body2",sx:{lineHeight:1.6,color:"#333"},children:t.jsxs("ul",{style:{margin:"8px 0",paddingLeft:"20px"},children:[t.jsxs("li",{children:[t.jsx("strong",{children:"ê³µê²© ê°€ëŠ¥ë„"}),": ê²½ë¡œ ìì²´ê°€ ì–¼ë§ˆë‚˜ ê³µê²©ë°›ì„ ìˆ˜ ìˆëŠ”ê°€?"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"ê³µê²© ì„±ê³µ ê°€ëŠ¥ì„±"}),": ê²½ë¡œë¥¼ í†µí•œ ê³µê²©ì´ ì„±ê³µí•  í™•ë¥ ì€?"]}),t.jsx("li",{children:"ë†’ì€ ê³µê²© ê°€ëŠ¥ë„ + ë†’ì€ ì„±ê³µ ê°€ëŠ¥ì„± = ğŸ“ ê°€ì¥ ìœ„í—˜í•œ ê²½ë¡œ"})]})})]})]})})]}),t.jsxs(d,{open:ee,onClose:()=>te(!1),maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:2}},children:[t.jsx(s,{sx:{p:3,bgcolor:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white"},children:t.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[t.jsx(o,{variant:"h6",sx:{fontWeight:"bold"},children:"ğŸ” ë…¸ë“œ ìƒì„¸ ì •ë³´"}),t.jsx(l,{onClick:()=>te(!1),sx:{color:"white","&:hover":{bgcolor:"rgba(255,255,255,0.2)"}},children:"âœ•"})]})}),t.jsx(a,{sx:{p:3},children:ne&&(()=>{const e=ne?.properties||ne?.props||{},n=e.cveInfos||[],r=ne?.label||ne?.name||e?.name||e?.label||"Unknown",l=ne?.nodeType||e?.type||"Unknown",i=ne?.ip||e?.ip||"N/A",d=e?.id||ne?.id||"N/A";return t.jsxs(s,{sx:{display:"flex",flexDirection:"column",gap:2},children:[t.jsxs(c,{sx:{p:2,bgcolor:"#f5f5f5"},children:[t.jsx(o,{variant:"subtitle1",sx:{fontWeight:"bold",mb:2,color:"#1976d2"},children:"ğŸ“‹ ê¸°ë³¸ ì •ë³´"}),t.jsx("table",{style:{width:"100%",borderCollapse:"collapse"},children:t.jsxs("tbody",{children:[t.jsxs("tr",{style:{borderBottom:"1px solid #ddd"},children:[t.jsx("td",{style:{padding:"8px",fontWeight:"bold",width:"30%",background:"#e3f2fd"},children:"ë…¸ë“œ ì´ë¦„"}),t.jsx("td",{style:{padding:"8px"},children:r})]}),t.jsxs("tr",{style:{borderBottom:"1px solid #ddd"},children:[t.jsx("td",{style:{padding:"8px",fontWeight:"bold",background:"#e3f2fd"},children:"ë…¸ë“œ íƒ€ì…"}),t.jsx("td",{style:{padding:"8px"},children:l})]}),t.jsxs("tr",{style:{borderBottom:"1px solid #ddd"},children:[t.jsx("td",{style:{padding:"8px",fontWeight:"bold",background:"#e3f2fd"},children:"IP ì£¼ì†Œ"}),t.jsx("td",{style:{padding:"8px"},children:i})]}),t.jsxs("tr",{style:{borderBottom:"1px solid #ddd"},children:[t.jsx("td",{style:{padding:"8px",fontWeight:"bold",background:"#e3f2fd"},children:"ë…¸ë“œ ID"}),t.jsx("td",{style:{padding:"8px",fontFamily:"monospace",fontSize:"12px"},children:d})]})]})})]}),t.jsxs(c,{sx:{p:2,bgcolor:"#fff3e0"},children:[t.jsxs(o,{variant:"subtitle1",sx:{fontWeight:"bold",mb:2,color:"#f57c00"},children:["ğŸ›¡ï¸ ì·¨ì•½ì  ì •ë³´ (",Array.isArray(n)?n.length:0,"ê°œ)"]}),Array.isArray(n)&&n.length>0?t.jsx(s,{sx:{maxHeight:300,overflowY:"auto"},children:t.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px"},children:[t.jsx("thead",{style:{position:"sticky",top:0,background:"#ffe0b2",zIndex:1},children:t.jsxs("tr",{children:[t.jsx("th",{style:{padding:"8px",textAlign:"left",borderBottom:"2px solid #ff9800"},children:"CVE ID"}),t.jsx("th",{style:{padding:"8px",textAlign:"left",borderBottom:"2px solid #ff9800"},children:"CVSS ì ìˆ˜"}),t.jsx("th",{style:{padding:"8px",textAlign:"left",borderBottom:"2px solid #ff9800"},children:"ì‹¬ê°ë„"}),t.jsx("th",{style:{padding:"8px",textAlign:"left",borderBottom:"2px solid #ff9800"},children:"ë²¡í„° ë¬¸ìì—´"})]})}),t.jsx("tbody",{children:n.map((e,n)=>{const r=e?.props||e||{},s=r.cveId||`CVE-${n+1}`,o=r.baseScore||"N/A",l="N/A"!==o&&"number"==typeof o?o>=9?"CRITICAL":o>=7?"HIGH":o>=4?"MEDIUM":"LOW":"N/A",i=r.vectorString||"N/A",d="CRITICAL"===l?"#d32f2f":"HIGH"===l?"#f57c00":"MEDIUM"===l?"#fbc02d":"LOW"===l?"#388e3c":"#757575";return t.jsxs("tr",{style:{borderBottom:"1px solid #ffe0b2"},children:[t.jsx("td",{style:{padding:"8px",fontFamily:"monospace",fontSize:"12px"},children:s}),t.jsx("td",{style:{padding:"8px",fontWeight:"bold"},children:o}),t.jsx("td",{style:{padding:"8px"},children:t.jsx("span",{style:{color:"white",background:d,padding:"2px 8px",borderRadius:"4px",fontSize:"11px",fontWeight:"bold"},children:l})}),t.jsx("td",{style:{padding:"8px",maxWidth:"300px",wordBreak:"break-word",fontSize:"12px"},children:"string"==typeof i&&i.length>100?i.substring(0,100)+"...":i})]},n)})})]})}):t.jsx(o,{variant:"body2",sx:{color:"#666",fontStyle:"italic"},children:"ì·¨ì•½ì  ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤."})]}),t.jsxs(c,{sx:{p:2,bgcolor:"#f5f5f5"},children:[t.jsx(o,{variant:"subtitle1",sx:{fontWeight:"bold",mb:2,color:"#7b1fa2"},children:"âš™ï¸ ì¶”ê°€ ì†ì„±"}),t.jsx(s,{sx:{maxHeight:200,overflowY:"auto"},children:t.jsx("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"12px"},children:t.jsxs("tbody",{children:[Object.entries(e).filter(([e])=>!["cveInfos","vulnerabilities","cves"].includes(e)).map(([e,n],r)=>t.jsxs("tr",{style:{borderBottom:"1px solid #ddd"},children:[t.jsx("td",{style:{padding:"6px 8px",fontWeight:"bold",width:"30%",background:"#ede7f6"},children:e}),t.jsx("td",{style:{padding:"6px 8px",wordBreak:"break-all",fontFamily:"monospace",fontSize:"11px"},children:"object"==typeof n?JSON.stringify(n):String(n)})]},r)),0===Object.keys(e).filter(e=>!["cveInfos","vulnerabilities","cves"].includes(e)).length&&t.jsx("tr",{children:t.jsx("td",{colSpan:2,style:{padding:"8px",textAlign:"center",color:"#666",fontStyle:"italic"},children:"ì¶”ê°€ ì†ì„±ì´ ì—†ìŠµë‹ˆë‹¤."})})]})})})]})]})})()})]})]})})}const R=p.memo(()=>{const e=h(),n=e.state?.selectedNode;let r=null;if(n?.dbInfo&&n.dbInfo.length>0){const e=n.dbInfo[0];r=e.dst_IP?.name||e.src_IP?.name}return r||(r=n?.name||n?.label||n?.id),t.jsx(A,{deviceElementId:r})});R.displayName="ResponseEffectVisualization";export{R as default};
