const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/index-DRYO-r2x.js","assets/js/mui-vendor-Cx2AKDA_.js","assets/js/react-vendor-DGL7KyM8.js","assets/js/vis-network-CqERLR1V.js","assets/js/index-Bl1fKuzj.js","assets/js/chart-vendor-DPhWNalc.js","assets/js/three-vendor-4AZqXyaM.js","assets/css/index-vnMvSBSu.css","assets/js/ConsoleView-B1YLTX6c.js","assets/js/index-Cm7zPT14.js","assets/js/DataTable-CYd_SIwx.js","assets/js/TrendChart-DXMYXb69.js","assets/js/EventLog-AN9gKSW9.js","assets/js/ClusterOutlined-67qvuQBf.js"])))=>i.map(i=>d[i]);
import{u as e,R as t,d as i,_ as o}from"./index-Bl1fKuzj.js";import{j as r,o as n,t as s,B as l,a3 as c,T as a,I as d,a5 as x,a6 as h}from"./mui-vendor-Cx2AKDA_.js";import{c as f,u as p,a as g}from"./react-vendor-DGL7KyM8.js";import{C as m}from"./ConsoleView-B1YLTX6c.js";function b(e,t,i){return"number"!=typeof e||isNaN(e)||t===i?1:Math.round(1+99*(e-t)/(i-t))}f.memo(({dbTitle:e,dbValue:t,dbSubtext:i,className:o})=>{const n=e||"Default Title",s=t||"Default Value",l=i||"Default Subtext";return r.jsxs("div",{className:o,children:[r.jsx("div",{className:"statistics-card-value",children:s}),r.jsx("div",{className:"statistics-card-title",children:n}),r.jsx("div",{className:"statistics-card-subtext",children:l})]})}).displayName="StatisticsCard";const u=e=>{if(!e)return[];const t=new Set;return e.forEach(e=>{[e.src_IP,e.dst_IP].forEach(e=>{e&&e.type&&t.add(e.type)})}),Array.from(t).sort()},j=({open:e=!0,isPopup:t=!1})=>r.jsx(m,{type:"targetIdentification",open:e,isPopup:t}),y=({open:e=!0,isPopup:t=!1})=>r.jsx(m,{type:"targetPriority",open:e,isPopup:t}),_=g.lazy(()=>o(()=>import("./index-DRYO-r2x.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),v=g.lazy(()=>o(()=>import("./index-Cm7zPT14.js"),__vite__mapDeps([9,1,2,4,5,6,7,8]))),S=g.lazy(()=>o(()=>import("./DataTable-CYd_SIwx.js"),__vite__mapDeps([10,1,2,4,5,6,7,8]))),I=g.lazy(()=>o(()=>import("./TrendChart-DXMYXb69.js"),__vite__mapDeps([11,1,2,5]))),w=g.lazy(()=>o(()=>import("./EventLog-AN9gKSW9.js"),__vite__mapDeps([12,1,2,13,4,5,6,7]))),C=()=>r.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",color:"#666"},children:"Loading..."}),P=Object.freeze(Object.defineProperty({__proto__:null,default:function({onNodeClick:o,data:m,logs:b=[],activeView:P="target"}){const z=p(),[D,W]=g.useState(m||[]),[A,k]=g.useState([]),[E,R]=g.useState({}),[M,T]=g.useState(b),[N,V]=g.useState(null),{popups:L,openPopup:O,closePopup:F}=e(),H=L.targetIdentification,q=L.targetPriority;g.useEffect(()=>{L.targetIdentification||L.targetPriority},[L.targetIdentification,L.targetPriority]);const $=g.useMemo(()=>Array.isArray(D)?D:D?.nodes||D?.network||[],[D]),B=g.useMemo(()=>$.map(e=>({degree_score:e.src_IP?.degree_score||e.dst_IP?.degree_score||0,con_score:e.src_IP?.con_score||e.dst_IP?.con_score||0})),[$]),G=g.useMemo(()=>{const e=new Set;A.forEach(t=>{t.src_IP&&t.src_IP.ip&&e.add(t.src_IP.ip)});let t=0,i=0;e.forEach(e=>{const o=A.find(t=>t.src_IP&&t.src_IP.ip===e)?.src_IP;o&&"number"==typeof o.degree_score&&(o.degree_score>.5?t+=1:o.degree_score>0&&o.degree_score<=.5&&(i+=1))});const o={};A.forEach(e=>{[e.src_IP,e.dst_IP].forEach(e=>{e&&e.type&&(o[e.type]=(o[e.type]||0)+1)})});const r=[...$.map(e=>e.src_IP?.degree_score),...$.map(e=>e.dst_IP?.degree_score)].filter(e=>"number"==typeof e),n=[...$.map(e=>e.src_IP?.con_score),...$.map(e=>e.dst_IP?.con_score)].filter(e=>"number"==typeof e);return{directCurrent:t,indirectCurrent:i,typeCountMap:o,degreeScoreAvg:r.length?(r.reduce((e,t)=>e+t,0)/r.length).toFixed(3):"-",degreeScoreMax:r.length?Math.max(...r).toFixed(3):"-",conScoreAvg:n.length?(n.reduce((e,t)=>e+t,0)/n.length).toFixed(3):"-",conScoreMax:n.length?Math.max(...n).toFixed(3):"-",uniqueTypes:u($).length}},[A,$]),J=g.useMemo(()=>[{category:"direct",current:G.directCurrent,total:G.directCurrent},{category:"indirect",current:G.indirectCurrent,total:G.indirectCurrent},...Object.entries(G.typeCountMap).map(([e,t])=>({category:e,current:t,total:t}))],[G]);f.useEffect(()=>{m?W(m):fetch("http://localhost:8000/neo4j/nodes?activeView=target").then(e=>e.json()).then(W).catch(()=>W([]))},[m]),f.useEffect(()=>{k($)},[D,$]);const K=g.useCallback((e,t)=>{R(e),k(t)},[]),Q=g.useCallback(e=>{V(e);const t={type:"node-click",message:`노드 클릭: ${e.label||e.id}`,connectedCount:e.connectedCount,connectedIps:e.connectedIps,dbInfo:e.dbInfo,timestamp:(new Date).toLocaleTimeString()};T([t]),o&&o(e)},[o]);return g.useCallback(()=>{N?z("/ActiveResponse/responseeffectvisualization",{state:{selectedNode:N}}):alert("먼저 노드를 선택해주세요.")},[z,N]),r.jsxs(n,{component:"main",role:"main","aria-label":"타겟 대시보드",sx:{width:"100%",height:"calc(100vh - 120px)",bgcolor:"background.paper",boxShadow:3,m:0},children:[r.jsxs(s,{sx:{p:1,height:"100%","&:last-child":{pb:1},display:"flex",flexDirection:{xs:"column",lg:"row"},gap:1,overflow:"hidden"},children:[r.jsxs(l,{component:"section","aria-label":"대시보드 메인 콘텐츠",sx:{flex:1,display:"flex",flexDirection:"column",gap:2,minWidth:0,overflow:"hidden"},children:[r.jsx(n,{component:"section","aria-label":"통계 및 트렌드 영역",sx:{bgcolor:"transparent",boxShadow:"none",flexShrink:0},children:r.jsx(s,{sx:{p:0,"&:last-child":{pb:0}},children:r.jsxs(l,{sx:{display:"flex",flexDirection:"row",gap:2,alignItems:"center",justifyContent:"space-between",flexWrap:"nowrap",height:"240px",width:"100%"},children:[r.jsx(l,{sx:{flex:"0 0 auto",width:"calc(50% - 8px)",minWidth:0,height:"100%",display:"flex",alignItems:"center",justifyContent:"flex-start"},children:r.jsxs(c,{container:!0,spacing:1,sx:{height:"100%",justifyContent:"flex-start"},children:[r.jsx(c,{item:!0,xs:12,sm:6,md:4,lg:2.4,sx:{height:"100%"},children:r.jsx(n,{sx:{bgcolor:"#f0edfd",boxShadow:"0 2px 8px rgba(57, 48, 107, 0.07)",borderRadius:"12px",height:"100%",maxWidth:"220px"},children:r.jsx(s,{sx:{p:2,"&:last-child":{pb:2},height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},children:r.jsxs(l,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[r.jsx(a,{variant:"h3",sx:{color:"#39306b",fontWeight:"bold",mb:1,fontSize:"2.5rem"},children:$.length}),r.jsx(a,{variant:"body2",sx:{fontSize:"0.9rem",fontWeight:600,textAlign:"center",mb:.5},children:"전체 노드 개수"}),r.jsx(a,{variant:"caption",sx:{fontSize:"0.8rem",color:"#767686",textAlign:"center"},children:"네트워크 내 모든 노드"})]})})})}),r.jsx(c,{item:!0,xs:12,sm:6,md:4,lg:2.4,sx:{height:"100%"},children:r.jsx(n,{sx:{bgcolor:"#f0edfd",boxShadow:"0 2px 8px rgba(57, 48, 107, 0.07)",borderRadius:"12px",height:"100%",maxWidth:"220px"},children:r.jsx(s,{sx:{p:2,"&:last-child":{pb:2},height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},children:r.jsxs(l,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[r.jsx(a,{variant:"h3",sx:{color:"#39306b",fontWeight:"bold",mb:1,fontSize:"2.5rem"},children:A.length}),r.jsx(a,{variant:"body2",sx:{fontSize:"0.9rem",fontWeight:600,textAlign:"center",mb:.5},children:"필터링된 노드"}),r.jsx(a,{variant:"caption",sx:{fontSize:"0.8rem",color:"#767686",textAlign:"center"},children:E.isActive?`(전체: ${$.length})`:"총 노드 수"})]})})})}),r.jsx(c,{item:!0,xs:12,sm:6,md:4,lg:2.4,sx:{height:"100%"},children:r.jsx(n,{sx:{bgcolor:"#f0edfd",boxShadow:"0 2px 8px rgba(57, 48, 107, 0.07)",borderRadius:"12px",height:"100%",maxWidth:"220px"},children:r.jsx(s,{sx:{p:2,"&:last-child":{pb:2},height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},children:r.jsxs(l,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[r.jsx(a,{variant:"h3",sx:{color:"#39306b",fontWeight:"bold",mb:1,fontSize:"2.5rem"},children:G.uniqueTypes}),r.jsx(a,{variant:"body2",sx:{fontSize:"0.9rem",fontWeight:600,textAlign:"center",mb:.5},children:"고유 타입 개수"}),r.jsx(a,{variant:"caption",sx:{fontSize:"0.8rem",color:"#767686",textAlign:"center"},children:"네트워크 내 타입"})]})})})}),r.jsx(c,{item:!0,xs:12,sm:6,md:4,lg:2.4,sx:{height:"100%"},children:r.jsx(n,{sx:{bgcolor:"#f0edfd",boxShadow:"0 2px 8px rgba(57, 48, 107, 0.07)",borderRadius:"12px",height:"100%",maxWidth:"220px"},children:r.jsx(s,{sx:{p:2,"&:last-child":{pb:2},height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},children:r.jsxs(l,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[r.jsxs(a,{variant:"h5",sx:{color:"#39306b",fontWeight:"bold",mb:1,fontSize:"1.4rem"},children:[G.degreeScoreAvg," / ",G.degreeScoreMax]}),r.jsx(a,{variant:"body2",sx:{fontSize:"0.9rem",fontWeight:600,textAlign:"center",mb:.5},children:"degree_score"}),r.jsx(a,{variant:"caption",sx:{fontSize:"0.8rem",color:"#767686",textAlign:"center"},children:"평균 / 최고값"})]})})})}),r.jsx(c,{item:!0,xs:12,sm:6,md:4,lg:2.4,sx:{height:"100%"},children:r.jsx(n,{sx:{bgcolor:"#f0edfd",boxShadow:"0 2px 8px rgba(57, 48, 107, 0.07)",borderRadius:"12px",height:"100%",maxWidth:"220px"},children:r.jsx(s,{sx:{p:2,"&:last-child":{pb:2},height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},children:r.jsxs(l,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[r.jsxs(a,{variant:"h5",sx:{color:"#39306b",fontWeight:"bold",mb:1,fontSize:"1.4rem"},children:[G.conScoreAvg," / ",G.conScoreMax]}),r.jsx(a,{variant:"body2",sx:{fontSize:"0.9rem",fontWeight:600,textAlign:"center",mb:.5},children:"con_score"}),r.jsx(a,{variant:"caption",sx:{fontSize:"0.8rem",color:"#767686",textAlign:"center"},children:"평균 / 최고값"})]})})})})]})}),r.jsx(l,{sx:{flex:"0 0 auto",width:"calc(50% - 8px)",minWidth:0,height:"100%",display:"flex",alignItems:"center",justifyContent:"flex-end"},children:r.jsx(n,{sx:{width:"100%",height:"100%",bgcolor:"#f0edfd",boxShadow:"0 2px 8px rgba(57, 48, 107, 0.07)",borderRadius:"16px"},children:r.jsx(s,{sx:{p:2,"&:last-child":{pb:2},height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx(l,{sx:{width:"100%",height:"100%"},children:r.jsx(g.Suspense,{fallback:r.jsx(C,{}),children:r.jsx(I,{data:B})})})})})})]})})}),r.jsxs(l,{sx:{flex:1,display:"flex",flexDirection:{xs:"column",lg:"row"},gap:2,minHeight:0,overflow:"hidden"},children:[r.jsx(n,{component:"section","aria-label":"필터 조건 영역",sx:{width:{xs:"100%",lg:300},flexShrink:0,bgcolor:"#f0edfd",overflow:"auto"},children:r.jsx(s,{children:r.jsx(g.Suspense,{fallback:r.jsx(C,{}),children:r.jsx(v,{onConditionChange:K,data:$})})})}),r.jsx(n,{component:"section","aria-label":"네트워크 그래프 영역",sx:{flex:1,bgcolor:"#f0edfd",overflow:"hidden",minWidth:0},children:r.jsx(s,{sx:{p:0,height:"100%","&:last-child":{pb:0}},children:r.jsx(g.Suspense,{fallback:r.jsx(C,{}),children:r.jsx(_,{dbNodes:A,onNodeClick:Q})})})}),r.jsx(n,{component:"section","aria-label":"데이터 테이블 영역",sx:{width:{xs:"100%",lg:300},flexShrink:0,bgcolor:"#f0edfd",overflow:"auto"},children:r.jsx(s,{children:r.jsx(g.Suspense,{fallback:r.jsx(C,{}),children:r.jsx(S,{dbData:J})})})})]})]}),r.jsx(l,{component:"aside","aria-label":"이벤트 로그 패널",sx:{width:{xs:"100%",lg:300},maxWidth:{xs:"100%",lg:320},display:"flex",flexDirection:"column",gap:2,flexShrink:0,overflow:"hidden"},children:r.jsx(n,{component:"section","aria-label":"이벤트 로그",sx:{flex:1,bgcolor:"#f0edfd",overflow:"auto",minHeight:0},children:r.jsx(s,{sx:{height:"100%",display:"flex",flexDirection:"column","&:last-child":{pb:2}},children:r.jsx(g.Suspense,{fallback:r.jsx(C,{}),children:r.jsx(w,{logs:M,activeView:P,selectedNode:N})})})})})]}),r.jsx(d,{size:"small","aria-label":"네트워크 구조 분석 및 표적 식별",title:"네트워크 구조 분석 및 표적 식별",onClick:()=>O("targetDetail"),sx:{position:"absolute",bottom:40,right:100,zIndex:1e3,bgcolor:"rgba(124,58,237,0.8)",color:"#fff",borderRadius:"50%",width:48,height:48,boxShadow:"0 4px 12px rgba(124,58,237,0.5)","&:hover":{bgcolor:"#9333ea",color:"#fff",transform:"scale(1.1)"},transition:"all 0.3s ease"},children:r.jsx(t,{style:{fontSize:24}})}),r.jsx(d,{size:"small","aria-label":"핵심 표적 점수 분석",title:"핵심 표적 점수 분석",onClick:()=>O("targetDetail"),sx:{position:"absolute",bottom:40,right:40,zIndex:1e3,bgcolor:"rgba(124,58,237,0.8)",color:"#fff",borderRadius:"50%",width:48,height:48,boxShadow:"0 4px 12px rgba(124,58,237,0.5)","&:hover":{bgcolor:"#9333ea",color:"#fff",transform:"scale(1.1)"},transition:"all 0.3s ease"},children:r.jsx(i,{style:{fontSize:24}})}),r.jsxs(x,{open:H,onClose:()=>F("targetIdentification"),maxWidth:"md",fullWidth:!0,PaperProps:{sx:{height:"70vh",maxHeight:"70vh",m:0,position:"relative",overflow:"hidden"}},children:[r.jsx(d,{onClick:()=>F("targetIdentification"),sx:{position:"absolute",right:23,top:8.5,color:"#000000ff",zIndex:1,bgcolor:"#cac7d4ff","&:hover":{bgcolor:"#39306b",color:"#ffffffff"}},children:"✕"}),r.jsx(h,{sx:{p:0,height:"100%",overflow:"hidden"},children:r.jsx(j,{open:H,isPopup:!0})})]}),r.jsxs(x,{open:q,onClose:()=>F("targetPriority"),maxWidth:"md",fullWidth:!0,PaperProps:{sx:{height:"70vh",maxHeight:"70vh",m:0,position:"relative",overflow:"hidden"}},children:[r.jsx(d,{onClick:()=>F("targetPriority"),sx:{position:"absolute",right:23,top:8.5,color:"#666",zIndex:1,bgcolor:"#cac7d4ff","&:hover":{bgcolor:"rgba(255,255,255,1)",color:"#000"}},children:"✕"}),r.jsx(h,{sx:{p:0,height:"100%",overflow:"hidden"},children:r.jsx(y,{open:q,isPopup:!0})})]})]})}},Symbol.toStringTag,{value:"Module"}));export{u as e,P as i,b as n};
