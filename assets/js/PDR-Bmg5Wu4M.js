import{j as e,o as t,B as i,a1 as n,aa as a,ab as o,T as r,ac as s,q as l,ad as d,ae as c,af as m}from"./mui-vendor-C1i-sMyb.js";import{a as h}from"./react-vendor-ClEFeRSO.js";import{c as x,D as u,H as p,j as y,k as f,L as g,a as b,l as w,C as v,V as j,m as _,n as L,f as C,o as I,S as D,d as z,b as O,R,I as T}from"./cesium-vendor-CfPU8cLI.js";const E=[{id:"site_punggye",name:"풍계리 핵실험장",geo_info:{lat:41.28,lng:129.085,addr:"함경북도 길주군 풍계리 만탑산"},detail:{"용도":"지하 핵실험 및 계측",type:"nuclear","건물수":5,"건물년수":"2006~현재"},buildings:[{id:"p_b1",name:"1번 갱도 (동쪽 - 1차실험/폐쇄됨)",lat:41.278056,lng:129.0875,structure_info:{"입구(폐쇄)":[{id:"E1-c",name:"진입로(붕괴됨)",type:"corridor",status:"critical",x:40,y:5,w:20,h:90},{id:"E1-1",name:"폐석 더미",type:"room",status:"critical",x:5,y:30,w:80,h:40}]}},{id:"p_b2",name:"2번 갱도 (북쪽 - 주실험장)",lat:41.2938,lng:129.0753,structure_info:{"심도 500m":[{id:"D-c",name:"중앙 갱도",type:"corridor",status:"normal",x:40,y:5,w:20,h:90},{id:"D-1",name:"기폭실",type:"room",status:"critical",x:5,y:20,w:30,h:50},{id:"D-2",name:"계측실",type:"room",status:"normal",x:65,y:20,w:30,h:50}]}},{id:"p_b3",name:"3번 갱도 (남쪽)",lat:41.2731,lng:129.0833,structure_info:{"굴착 구역":[{id:"S-c",name:"작업 통로",type:"corridor",status:"normal",x:40,y:5,w:20,h:90},{id:"S-1",name:"장비실",type:"room",status:"normal",x:5,y:10,w:30,h:40}]}},{id:"p_b4",name:"4번 갱도 (서쪽)",lat:41.2856,lng:129.0752,structure_info:{"준비 구역":[{id:"W-c",name:"통로",type:"corridor",status:"normal",x:40,y:5,w:20,h:90},{id:"W-1",name:"배수 펌프",type:"room",status:"critical",x:5,y:10,w:30,h:30}]}},{id:"p_b5",name:"지휘 통제소",lat:41.2755,lng:129.0915,structure_info:{"1F":[{id:"C-c",name:"복도",type:"corridor",status:"normal",x:40,y:5,w:20,h:90},{id:"C-1",name:"종합 통제실",type:"room",status:"normal",x:5,y:5,w:30,h:50},{id:"C-2",name:"통신실",type:"room",status:"critical",x:65,y:5,w:30,h:30}]}}]},{id:"site_sohae",name:"서해위성발사장",geo_info:{lat:39.66,lng:124.705,addr:"평안북도 철산군 동창리"},detail:{"용도":"ICBM 및 위성 발사",type:"rocket","건물수":5,"건물년수":"2012~현재"},buildings:[{id:"s_b1",name:"위성 발사대 (Gantry)",lat:39.660157,lng:124.705307,structure_info:{"Level 1":[{id:"L1-c",name:"정비 통로",type:"corridor",status:"normal",x:40,y:5,w:20,h:90},{id:"L1-1",name:"화염 유도로",type:"room",status:"critical",x:65,y:5,w:30,h:80}],"Level 2":[{id:"L2-c",name:"연결 브릿지",type:"corridor",status:"normal",x:40,y:5,w:20,h:90},{id:"L2-1",name:"연료 주입구",type:"room",status:"normal",x:5,y:20,w:30,h:30}],"Level 3":[{id:"L3-c",name:"상단 데크",type:"corridor",status:"normal",x:40,y:5,w:20,h:90},{id:"L3-1",name:"산화제 주입구",type:"room",status:"critical",x:65,y:20,w:30,h:30}],"Level 4":[{id:"L4-c",name:"최상단 데크",type:"corridor",status:"normal",x:40,y:5,w:20,h:90},{id:"L4-1",name:"페어링 작업대",type:"room",status:"normal",x:5,y:10,w:30,h:40},{id:"L4-2",name:"크레인 제어",type:"room",status:"normal",x:65,y:10,w:30,h:30}]}},{id:"s_b2",name:"수평 조립동",lat:39.658252,lng:124.70377,structure_info:{"1F":[{id:"A-c",name:"이송 레일",type:"corridor",status:"normal",x:40,y:5,w:20,h:90},{id:"A-1",name:"조립 구역",type:"room",status:"normal",x:5,y:5,w:30,h:80},{id:"A-2",name:"부품 창고",type:"room",status:"normal",x:65,y:5,w:30,h:40}]}},{id:"s_b3",name:"엔진 연소 시험장",lat:39.654637,lng:124.700599,structure_info:{"벙커":[{id:"E-c",name:"관측로",type:"corridor",status:"normal",x:40,y:5,w:20,h:90},{id:"E-1",name:"연료 탱크",type:"room",status:"normal",x:5,y:10,w:30,h:30},{id:"E-2",name:"계측실",type:"room",status:"critical",x:65,y:10,w:30,h:50}]}},{id:"s_b4",name:"발사 통제소 (LCC)",lat:39.651787,lng:124.7112,structure_info:{Main:[{id:"L-c",name:"복도",type:"corridor",status:"normal",x:40,y:5,w:20,h:90},{id:"L-1",name:"지휘소",type:"room",status:"normal",x:5,y:5,w:80,h:40},{id:"L-2",name:"서버실",type:"room",status:"critical",x:65,y:50,w:30,h:40}]}},{id:"s_b5",name:"VIP 관측소",lat:39.653457,lng:124.708573,structure_info:{"1F":[{id:"V-c",name:"복도",type:"corridor",status:"normal",x:40,y:5,w:20,h:90},{id:"V-1",name:"VIP 라운지",type:"room",status:"normal",x:5,y:5,w:80,h:40}]}}]},{id:"site_wpk",name:"조선노동당 본부",geo_info:{lat:39.017778,lng:125.744167,addr:"평양시 중구역 창광거리"},detail:{"용도":"당 중앙위 본부 및 집무실",type:"law_facility","건물수":4,"건물년수":"1970~현재"},buildings:[{id:"w_b1",name:"당 중앙위 본관 (1호 청사)",lat:39.017778,lng:125.744167,structure_info:{"B2 (벙커)":[{id:"B2-c",name:"지하 통로",type:"corridor",status:"normal",x:40,y:5,w:20,h:90},{id:"B2-1",name:"전시 지휘소",type:"room",status:"critical",x:5,y:10,w:30,h:50},{id:"B2-2",name:"물자실",type:"room",status:"normal",x:65,y:10,w:30,h:40}],"1F":[{id:"1F-c",name:"로비",type:"corridor",status:"normal",x:40,y:5,w:20,h:90},{id:"1F-1",name:"회견장",type:"room",status:"normal",x:5,y:10,w:30,h:40},{id:"1F-2",name:"연회장",type:"room",status:"normal",x:65,y:10,w:30,h:50}],"2F":[{id:"2F-c",name:"복도",type:"corridor",status:"normal",x:40,y:5,w:20,h:90},{id:"2F-1",name:"조직지도부",type:"room",status:"normal",x:5,y:10,w:30,h:30},{id:"2F-2",name:"선전선동부",type:"room",status:"normal",x:5,y:50,w:30,h:30},{id:"2F-3",name:"회의실",type:"room",status:"normal",x:65,y:20,w:30,h:50}],"3F (서기실)":[{id:"3F-c",name:"전용 복도",type:"corridor",status:"normal",x:40,y:5,w:20,h:90},{id:"3F-1",name:"위원장 집무실",type:"room",status:"normal",x:5,y:10,w:30,h:50},{id:"3F-2",name:"전략실",type:"room",status:"critical",x:65,y:10,w:30,h:30}]}},{id:"w_b2",name:"조직지도부 청사",lat:39.0165,lng:125.7438,structure_info:{"1F":[{id:"A-1",name:"행정 사무실",type:"room",status:"normal",x:5,y:5,w:30,h:80}]}},{id:"w_b3",name:"선전선동부 청사",lat:39.0182,lng:125.7455,structure_info:{"1F":[{id:"B-1",name:"자료실",type:"room",status:"normal",x:5,y:5,w:30,h:80}]}},{id:"w_b4",name:"청사 경비총국",lat:39.0158,lng:125.7425,structure_info:{"1F":[{id:"C-1",name:"보안실",type:"room",status:"critical",x:5,y:5,w:30,h:80}]}}]}];T.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIzODNiZmZiNC04YTUxLTQ1YzgtOWU1Mi1kNDUyY2I2ZDRkNTQiLCJpZCI6MzQyNDEzLCJpYXQiOjE3NTgxNzMyNDh9.zZRyMPovg5ALhNtG2_E-0ED0qHqd_uQQnAG84eQUyG4";const k={nuclear:x.RED,rocket:x.ORANGE,law_facility:x.PURPLE,default:x.GRAY},A=()=>{const T=h.useRef(null),A=h.useRef(null),[F,W]=h.useState(null),[M,N]=h.useState(null),[B,V]=h.useState(null),[H,S]=h.useState(!1);h.useEffect(()=>{if(T.current)return(async()=>{try{const t=new j(T.current,{animation:!1,baseLayerPicker:!1,fullscreenButton:!1,geocoder:!1,homeButton:!1,infoBox:!1,sceneModePicker:!1,selectionIndicator:!1,timeline:!1,navigationHelpButton:!1,navigationInstructionsInitiallyVisible:!1,requestRenderMode:!0,maximumRenderTimeChange:1/0,sceneMode:L.SCENE3D,skyAtmosphere:new _});A.current=t,t.cesiumWidget.creditContainer.style.display="none";const i={destination:b.fromDegrees(127.5,39.5,12e5),orientation:{heading:0,pitch:v.toRadians(-90),roll:0}};t.camera.setView(i);try{const e=await C();t.scene.terrainProvider=e;const i=await I();t.scene.primitives.add(i)}catch(e){}new D(t.scene.canvas).setInputAction(e=>{const i=t.scene.pick(e.position);if(z(i)&&i.id){const e=i.id,n=e.properties?.type?.getValue(),a=e.properties?.data?.getValue();"site"===n?P(a,t):"building"===n&&G(a,t)}},O.LEFT_CLICK),S(!0)}catch(t){}})(),()=>{A.current&&A.current.destroy()}},[]),h.useEffect(()=>{if(!A.current||!H)return;const e=A.current;e.entities.removeAll(),F?F.buildings.forEach(t=>{e.entities.add({position:b.fromDegrees(t.lng,t.lat),billboard:{image:'data:image/svg+xml;charset=utf-8,\n                      <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="%23fbc02d">\n                        <path d="M12 7V3H2v18h20V7H12zM6 19H4v-2h2v2zm0-4H4v-2h2v2zm0-4H4V9h2v2zm0-4H4V5h2v2zm4 12H8v-2h2v2zm0-4H8v-2h2v2zm0-4H8V9h2v2zm0-4H8V5h2v2zm10 12h-8v-2h2v-2h-2v-2h2v-2h-2V9h8v10zm-2-8h-2v2h2v-2zm0 4h-2v2h2v-2z"/>\n                      </svg>',verticalOrigin:f.BOTTOM,heightReference:p.CLAMP_TO_GROUND,width:40,height:40},label:{text:t.name,font:"14px sans-serif",style:g.FILL_AND_OUTLINE,fillColor:x.YELLOW,outlineColor:x.BLACK,outlineWidth:3,verticalOrigin:f.TOP,pixelOffset:new y(0,5),heightReference:p.CLAMP_TO_GROUND,distanceDisplayCondition:new u(0,5e4)},properties:{type:"building",data:t}})}):E.forEach(t=>{const i=k[t.detail.type]||k.default;e.entities.add({position:b.fromDegrees(t.geo_info.lng,t.geo_info.lat),point:{pixelSize:20,color:i,outlineColor:x.WHITE,outlineWidth:3,heightReference:p.CLAMP_TO_GROUND},label:{text:t.name,font:"16px sans-serif",style:g.FILL_AND_OUTLINE,fillColor:x.WHITE,outlineColor:x.BLACK,outlineWidth:4,verticalOrigin:f.BOTTOM,pixelOffset:new y(0,-25),heightReference:p.CLAMP_TO_GROUND,distanceDisplayCondition:new u(0,5e6)},properties:{type:"site",data:t}})})},[F,H]);const P=(e,t)=>{if(W(e),N(null),!e.buildings||0===e.buildings.length)return void t.flyTo(t.entities,{destination:b.fromDegrees(e.geo_info.lng,e.geo_info.lat,5e3),duration:1.5});const i=e.buildings.map(e=>e.lat),n=e.buildings.map(e=>e.lng),a=Math.min(...i),o=Math.max(...i),r=Math.min(...n),s=Math.max(...n);if(a===o&&r===s)return void t.camera.flyTo({destination:b.fromDegrees(r,a,1e3),duration:1.5});const l=.005;let d=.2*(o-a),c=.2*(s-r);d<l&&(d=l),c<l&&(c=l);const m=R.fromDegrees(r-c,a-d,s+c,o+d);t.camera.flyTo({destination:m,duration:1.5})},G=(e,t)=>{N(e);const i=e.structure_info?Object.keys(e.structure_info)[0]:null;V(i)},U=({rooms:t})=>t&&0!==t.length?e.jsxs(i,{sx:{position:"relative",width:"100%",height:"100%",bgcolor:"#eceff1",borderRadius:2,border:"1px solid #cfd8dc",overflow:"hidden"},children:[e.jsx(i,{sx:{position:"absolute",inset:0,opacity:.6,backgroundImage:"linear-gradient(#e0e0e0 1px, transparent 1px), linear-gradient(90deg, #e0e0e0 1px, transparent 1px)",backgroundSize:"20px 20px"}}),e.jsx("svg",{style:{position:"absolute",width:"100%",height:"100%"},viewBox:"0 0 100 100",preserveAspectRatio:"none",children:t.map(t=>{const i="critical"===t.status,n="corridor"===t.type;return e.jsxs("g",{children:[e.jsx("rect",{x:`${t.x}%`,y:`${t.y}%`,width:`${t.w}%`,height:`${t.h}%`,fill:n?"#fafafa":i?"#ffebee":"#e8f5e9",stroke:n?"#b0bec5":i?"#e57373":"#66bb6a",strokeWidth:"0.8",rx:"1",ry:"1"}),t.h>8&&t.w>10&&e.jsx("text",{x:`${t.x+t.w/2}%`,y:`${t.y+t.h/2}%`,dominantBaseline:"middle",textAnchor:"middle",fill:"#455a64",fontSize:"3.5",fontWeight:"bold",style:{pointerEvents:"none"},children:t.name.length>8?t.name.substring(0,7)+"..":t.name})]},t.id)})})]}):e.jsx(r,{variant:"caption",sx:{p:2},children:"데이터 없음"});return e.jsxs(t,{sx:{width:"100%",height:"calc(100vh - 100px)",display:"flex",bgcolor:"#f5f5f5",m:0,overflow:"hidden",position:"relative"},children:[e.jsxs(i,{sx:{flex:1,position:"relative",height:"100%"},children:[e.jsx("div",{ref:T,style:{width:"100%",height:"100%"}}),F&&e.jsx(n,{variant:"contained",startIcon:e.jsx(a,{}),onClick:()=>{W(null),N(null),A.current?.camera.flyTo({destination:b.fromDegrees(127.5,39.5,12e5),duration:1.5})},sx:{position:"absolute",top:20,left:20,zIndex:1e3,bgcolor:"rgba(255,255,255,0.9)",color:"#333","&:hover":{bgcolor:"white"}},children:"전체 지도 보기"}),F&&e.jsxs(o,{elevation:3,sx:{position:"absolute",top:20,right:20,zIndex:1e3,width:320,p:2,bgcolor:"rgba(255, 255, 255, 0.95)",borderRadius:2},children:[e.jsxs(r,{variant:"h6",sx:{fontWeight:"bold",color:"#1a237e",display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(s,{color:"error"})," ",F.name]}),e.jsx(l,{sx:{mb:1.5}}),e.jsxs(r,{variant:"body2",sx:{mb:.5},children:[e.jsx("strong",{children:"주소:"})," ",F.geo_info.addr]}),e.jsxs(r,{variant:"body2",sx:{mb:.5},children:[e.jsx("strong",{children:"용도:"})," ",F.detail.용도]}),e.jsxs(r,{variant:"body2",sx:{mb:.5},children:[e.jsx("strong",{children:"건물 수:"})," ",F.detail.건물수,"개동"]}),e.jsxs(r,{variant:"body2",children:[e.jsx("strong",{children:"건축:"})," ",F.detail.건물년수]})]})]}),e.jsxs(t,{sx:{width:420,height:"100%",display:"flex",flexDirection:"column",borderLeft:"1px solid #ddd",bgcolor:"#f8f9fa"},children:[e.jsx(i,{sx:{p:2,bgcolor:"#263238",color:"white"},children:e.jsxs(r,{variant:"subtitle1",sx:{fontWeight:"bold",display:"flex",alignItems:"center",gap:1},children:[e.jsx(d,{})," 시설 상세 모니터링"]})}),e.jsxs(i,{sx:{flex:1,overflowY:"auto",p:2,display:"flex",flexDirection:"column",gap:2},children:[!F&&e.jsxs(i,{sx:{textAlign:"center",color:"#90a4ae",mt:10},children:[e.jsx(c,{sx:{fontSize:60,mb:2,opacity:.5}}),e.jsx(r,{children:"지도에서 시설(마커)을 선택해주세요."})]}),F&&!M&&e.jsxs(e.Fragment,{children:[e.jsxs(r,{variant:"subtitle2",sx:{fontWeight:"bold",color:"#333"},children:["내부 건물 목록 (",F.buildings.length,")"]}),F.buildings.map(t=>e.jsx(n,{variant:"outlined",startIcon:e.jsx(m,{}),onClick:()=>{G(t,A.current),A.current.flyTo(A.current.entities.values.find(e=>e.properties?.data?.getValue()?.id===t.id),{duration:1,offset:new w(0,v.toRadians(-45),1e3)})},sx:{justifyContent:"flex-start",bgcolor:"white",py:1.5,borderColor:"#cfd8dc",color:"#455a64"},children:t.name},t.id))]}),M&&e.jsxs(i,{sx:{display:"flex",flexDirection:"column",height:"100%"},children:[e.jsxs(i,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsx(r,{variant:"h6",sx:{fontWeight:"bold",color:"#1a237e",fontSize:"1.1rem"},children:M.name}),e.jsx(n,{size:"small",onClick:()=>N(null),variant:"outlined",children:"목록"})]}),e.jsxs(i,{sx:{mb:2},children:[e.jsx(r,{variant:"caption",sx:{display:"block",mb:1,color:"#666",fontWeight:"bold"},children:"층/구역 (Zone)"}),e.jsx(i,{sx:{display:"flex",gap:.5,flexWrap:"wrap"},children:M.structure_info&&Object.keys(M.structure_info).map(t=>e.jsx(n,{variant:B===t?"contained":"outlined",size:"small",onClick:()=>V(t),sx:{fontSize:"11px",px:1,minWidth:"auto",bgcolor:B===t?"#1a237e":"white",color:B===t?"white":"#546e7a"},children:t},t))})]}),e.jsx(i,{sx:{flex:1,minHeight:300},children:M.structure_info?e.jsx(U,{rooms:M.structure_info[B]}):e.jsx(r,{variant:"caption",children:"정보 없음"})}),e.jsxs(i,{sx:{mt:"auto",p:2,bgcolor:"white",borderTop:"1px solid #eee"},children:[e.jsx(r,{variant:"subtitle2",sx:{mb:1,fontWeight:"bold",color:"#455a64"},children:"시설 상태 범례"}),e.jsxs(i,{sx:{display:"flex",gap:3},children:[e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(i,{sx:{width:14,height:14,borderRadius:"50%",bgcolor:"#e8f5e9",border:"2px solid #66bb6a"}}),e.jsx(r,{variant:"body2",sx:{color:"#2e7d32",fontWeight:"bold"},children:"정상 시설"})]}),e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(i,{sx:{width:14,height:14,borderRadius:"50%",bgcolor:"#ffebee",border:"2px solid #e57373"}}),e.jsx(r,{variant:"body2",sx:{color:"#c62828",fontWeight:"bold"},children:"이상 시설"})]})]})]})]})]})]})]})};export{A as default};
