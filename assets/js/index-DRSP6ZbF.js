const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/TrendChart-BIFMg5Uo.js","assets/js/mui-vendor-BDHQmYi7.js","assets/js/react-vendor-ClEFeRSO.js","assets/js/chart-vendor-CeJ1_NXY.js"])))=>i.map(i=>d[i]);
import{_ as e}from"./index-Dcbz18a6.js";import{j as n}from"./mui-vendor-BDHQmYi7.js";import{c as s,a as t}from"./react-vendor-ClEFeRSO.js";import{e as c,n as i}from"./index-BlGvMMea.js";import"./chart-vendor-CeJ1_NXY.js";import"./three-vendor-CtB2SH65.js";import"./ConsoleView-aonTYntr.js";const a=({value:e,onChange:s})=>n.jsxs("div",{className:"condition-group",children:[n.jsx("label",{children:"연결 유형"}),n.jsxs("div",{className:"connection-type-buttons",children:[n.jsx("button",{type:"button",className:""===e?"apply-btn active":"apply-btn",onClick:()=>s(""),children:"전체"}),n.jsx("button",{type:"button",className:"direct"===e?"apply-btn active":"apply-btn",onClick:()=>s("direct"),children:"직접 연결"}),n.jsx("button",{type:"button",className:"indirect"===e?"apply-btn active":"apply-btn",onClick:()=>s("indirect"),children:"간접 연결"})]})]}),r=({filters:e,onInputChange:s})=>n.jsxs("div",{className:"basic-conditions",children:[n.jsxs("div",{className:"condition-group",children:[n.jsx("label",{children:"연결된 노드 수"}),n.jsxs("div",{className:"range-inputs",children:[n.jsx("input",{type:"number",placeholder:"최소값",value:e.minConnections,onChange:e=>s("minConnections",e.target.value),min:"0"}),n.jsx("span",{children:"~"}),n.jsx("input",{type:"number",placeholder:"최대값",value:e.maxConnections,onChange:e=>s("maxConnections",e.target.value),min:"0"})]})]}),n.jsxs("div",{className:"condition-group",children:[n.jsx("label",{children:"표적 점수 (1~100)"}),n.jsxs("div",{className:"range-inputs",children:[n.jsx("input",{type:"number",placeholder:"최소점수",value:e.minTargetScore,onChange:e=>s("minTargetScore",e.target.value),min:"0",step:"0.1"}),n.jsx("span",{children:"~"}),n.jsx("input",{type:"number",placeholder:"최대점수",value:e.maxTargetScore,onChange:e=>s("maxTargetScore",e.target.value),min:"0",step:"0.1"})]})]})]}),o=({showAdvanced:e,availableTypes:t,filters:c,onTypeToggle:i})=>e&&n.jsxs("div",{className:"label-checkboxes",children:[n.jsxs(s.Fragment,{children:[n.jsx("div",{className:"layer-title layer2",children:"2계층"}),n.jsx("div",{className:"layer-checkboxes",children:["switch","router"].filter(e=>t.includes(e)).map(e=>n.jsxs("label",{className:"checkbox-label",children:[n.jsx("input",{type:"checkbox",checked:c.nodeTypes&&c.nodeTypes.includes(e),onChange:()=>i(e)}),n.jsx("span",{children:e})]},e))})]}),n.jsxs(s.Fragment,{children:[n.jsx("div",{className:"layer-title layer3",children:"3계층"}),n.jsx("div",{className:"layer-checkboxes",children:["firewall","router","server","workstation","printer","laptop"].filter(e=>t.includes(e)).map(e=>n.jsxs("label",{className:"checkbox-label",children:[n.jsx("input",{type:"checkbox",checked:c.nodeTypes&&c.nodeTypes.includes(e),onChange:()=>i(e)}),n.jsx("span",{children:e})]},e))})]}),n.jsxs(s.Fragment,{children:[n.jsx("div",{className:"layer-title layer4",children:"4계층"}),n.jsx("div",{className:"layer-checkboxes",children:["plc","sensor"].filter(e=>t.includes(e)).map(e=>n.jsxs("label",{className:"checkbox-label",children:[n.jsx("input",{type:"checkbox",checked:c.nodeTypes&&c.nodeTypes.includes(e),onChange:()=>i(e)}),n.jsx("span",{children:e})]},e))})]})]}),l=t.lazy(()=>e(()=>import("./TrendChart-BIFMg5Uo.js"),__vite__mapDeps([0,1,2,3]))),d=()=>n.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",color:"#666",fontSize:"0.75rem"},children:"Loading..."}),p=({onConditionChange:e,data:p,trendData:m})=>{s.useEffect(()=>{e&&e(h,g(p,h))},[]);const[h,x]=t.useState({minConnections:"",minTargetScore:"",maxConnections:"",maxTargetScore:"",nodeTypes:[],connectionType:"",isActive:!1}),[u,y]=t.useState(!0),j=s.useMemo(()=>p?c(p):["Internal","External","Server","Client","Router","Switch"],[p]),g=(e,n)=>{let s=e;if("direct"===n.connectionType?s=s.filter(e=>{const n=e.src_IP?.degree_score;return"number"==typeof n&&n>.5}):"indirect"===n.connectionType&&(s=s.filter(e=>{const n=e.src_IP?.degree_score;return"number"==typeof n&&n>0&&n<=.5})),n.minConnections||n.maxConnections){const t=n.minConnections?Number(n.minConnections):-1/0,c=n.maxConnections?Number(n.maxConnections):1/0;s=s.filter(n=>{let s=0;const i=n.src_IP?.ip;return!!i&&(e.forEach(e=>{e.src_IP?.ip!==i&&e.dst_IP?.ip!==i||s++}),s>=t&&s<=c)})}n.nodeTypes&&n.nodeTypes.length>0&&(s=s.filter(e=>{const s=e.src_IP?.type,t=e.dst_IP?.type;return s&&n.nodeTypes.includes(s)||t&&n.nodeTypes.includes(t)}));const t=e.map(e=>e.src_IP?.ad_score).filter(e=>"number"==typeof e),c=Math.min(...t),a=Math.max(...t);if(n.minTargetScore||n.maxTargetScore){const e=n.minTargetScore?Number(n.minTargetScore):-1/0,t=n.maxTargetScore?Number(n.maxTargetScore):1/0;s=s.filter(n=>{const s=i(n.src_IP?.ad_score,c,a);return s>=e&&s<=t})}return s},b=(n,s)=>{const t={...h,[n]:s};if(x(t),"connectionType"===n){const n={...t,isActive:!0};x(n),e&&e(n,g(p,n))}else e&&e(t,g(p,t))};return n.jsxs("div",{className:"target-condition",children:[n.jsxs("div",{className:"condition-header",children:[n.jsx("h3",{children:"노드 필터링 조건"}),n.jsx("button",{className:"toggle-advanced-btn",onClick:()=>y(!u),children:u?"간단히 보기":"고급 옵션"})]}),n.jsxs("div",{className:"condition-content",children:[n.jsx(a,{value:h.connectionType,onChange:e=>b("connectionType",e)}),n.jsx(r,{filters:h,onInputChange:b}),m&&m.length>0&&n.jsx("div",{className:"trend-charts-container",style:{display:"flex",flexDirection:"column",gap:"8px",marginBottom:"12px"},children:n.jsxs(t.Suspense,{fallback:n.jsx(d,{}),children:[n.jsx("div",{style:{height:"110px",width:"100%",backgroundColor:"transparent",borderRadius:"8px",padding:"4px"},children:n.jsx(l,{data:m,chartType:"degree",compact:!0})}),n.jsx("div",{style:{height:"110px",width:"100%",backgroundColor:"transparent",borderRadius:"8px",padding:"4px"},children:n.jsx(l,{data:m,chartType:"con",compact:!0})})]})}),n.jsx(o,{showAdvanced:u,availableTypes:j,filters:h,onTypeToggle:e=>{const n=h.nodeTypes.includes(e)?h.nodeTypes.filter(n=>n!==e):[...h.nodeTypes,e];b("nodeTypes",n)}}),n.jsxs("div",{className:"condition-actions",children:[n.jsx("button",{className:"apply-btn",onClick:()=>{const n={...h,isActive:!0};x(n),e&&e(n,g(p,n))},disabled:!(h.minConnections||h.minTargetScore||h.maxConnections||h.maxTargetScore||0!==h.nodeTypes.length),children:"필터 적용"}),n.jsx("button",{className:"clear-btn",onClick:()=>{const n={minConnections:"",minTargetScore:"",maxConnections:"",maxTargetScore:"",nodeTypes:[],isActive:!1};x(n),e&&e(n,g(p,n))},children:"초기화"})]})]})]})};export{p as default};
