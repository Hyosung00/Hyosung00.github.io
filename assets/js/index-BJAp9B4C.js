const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/index-BjCogeLv.js","assets/js/mui-vendor-BCY2i4tN.js","assets/js/react-vendor-D7TXN3SA.js","assets/js/vis-network-CqERLR1V.js","assets/js/index-Cb1Si9ar.js","assets/js/chart-vendor-_i8yG59r.js","assets/js/three-vendor-C-R8GBcK.js","assets/css/index-cPnunmKr.css","assets/js/TargetIdentification-pXmNPrmk.js","assets/js/TargetPriority-DSvGMLHR.js","assets/js/index-CVUCcpW_.js","assets/js/DataTable-T-7zMN1W.js","assets/js/TrendChart-CpC5potg.js","assets/js/EventLog-B_mu-Emi.js","assets/js/ClusterOutlined-Cs2fK4P3.js"])))=>i.map(i=>d[i]);
import{e,f as t,_ as i}from"./index-Cb1Si9ar.js";import{j as s,o,t as n,B as r,a3 as l,T as c,I as a,a5 as d,a7 as x}from"./mui-vendor-BCY2i4tN.js";import{c as h,j as f,a as p}from"./react-vendor-D7TXN3SA.js";import{F as g}from"./TargetIdentification-pXmNPrmk.js";import{F as m}from"./TargetPriority-DSvGMLHR.js";function b(e,t,i){return"number"!=typeof e||isNaN(e)||t===i?1:Math.round(1+99*(e-t)/(i-t))}h.memo(({dbTitle:e,dbValue:t,dbSubtext:i,className:o})=>{const n=e||"Default Title",r=t||"Default Value",l=i||"Default Subtext";return s.jsxs("div",{className:o,children:[s.jsx("div",{className:"statistics-card-value",children:r}),s.jsx("div",{className:"statistics-card-title",children:n}),s.jsx("div",{className:"statistics-card-subtext",children:l})]})}).displayName="StatisticsCard";const j=e=>{if(!e)return[];const t=new Set;return e.forEach(e=>{[e.src_IP,e.dst_IP].forEach(e=>{e&&e.type&&t.add(e.type)})}),Array.from(t).sort()},u=p.lazy(()=>i(()=>import("./index-BjCogeLv.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]))),y=p.lazy(()=>i(()=>import("./index-CVUCcpW_.js"),__vite__mapDeps([10,1,2,4,5,6,7,8,9]))),_=p.lazy(()=>i(()=>import("./DataTable-T-7zMN1W.js"),__vite__mapDeps([11,1,2,4,5,6,7,8,9]))),S=p.lazy(()=>i(()=>import("./TrendChart-CpC5potg.js"),__vite__mapDeps([12,1,2,5]))),v=p.lazy(()=>i(()=>import("./EventLog-B_mu-Emi.js"),__vite__mapDeps([13,1,2,14,4,5,6,7]))),w=()=>s.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",color:"#666"},children:"Loading..."}),I=Object.freeze(Object.defineProperty({__proto__:null,default:function({onNodeClick:i,data:b,logs:I=[],activeView:C="target"}){const P=f(),[z,D]=p.useState(b||[]),[W,A]=p.useState([]),[k,E]=p.useState({}),[T,M]=p.useState(I),[R,N]=p.useState(null),[V,L]=p.useState(!1),[O,F]=p.useState(!1),H=p.useMemo(()=>Array.isArray(z)?z:z?.nodes||z?.network||[],[z]),q=p.useMemo(()=>H.map(e=>({degree_score:e.src_IP?.degree_score||e.dst_IP?.degree_score||0,con_score:e.src_IP?.con_score||e.dst_IP?.con_score||0})),[H]),$=p.useMemo(()=>{const e=new Set;W.forEach(t=>{t.src_IP&&t.src_IP.ip&&e.add(t.src_IP.ip)});let t=0,i=0;e.forEach(e=>{const s=W.find(t=>t.src_IP&&t.src_IP.ip===e)?.src_IP;s&&"number"==typeof s.degree_score&&(s.degree_score>.5?t+=1:s.degree_score>0&&s.degree_score<=.5&&(i+=1))});const s={};W.forEach(e=>{[e.src_IP,e.dst_IP].forEach(e=>{e&&e.type&&(s[e.type]=(s[e.type]||0)+1)})});const o=[...H.map(e=>e.src_IP?.degree_score),...H.map(e=>e.dst_IP?.degree_score)].filter(e=>"number"==typeof e),n=[...H.map(e=>e.src_IP?.con_score),...H.map(e=>e.dst_IP?.con_score)].filter(e=>"number"==typeof e);return{directCurrent:t,indirectCurrent:i,typeCountMap:s,degreeScoreAvg:o.length?(o.reduce((e,t)=>e+t,0)/o.length).toFixed(3):"-",degreeScoreMax:o.length?Math.max(...o).toFixed(3):"-",conScoreAvg:n.length?(n.reduce((e,t)=>e+t,0)/n.length).toFixed(3):"-",conScoreMax:n.length?Math.max(...n).toFixed(3):"-",uniqueTypes:j(H).length}},[W,H]),B=p.useMemo(()=>[{category:"direct",current:$.directCurrent,total:$.directCurrent},{category:"indirect",current:$.indirectCurrent,total:$.indirectCurrent},...Object.entries($.typeCountMap).map(([e,t])=>({category:e,current:t,total:t}))],[$]);h.useEffect(()=>{b?D(b):fetch("http://localhost:8000/neo4j/nodes?activeView=target").then(e=>e.json()).then(D).catch(()=>D([]))},[b]),h.useEffect(()=>{A(H)},[z,H]);const G=p.useCallback((e,t)=>{E(e),A(t)},[]),J=p.useCallback(e=>{N(e);const t={type:"node-click",message:`노드 클릭: ${e.label||e.id}`,connectedCount:e.connectedCount,connectedIps:e.connectedIps,dbInfo:e.dbInfo,timestamp:(new Date).toLocaleTimeString()};M([t]),i&&i(e)},[i]);return p.useCallback(()=>{R?P("/ActiveResponse/responseeffectvisualization",{state:{selectedNode:R}}):alert("먼저 노드를 선택해주세요.")},[P,R]),s.jsxs(o,{component:"main",role:"main","aria-label":"타겟 대시보드",sx:{width:"100%",height:"calc(100vh - 120px)",bgcolor:"background.paper",boxShadow:3,m:0},children:[s.jsxs(n,{sx:{p:1,height:"100%","&:last-child":{pb:1},display:"flex",flexDirection:{xs:"column",lg:"row"},gap:1,overflow:"hidden"},children:[s.jsxs(r,{component:"section","aria-label":"대시보드 메인 콘텐츠",sx:{flex:1,display:"flex",flexDirection:"column",gap:2,minWidth:0,overflow:"hidden"},children:[s.jsx(o,{component:"section","aria-label":"통계 및 트렌드 영역",sx:{bgcolor:"transparent",boxShadow:"none",flexShrink:0},children:s.jsx(n,{sx:{p:0,"&:last-child":{pb:0}},children:s.jsxs(r,{sx:{display:"flex",flexDirection:"row",gap:2,alignItems:"center",justifyContent:"space-between",flexWrap:"nowrap",height:"240px",width:"100%"},children:[s.jsx(r,{sx:{flex:"0 0 auto",width:"calc(50% - 8px)",minWidth:0,height:"100%",display:"flex",alignItems:"center",justifyContent:"flex-start"},children:s.jsxs(l,{container:!0,spacing:1,sx:{height:"100%",justifyContent:"flex-start"},children:[s.jsx(l,{item:!0,xs:12,sm:6,md:4,lg:2.4,sx:{height:"100%"},children:s.jsx(o,{sx:{bgcolor:"#f0edfd",boxShadow:"0 2px 8px rgba(57, 48, 107, 0.07)",borderRadius:"12px",height:"100%",maxWidth:"220px"},children:s.jsx(n,{sx:{p:2,"&:last-child":{pb:2},height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},children:s.jsxs(r,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[s.jsx(c,{variant:"h3",sx:{color:"#39306b",fontWeight:"bold",mb:1,fontSize:"2.5rem"},children:H.length}),s.jsx(c,{variant:"body2",sx:{fontSize:"0.9rem",fontWeight:600,textAlign:"center",mb:.5},children:"전체 노드 개수"}),s.jsx(c,{variant:"caption",sx:{fontSize:"0.8rem",color:"#767686",textAlign:"center"},children:"네트워크 내 모든 노드"})]})})})}),s.jsx(l,{item:!0,xs:12,sm:6,md:4,lg:2.4,sx:{height:"100%"},children:s.jsx(o,{sx:{bgcolor:"#f0edfd",boxShadow:"0 2px 8px rgba(57, 48, 107, 0.07)",borderRadius:"12px",height:"100%",maxWidth:"220px"},children:s.jsx(n,{sx:{p:2,"&:last-child":{pb:2},height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},children:s.jsxs(r,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[s.jsx(c,{variant:"h3",sx:{color:"#39306b",fontWeight:"bold",mb:1,fontSize:"2.5rem"},children:W.length}),s.jsx(c,{variant:"body2",sx:{fontSize:"0.9rem",fontWeight:600,textAlign:"center",mb:.5},children:"필터링된 노드"}),s.jsx(c,{variant:"caption",sx:{fontSize:"0.8rem",color:"#767686",textAlign:"center"},children:k.isActive?`(전체: ${H.length})`:"총 노드 수"})]})})})}),s.jsx(l,{item:!0,xs:12,sm:6,md:4,lg:2.4,sx:{height:"100%"},children:s.jsx(o,{sx:{bgcolor:"#f0edfd",boxShadow:"0 2px 8px rgba(57, 48, 107, 0.07)",borderRadius:"12px",height:"100%",maxWidth:"220px"},children:s.jsx(n,{sx:{p:2,"&:last-child":{pb:2},height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},children:s.jsxs(r,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[s.jsx(c,{variant:"h3",sx:{color:"#39306b",fontWeight:"bold",mb:1,fontSize:"2.5rem"},children:$.uniqueTypes}),s.jsx(c,{variant:"body2",sx:{fontSize:"0.9rem",fontWeight:600,textAlign:"center",mb:.5},children:"고유 타입 개수"}),s.jsx(c,{variant:"caption",sx:{fontSize:"0.8rem",color:"#767686",textAlign:"center"},children:"네트워크 내 타입"})]})})})}),s.jsx(l,{item:!0,xs:12,sm:6,md:4,lg:2.4,sx:{height:"100%"},children:s.jsx(o,{sx:{bgcolor:"#f0edfd",boxShadow:"0 2px 8px rgba(57, 48, 107, 0.07)",borderRadius:"12px",height:"100%",maxWidth:"220px"},children:s.jsx(n,{sx:{p:2,"&:last-child":{pb:2},height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},children:s.jsxs(r,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[s.jsxs(c,{variant:"h5",sx:{color:"#39306b",fontWeight:"bold",mb:1,fontSize:"1.4rem"},children:[$.degreeScoreAvg," / ",$.degreeScoreMax]}),s.jsx(c,{variant:"body2",sx:{fontSize:"0.9rem",fontWeight:600,textAlign:"center",mb:.5},children:"degree_score"}),s.jsx(c,{variant:"caption",sx:{fontSize:"0.8rem",color:"#767686",textAlign:"center"},children:"평균 / 최고값"})]})})})}),s.jsx(l,{item:!0,xs:12,sm:6,md:4,lg:2.4,sx:{height:"100%"},children:s.jsx(o,{sx:{bgcolor:"#f0edfd",boxShadow:"0 2px 8px rgba(57, 48, 107, 0.07)",borderRadius:"12px",height:"100%",maxWidth:"220px"},children:s.jsx(n,{sx:{p:2,"&:last-child":{pb:2},height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},children:s.jsxs(r,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[s.jsxs(c,{variant:"h5",sx:{color:"#39306b",fontWeight:"bold",mb:1,fontSize:"1.4rem"},children:[$.conScoreAvg," / ",$.conScoreMax]}),s.jsx(c,{variant:"body2",sx:{fontSize:"0.9rem",fontWeight:600,textAlign:"center",mb:.5},children:"con_score"}),s.jsx(c,{variant:"caption",sx:{fontSize:"0.8rem",color:"#767686",textAlign:"center"},children:"평균 / 최고값"})]})})})})]})}),s.jsx(r,{sx:{flex:"0 0 auto",width:"calc(50% - 8px)",minWidth:0,height:"100%",display:"flex",alignItems:"center",justifyContent:"flex-end"},children:s.jsx(o,{sx:{width:"100%",height:"100%",bgcolor:"#f0edfd",boxShadow:"0 2px 8px rgba(57, 48, 107, 0.07)",borderRadius:"16px"},children:s.jsx(n,{sx:{p:2,"&:last-child":{pb:2},height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsx(r,{sx:{width:"100%",height:"100%"},children:s.jsx(p.Suspense,{fallback:s.jsx(w,{}),children:s.jsx(S,{data:q})})})})})})]})})}),s.jsxs(r,{sx:{flex:1,display:"flex",flexDirection:{xs:"column",lg:"row"},gap:2,minHeight:0,overflow:"hidden"},children:[s.jsx(o,{component:"section","aria-label":"필터 조건 영역",sx:{width:{xs:"100%",lg:300},flexShrink:0,bgcolor:"#f0edfd",overflow:"auto"},children:s.jsx(n,{children:s.jsx(p.Suspense,{fallback:s.jsx(w,{}),children:s.jsx(y,{onConditionChange:G,data:H})})})}),s.jsx(o,{component:"section","aria-label":"네트워크 그래프 영역",sx:{flex:1,bgcolor:"#f0edfd",overflow:"hidden",minWidth:0},children:s.jsx(n,{sx:{p:0,height:"100%","&:last-child":{pb:0}},children:s.jsx(p.Suspense,{fallback:s.jsx(w,{}),children:s.jsx(u,{dbNodes:W,onNodeClick:J})})})}),s.jsx(o,{component:"section","aria-label":"데이터 테이블 영역",sx:{width:{xs:"100%",lg:300},flexShrink:0,bgcolor:"#f0edfd",overflow:"auto"},children:s.jsx(n,{children:s.jsx(p.Suspense,{fallback:s.jsx(w,{}),children:s.jsx(_,{dbData:B})})})})]})]}),s.jsx(r,{component:"aside","aria-label":"이벤트 로그 패널",sx:{width:{xs:"100%",lg:300},maxWidth:{xs:"100%",lg:320},display:"flex",flexDirection:"column",gap:2,flexShrink:0,overflow:"hidden"},children:s.jsx(o,{component:"section","aria-label":"이벤트 로그",sx:{flex:1,bgcolor:"#f0edfd",overflow:"auto",minHeight:0},children:s.jsx(n,{sx:{height:"100%",display:"flex",flexDirection:"column","&:last-child":{pb:2}},children:s.jsx(p.Suspense,{fallback:s.jsx(w,{}),children:s.jsx(v,{logs:T,activeView:C,selectedNode:R})})})})})]}),s.jsx(a,{size:"small","aria-label":"네트워크 구조 분석 및 표적 식별",title:"네트워크 구조 분석 및 표적 식별",onClick:()=>L(!0),sx:{position:"absolute",bottom:40,right:100,zIndex:1e3,bgcolor:"rgba(124,58,237,0.8)",color:"#fff",borderRadius:"50%",width:48,height:48,boxShadow:"0 4px 12px rgba(124,58,237,0.5)","&:hover":{bgcolor:"#9333ea",color:"#fff",transform:"scale(1.1)"},transition:"all 0.3s ease"},children:s.jsx(e,{style:{fontSize:24}})}),s.jsx(a,{size:"small","aria-label":"핵심 표적 점수 분석",title:"핵심 표적 점수 분석",onClick:()=>F(!0),sx:{position:"absolute",bottom:40,right:40,zIndex:1e3,bgcolor:"rgba(124,58,237,0.8)",color:"#fff",borderRadius:"50%",width:48,height:48,boxShadow:"0 4px 12px rgba(124,58,237,0.5)","&:hover":{bgcolor:"#9333ea",color:"#fff",transform:"scale(1.1)"},transition:"all 0.3s ease"},children:s.jsx(t,{style:{fontSize:24}})}),s.jsxs(d,{open:V,onClose:()=>L(!1),maxWidth:"md",fullWidth:!0,PaperProps:{sx:{height:"70vh",maxHeight:"70vh",m:0,position:"relative",overflow:"hidden"}},children:[s.jsx(a,{onClick:()=>L(!1),sx:{position:"absolute",right:23,top:8.5,color:"#000000ff",zIndex:1,bgcolor:"#cac7d4ff","&:hover":{bgcolor:"#39306b",color:"#ffffffff"}},children:"✕"}),s.jsx(x,{sx:{p:0,height:"100%",overflow:"hidden"},children:s.jsx(g,{open:V,isPopup:!0})})]}),s.jsxs(d,{open:O,onClose:()=>F(!1),maxWidth:"md",fullWidth:!0,PaperProps:{sx:{height:"70vh",maxHeight:"70vh",m:0,position:"relative",overflow:"hidden"}},children:[s.jsx(a,{onClick:()=>F(!1),sx:{position:"absolute",right:23,top:8.5,color:"#666",zIndex:1,bgcolor:"#cac7d4ff","&:hover":{bgcolor:"rgba(255,255,255,1)",color:"#000"}},children:"✕"}),s.jsx(x,{sx:{p:0,height:"100%",overflow:"hidden"},children:s.jsx(m,{open:O,isPopup:!0})})]})]})}},Symbol.toStringTag,{value:"Module"}));export{j as e,I as i,b as n};
