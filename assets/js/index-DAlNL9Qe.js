import{d as e,j as t,B as r,T as a,o as n,t as o,I as i,a3 as s,a4 as l,a5 as c,a6 as d,a7 as u}from"./mui-vendor-BCY2i4tN.js";import{a as p,j as h}from"./react-vendor-D7TXN3SA.js";import{F as g}from"./FusionDB-zGHQUZvg.js";import{S as m,C as x,a as b,b as S,I as f,V as A,c as I,d as C,e as E,f as y,F as T,J as v,g as D,H as N,P as j,h as L}from"./cesium-vendor-Batq17f4.js";import{I as w,R,d as O}from"./index-Cb1Si9ar.js";import"./chart-vendor-_i8yG59r.js";import"./three-vendor-C-R8GBcK.js";var k={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M799.86 166.31c.02 0 .04.02.08.06l57.69 57.7c.04.03.05.05.06.08a.12.12 0 010 .06c0 .03-.02.05-.06.09L569.93 512l287.7 287.7c.04.04.05.06.06.09a.12.12 0 010 .07c0 .02-.02.04-.06.08l-57.7 57.69c-.03.04-.05.05-.07.06a.12.12 0 01-.07 0c-.03 0-.05-.02-.09-.06L512 569.93l-287.7 287.7c-.04.04-.06.05-.09.06a.12.12 0 01-.07 0c-.02 0-.04-.02-.08-.06l-57.69-57.7c-.04-.03-.05-.05-.06-.07a.12.12 0 010-.07c0-.03.02-.05.06-.09L454.07 512l-287.7-287.7c-.04-.04-.05-.06-.06-.09a.12.12 0 010-.07c0-.02.02-.04.06-.08l57.7-57.69c.03-.04.05-.05.07-.06a.12.12 0 01.07 0c.03 0 .05.02.09.06L512 454.07l287.7-287.7c.04-.04.06-.05.09-.06a.12.12 0 01.07 0z"}}]},name:"close",theme:"outlined"},M=function(t,r){return p.createElement(w,e({},t,{ref:r,icon:k}))},F=p.forwardRef(M);const H="/api/north-korea-attacks",G={SOURCE:{NORMAL:D.YELLOW,OUTLINE:D.RED,HIGHLIGHT:D.ORANGE},TARGET:{NORMAL:D.CYAN,OUTLINE:D.BLUE,HIGHLIGHT:D.LIME},HIGHLIGHT_OUTLINE:D.WHITE},B=document.createElement("style");B.textContent="\n  @keyframes pulse {\n    0% { box-shadow: 0 0 10px rgba(124,58,237,0.4); }\n    50% { box-shadow: 0 0 20px rgba(124,58,237,0.6); }\n    100% { box-shadow: 0 0 10px rgba(124,58,237,0.4); }\n  }\n",document.head.appendChild(B),f.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIzODNiZmZiNC04YTUxLTQ1YzgtOWU1Mi1kNDUyY2I2ZDRkNTQiLCJpZCI6MzQyNDEzLCJpYXQiOjE3NTgxNzMyNDh9.zZRyMPovg5ALhNtG2_E-0ED0qHqd_uQQnAG84eQUyG4";const _=e=>{const t={"중국":["AS4134 CHINANET","AS4837 CHINA169","AS9808 CMNET","AS24400 ALIBABA"],China:["AS4134 CHINANET","AS4837 CHINA169","AS9808 CMNET","AS24400 ALIBABA"],"러시아":["AS8359 MTS","AS12389 ROSTELECOM","AS31133 MF-MGSM","AS42610 NCNET"],Russia:["AS8359 MTS","AS12389 ROSTELECOM","AS31133 MF-MGSM","AS42610 NCNET"],"북한":["AS131279 STAR-KP","AS9769 DPRK-AS","AS17762 KPTC-AS"],"North Korea":["AS131279 STAR-KP","AS9769 DPRK-AS","AS17762 KPTC-AS"],"이란":["AS44244 IRANCELL","AS6736 BARIN","AS197207 MCCI","AS58224 TCI"],Iran:["AS44244 IRANCELL","AS6736 BARIN","AS197207 MCCI","AS58224 TCI"],"미국":["AS15169 GOOGLE","AS8075 MICROSOFT","AS16509 AMAZON","AS32934 FACEBOOK"],"United States":["AS15169 GOOGLE","AS8075 MICROSOFT","AS16509 AMAZON","AS32934 FACEBOOK"],"일본":["AS2516 KDDI","AS4713 NTT","AS2497 IIJ","AS7506 GMO"],Japan:["AS2516 KDDI","AS4713 NTT","AS2497 IIJ","AS7506 GMO"],"독일":["AS3320 DEUTSCHE","AS8881 1&1","AS20940 AKAMAI","AS24940 HETZNER"],Germany:["AS3320 DEUTSCHE","AS8881 1&1","AS20940 AKAMAI","AS24940 HETZNER"],"영국":["AS2856 BT","AS5089 VIRGIN","AS12576 EE","AS13037 ZEN"],"United Kingdom":["AS2856 BT","AS5089 VIRGIN","AS12576 EE","AS13037 ZEN"],"대한민국":["AS9318 SKB","AS4766 KT","AS9644 LGU","AS17858 LG-DACOM"],"South Korea":["AS9318 SKB","AS4766 KT","AS9644 LGU","AS17858 LG-DACOM"],Burundi:["AS37578 AS-KONNECT","AS37054 USAN","AS36945 ONATEL"],default:["AS0 UNKNOWN"]},r=t[e.name]||t.default;return r[Math.floor(Math.random()*r.length)]},z=(e,t)=>e&&t?e.find(e=>e.id===t||e.id===t.toString()||e.id===parseInt(t)):null,K=(e,t)=>{if(!e||!e.point)return;const r=t.includes("source");e.point.color=r?G.SOURCE.NORMAL:G.TARGET.NORMAL,e.point.outlineColor=r?G.SOURCE.OUTLINE:G.TARGET.OUTLINE,e.point.outlineWidth=3,e.point.pixelSize=8},P=(e,t)=>{e&&e.point&&(e.point.color=t?G.SOURCE.HIGHLIGHT:G.TARGET.HIGHLIGHT,e.point.outlineColor=G.HIGHLIGHT_OUTLINE,e.point.outlineWidth=4,e.point.pixelSize=12,e.point.disableDepthTestDistance=Number.POSITIVE_INFINITY)},U=e=>{const t=document.getElementById(`log-${e}`);t&&(t.scrollIntoView({behavior:"smooth",block:"center"}),t.style.animation="pulse 1.2s ease-out 1",setTimeout(()=>{t.style.animation=""},1300))},W=async(e=null,t=null)=>{try{let r=`http://localhost:5000${H}?limit=20`;e&&(r+=`&startDate=${e.toISOString()}`),t&&(r+=`&endDate=${t.toISOString()}`);const a=await fetch(r);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const n=await a.json();if(!n.success)return[];const o=n.attacks.map(e=>({id:e.id,source:{name:e.source.name,building:{name:e.source.city||e.source.name,lat:e.source.lat,lon:e.source.lon},ip:e.source.ip,port:e.source.port,subnet:e.source.subnet,gateway:e.source.gateway,dns:e.source.dns,as:_({name:e.source.name})},target:{name:e.target.name,building:{name:e.target.city||"North Korea",lat:e.target.lat,lon:e.target.lon},ip:e.target.ip,port:e.target.port,subnet:e.target.subnet,gateway:e.target.gateway,dns:e.target.dns,as:_({name:"North Korea"})},type:e.protocol,severity:Math.min(5,Math.ceil(e.count/5)),timestamp:new Date(e.timestamp),status:e.status,count:e.count}));return o.forEach((e,t)=>{}),o}catch(r){return[]}},$=()=>{const e=h(),f=p.useRef(null),w=p.useRef(null),k=p.useRef(null),[M,H]=p.useState(!1),[B,_]=p.useState(null),[$,Z]=p.useState([]),[V,J]=p.useState(!1),[q,Y]=p.useState([]),[Q,X]=p.useState([0,7]),ee=p.useMemo(()=>$&&0!==$.length?{total:$.length,active:$.length,blocked:0,countries:new Set([...$.map(e=>e.source.name),...$.map(e=>e.target.name)]).size}:{total:0,active:0,blocked:0,countries:0},[$]),te=p.useMemo(()=>new Date("2025-09-02T00:00:00Z"),[]),re=p.useMemo(()=>new Date("2025-09-08T23:59:59Z"),[]),ae=p.useMemo(()=>{if(!q||0===q.length)return[];const e=te.getTime(),t=e+24*Q[0]*60*60*1e3,r=e+24*Q[1]*60*60*1e3;return q.filter(e=>{const a=new Date(e.timestamp).getTime(),n=a>=t&&a<=r;return q.indexOf(e),n})},[q,Q,te]);p.useEffect(()=>{Z(ae)},[ae]),p.useEffect(()=>{(async()=>{const e=[];for(let r=0;r<7;r++){const t=new Date(Date.UTC(2025,8,2+r,0,0,0,0)),a=new Date(Date.UTC(2025,8,2+r,23,59,59,999));e.push(W(t,a).then(e=>e.slice(0,20).map(e=>({...e,id:`day${r}-${e.id}`}))).catch(e=>[]))}const t=(await Promise.all(e)).flat();t.length,Y(t),X([0,7])})()},[te,re]),p.useEffect(()=>{if(f.current)return(async()=>{try{w.current=new A(f.current,{animation:!1,baseLayerPicker:!0,fullscreenButton:!1,geocoder:!0,homeButton:!1,infoBox:!0,sceneModePicker:!1,scene3DOnly:!1,selectionIndicator:!0,timeline:!1,navigationHelpButton:!1,navigationInstructionsInitiallyVisible:!1,terrainProvider:await I({requestWaterMask:!0,requestVertexNormals:!0}),requestRenderMode:!1,maximumRenderTimeChange:1/0}),w.current.scene.morphTo2D(0);try{const e=await C({style:E.AERIAL_WITH_LABELS});w.current.imageryLayers.addImageryProvider(e)}catch(e){}const t=w.current.scene,r=t.globe;t.skyAtmosphere.show=!0,t.fog.enabled=!0,t.fog.density=1e-4,t.fog.screenSpaceErrorFactor=2,r.enableLighting=!0,r.dynamicAtmosphereLighting=!0,r.atmosphereLightIntensity=10,r.showWaterEffect=!0,r.maximumScreenSpaceError=1,r.tileCacheSize=1e3,t.screenSpaceCameraController.enableRotate=!1,t.screenSpaceCameraController.enableTranslate=!0,t.screenSpaceCameraController.enableZoom=!0,t.screenSpaceCameraController.enableTilt=!1,t.screenSpaceCameraController.enableLook=!1,t.screenSpaceCameraController.enableInputs=!0,t.screenSpaceCameraController.minimumZoomDistance=100,t.screenSpaceCameraController.maximumZoomDistance=4e7,t.screenSpaceCameraController.translateEventTypes=[y.LEFT_DRAG,y.RIGHT_DRAG],t.screenSpaceCameraController.zoomEventTypes=[y.WHEEL,y.PINCH],t.screenSpaceCameraController.zoomFactor=5,t.screenSpaceCameraController.wheelZoomFactor=10,t.screenSpaceCameraController.inertiaSpin=.95,t.screenSpaceCameraController.inertiaTranslate=.95,t.screenSpaceCameraController.inertiaZoom=.9,t.camera.moveEnd.addEventListener(()=>{const e=t.camera.positionCartographic.height;if(e>=38e6){const r=t.camera.positionCartographic,a=125.7625,n=0,o=Math.abs(b.toDegrees(r.longitude)-a),i=Math.abs(b.toDegrees(r.latitude)-n);(o>30||i>30)&&t.camera.flyTo({destination:S.fromDegrees(a,n,e),orientation:{heading:0,pitch:-b.PI_OVER_TWO,roll:0},duration:1})}}),w.current.cesiumWidget.creditContainer.style.display="none",w.current.screenSpaceEventHandler.setInputAction(e=>{const r=w.current.camera.pickEllipsoid(e.position,t.globe.ellipsoid);if(r){const e=x.fromCartesian(r);b.toDegrees(e.longitude),b.toDegrees(e.latitude),e.height}},m.LEFT_CLICK);const a={destination:S.fromDegrees(125.7625,39.0392,5e6),orientation:{heading:0,pitch:-b.PI_OVER_TWO,roll:0}};setTimeout(()=>{w.current.camera.setView(a)},500),w.current.homeButton.viewModel.command.beforeExecute.addEventListener(e=>{e.cancel=!0,w.current.camera.setView(a)}),T.supportsImageRenderingPixelated()&&(w.current.resolutionScale=window.devicePixelRatio),t.postProcessStages.fxaa.enabled=!0,w.current.clock.shouldAnimate=!0,w.current.clock.multiplier=1,w.current.clock.currentTime=v.now(),t.requestRenderMode=!1,t.maximumRenderTimeChange=1/0;let n=null;const o=()=>{w.current&&!w.current.isDestroyed()&&(t.requestRender(),n=requestAnimationFrame(o))};o();const i=setInterval(()=>{w.current&&!w.current.isDestroyed()&&w.current.clock.tick()},16);w.current._cleanupIds={animationFrameId:n,clockIntervalId:i},H(!0)}catch(e){_(`Cesium 초기화 실패: ${e.message}`)}})(),()=>{w.current&&(w.current._cleanupIds&&(w.current._cleanupIds.animationFrameId&&cancelAnimationFrame(w.current._cleanupIds.animationFrameId),w.current._cleanupIds.clockIntervalId&&clearInterval(w.current._cleanupIds.clockIntervalId)),w.current.destroy(),w.current=null)}},[]);const[ne,oe]=p.useState([]),[ie,se]=p.useState(null),[le,ce]=p.useState([]),[de,ue]=p.useState([]),[pe,he]=p.useState([]),ge=p.useCallback(()=>{if(!w.current)return;const e=w.current.entities.values;for(let t=0;t<e.length;t++){const r=e[t];if(r&&r.id){const e=r.id;(e.startsWith("source-2d-")||e.startsWith("target-2d-"))&&K(r,e)}}ue([]),he([])},[]),me=p.useCallback(e=>{if(!w.current||!$)return;const t=z($,e);if(!t)return;de.forEach(e=>{const t=w.current.entities.getById(e);t&&K(t,e)});const r=`target-2d-${t.id}`,a=`source-2d-${t.id}`,n=w.current.entities.getById(r),o=w.current.entities.getById(a),i=[];n&&(P(n,!1),i.push(r)),o&&(P(o,!0),i.push(a)),ue(i)},[$,de]),xe=p.useCallback((e,t)=>{if(!w.current||!$)return;ge();const r=t.includes("target"),a=r?e.target.building.name:e.source.building.name,n=r?$.filter(e=>e.target.building.name===a):$.filter(e=>e.source.building.name===a);if(0===n.length)return;const o=[];n.forEach(e=>{const t=`source-2d-${e.id}`,r=`target-2d-${e.id}`,a=w.current.entities.getById(t),n=w.current.entities.getById(r);a&&(P(a,!0),o.push(t)),n&&(P(n,!1),o.push(r))}),he(o);const i=n.map(e=>e.id);ce(i),se(null),n.length>0&&U(n[0].id)},[$,ge]);return p.useCallback((e,t)=>{if(!w.current||!$)return;ge();const r=t.includes("source")?e.source.ip:e.target.ip,a=$.filter(e=>e.source.ip===r||e.target.ip===r);if(a.length>0){const e=[];a.forEach(t=>{const a=`source-2d-${t.id}`,n=`target-2d-${t.id}`,o=w.current.entities.getById(a),i=w.current.entities.getById(n);o&&t.source.ip===r&&(P(o,!0),e.push(a)),i&&t.target.ip===r&&(P(i,!1),e.push(n))}),he(e);const t=a.map(e=>e.id);ce(t),se(null),a.length>0&&U(a[0].id)}},[$,ge]),p.useEffect(()=>{if(w.current&&M&&$&&0!==$.length){try{w.current.entities.removeAll(),ne.forEach(e=>{e.interval&&clearInterval(e.interval)}),oe([]),(e=>{if(w.current&&e&&0!==e.length)try{e.forEach((e,t)=>{const r=parseFloat(e.source.building.lon),a=parseFloat(e.source.building.lat),n=parseFloat(e.target.building.lon),o=parseFloat(e.target.building.lat);if(isNaN(r)||isNaN(a)||isNaN(n)||isNaN(o))return;const i=S.fromDegrees(r,a,0),s=S.fromDegrees(n,o,0);w.current.entities.add({id:`source-2d-${e.id}`,position:i,point:{pixelSize:8,color:G.SOURCE.NORMAL,outlineColor:G.SOURCE.OUTLINE,outlineWidth:3,heightReference:N.NONE,disableDepthTestDistance:Number.POSITIVE_INFINITY,show:!0},buildingData:{name:e.source.building.name,country:e.source.name,type:"source"}}),w.current.entities.add({id:`target-2d-${e.id}`,position:s,point:{pixelSize:8,color:G.TARGET.NORMAL,outlineColor:G.TARGET.OUTLINE,outlineWidth:3,heightReference:N.NONE,disableDepthTestDistance:Number.POSITIVE_INFINITY,show:!0},buildingData:{name:e.target.building.name,country:e.target.name,type:"target"}}),w.current.entities.add({id:`beam-2d-${e.id}`,polyline:{positions:[i,s],width:6,material:new j({glowPower:.05,color:new L(e=>{const t=v.secondsDifference(e,w.current.clock.startTime)%2,r=.15+.05*Math.sin(t*Math.PI);return D.RED.withAlpha(r)},!1)}),clampToGround:!1,followSurface:!1,granularity:b.RADIANS_PER_DEGREE},description:`🔴 사이버 작전: ${e.source.name} → ${e.target.name}`,attackData:e})})}catch(t){}})($)}catch(e){}w.current.screenSpaceEventHandler&&(w.current.screenSpaceEventHandler.removeInputAction(m.LEFT_CLICK),w.current.screenSpaceEventHandler.removeInputAction(m.LEFT_DOUBLE_CLICK)),w.current.screenSpaceEventHandler.setInputAction(t=>{try{const e=w.current.scene.pick(t.position);if(e&&e.id){let t=null;e.id.id?t=e.id.id:e.id._id?t=e.id._id:"string"==typeof e.id&&(t=e.id),ge();const r=t&&t.startsWith("source-2d-"),a=t&&t.startsWith("target-2d-");if(r||a){let e=null;if(t.startsWith("source-2d-")?e=t.replace("source-2d-",""):t.startsWith("target-2d-")&&(e=t.replace("target-2d-","")),e){const r=z($,e);if(r)return void xe(r,t)}}}se(null),ce([]),ge()}catch(e){}},m.LEFT_CLICK),w.current.screenSpaceEventHandler.setInputAction(t=>{try{const e=w.current.scene.pick(t.position);if(e&&e.id){let t=null;e.id.id?t=e.id.id:e.id._id?t=e.id._id:"string"==typeof e.id&&(t=e.id);const r=t&&t.startsWith("source-2d-"),a=t&&t.startsWith("target-2d-");if(r||a){const e=w.current.entities.getById(t);if(e&&e.position){const t=e.position.getValue(w.current.clock.currentTime);if(t){const e=x.fromCartesian(t),r=b.toDegrees(e.longitude),a=b.toDegrees(e.latitude);w.current.camera.flyTo({destination:S.fromDegrees(r,a,5e4),duration:1.5,complete:()=>{w.current.scene.screenSpaceCameraController.enableInputs=!0}})}}}}}catch(e){}},m.LEFT_DOUBLE_CLICK)}},[$,M]),B?t.jsxs(r,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",bgcolor:"#f5f5f5",borderRadius:2,p:2},children:[t.jsx(a,{color:"error",sx:{mb:2,textAlign:"center"},children:B}),t.jsxs(a,{variant:"body2",sx:{textAlign:"center",color:"text.secondary"},children:["1. https://cesium.com/ion/ 방문",t.jsx("br",{}),"2. 무료 계정 생성",t.jsx("br",{}),"3. Access Token 발급",t.jsx("br",{}),"4. EarthGlobe.jsx 파일의 토큰 교체"]})]}):t.jsxs(n,{component:"main",role:"main","aria-label":"2D 지도 기반 사이버 공격 시각화",sx:{width:"100%",height:"calc(100vh - 120px)",bgcolor:"background.paper",boxShadow:3,m:0},children:[t.jsxs(o,{sx:{p:1,height:"100%","&:last-child":{pb:1},display:"flex",flexDirection:{xs:"column",lg:"row"},gap:1,overflow:"hidden"},children:[t.jsx(n,{component:"section","aria-label":"2D 지도 영역",sx:{flex:1,position:"relative",overflow:"hidden",height:"100%",bgcolor:"#000",border:"1px solid #333",boxShadow:"0 4px 12px rgba(0,0,0,0.3)"},children:t.jsxs(o,{sx:{p:0,height:"100%","&:last-child":{pb:0},position:"relative"},children:[t.jsx(i,{size:"small","aria-label":"3D 멀티레이어로 이동",title:"3D 멀티레이어로 이동",onClick:()=>e("/CyberObjectInfo/MultilayerVisualization"),sx:{position:"absolute",top:8,right:165,zIndex:1e3,bgcolor:"rgba(124,58,237,0.8)",color:"#fff",borderRadius:"50%",width:32,height:32,boxShadow:"0 2px 8px rgba(124,58,237,0.3)","&:hover":{bgcolor:"#9333ea",color:"#fff"}},children:t.jsx(R,{style:{fontSize:18}})}),t.jsx("div",{ref:f,role:"img","aria-label":"사이버 공격 경로를 표시하는 2D 지도",style:{width:"100%",height:"100%"}}),!M&&t.jsx(r,{role:"status","aria-live":"polite","aria-label":"지도 로딩 중",sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"rgba(0,0,0,0.8)",color:"white"},children:t.jsx(a,{children:"2D 모드 로딩 중..."})}),M&&t.jsx(r,{sx:{position:"absolute",top:8,left:8,background:"rgba(0,0,0,0.7)",color:"white",padding:"4px 8px",borderRadius:1,fontSize:10},children:t.jsx(a,{variant:"caption",color:"inherit",children:"🗺️ Osint 정보 수집"})}),M&&t.jsx(i,{size:"small","aria-label":"융합 데이터베이스 열기",title:"융합 데이터베이스 열기",onClick:()=>J(!0),sx:{position:"absolute",bottom:5,left:"98.5%",transform:"translateX(-50%)",zIndex:1e3,bgcolor:"rgba(124,58,237,0.8)",color:"#fff",borderRadius:"50%",width:48,height:48,boxShadow:"0 4px 12px rgba(124,58,237,0.5)","&:hover":{bgcolor:"#9333ea",color:"#fff",transform:"translateX(-50%) scale(1.1)"},transition:"all 0.3s ease"},children:t.jsx(O,{style:{fontSize:24}})})]})}),t.jsxs(r,{component:"aside","aria-label":"공격 현황 패널",sx:{width:{xs:"100%",lg:350},maxWidth:{xs:"100%",lg:400},display:"flex",flexDirection:"column",gap:2,height:"100%",overflow:"hidden"},children:[t.jsx(n,{component:"section","aria-label":"실시간 공격 통계",sx:{bgcolor:"#f0edfd",color:"#333",border:"1px solid #d0c9f0",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",minHeight:0,flexShrink:0},children:t.jsx(o,{children:t.jsxs(s,{container:!0,spacing:2,children:[t.jsx(s,{item:!0,xs:6,children:t.jsxs(r,{sx:{textAlign:"center"},children:[t.jsx(a,{variant:"h4",sx:{color:"#7c3aed",fontWeight:"bold"},"aria-label":`총 작전 수 ${ee.total}개`,children:ee.total}),t.jsx(a,{variant:"body2",sx:{color:"#666"},children:"총 작전 수"})]})}),t.jsx(s,{item:!0,xs:6,children:t.jsxs(r,{sx:{textAlign:"center"},children:[t.jsx(a,{variant:"h4",sx:{color:"#9333ea",fontWeight:"bold"},"aria-label":`활성 작전 ${ee.active}개`,children:ee.active}),t.jsx(a,{variant:"body2",sx:{color:"#666"},children:"활성 작전"})]})})]})})}),t.jsx(n,{component:"section","aria-label":"최근 공격 목록",sx:{bgcolor:"transparent",color:"#333",flex:1,minHeight:0,border:"none",boxShadow:"none",display:"flex",flexDirection:"column"},children:t.jsx(o,{sx:{height:"100%",display:"flex",flexDirection:"column",flex:1,"&:last-child":{pb:2}},children:t.jsx(r,{ref:k,role:"list","aria-label":"공격 로그 목록",sx:{flex:1,overflow:"auto",minHeight:0},children:$&&$.map((n,o)=>t.jsxs(r,{id:`log-${n.id}`,"data-attack-id":n.id,role:"listitem",tabIndex:0,"aria-label":`공격 정보: ${n.type}, ${n.source.name}에서 ${n.target.name}로, 출발지 IP ${n.source.ip}`,"aria-selected":ie===n.id||le.includes(n.id),sx:{p:1,mb:1,bgcolor:ie===n.id||le.includes(n.id)?"rgba(124,58,237,0.2)":"rgba(124,58,237,0.05)",borderRadius:1,borderLeft:"3px solid #7c3aed",border:ie===n.id||le.includes(n.id)?"2px solid #7c3aed":"none",boxShadow:ie===n.id||le.includes(n.id)?"0 0 10px rgba(124,58,237,0.4)":"none",animation:ie===n.id||le.includes(n.id)?"pulse 1.5s infinite":"none",cursor:"pointer",transition:"all 0.3s ease",position:"relative"},onClick:()=>{const e=ie===n.id?null:n.id;se(e),ce([]),e?(ge(),me(n.id)):ge()},children:[t.jsxs(a,{variant:"body2",sx:{fontWeight:"bold",color:"#333"},children:["🔴 ",n.type," - 진행중"]}),t.jsxs(a,{variant:"caption",sx:{color:"#666"},children:[n.source.name," → ",n.target.name]}),t.jsxs(a,{variant:"caption",sx:{display:"block",color:"#888",fontSize:"10px"},children:["출발지 IP: ",n.source.ip,":",n.source.port]}),t.jsxs(a,{variant:"caption",sx:{display:"block",color:"#888",fontSize:"10px"},children:["대상 IP: ",n.target.ip,":",n.target.port]}),t.jsxs(a,{variant:"caption",sx:{display:"block",color:"#888",fontSize:"10px"},children:["Subnet: ",n.target.subnet," | Gateway: ",n.target.gateway]}),t.jsxs(a,{variant:"caption",sx:{display:"block",color:"#888",fontSize:"10px"},children:["DNS: ",n.target.dns," | Count: ",n.count]}),t.jsx(a,{variant:"caption",sx:{display:"block",color:"#888",fontSize:"10px"},children:n.timestamp.toLocaleString("ko-KR",{timeZone:"Asia/Seoul",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}),t.jsx(i,{size:"small","aria-label":"내부망 토폴로지로 이동",title:"내부망 토폴로지로 이동",onClick:t=>{t.stopPropagation(),e("/ExtInt/internaltopology")},sx:{position:"absolute",top:4,right:4,color:"#7c3aed",bgcolor:"rgba(124,58,237,0.1)",border:"1px solid rgba(124,58,237,0.3)","&:hover":{bgcolor:"rgba(124,58,237,0.2)",color:"#9333ea"},width:24,height:24},children:t.jsx(R,{style:{fontSize:12}})})]},n.id))})})}),t.jsx(n,{component:"section","aria-label":"날짜 범위 필터링 컨트롤",sx:{bgcolor:"#f0edfd",color:"#333",border:"1px solid #d0c9f0",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",flexShrink:0,minHeight:0},children:t.jsxs(o,{children:[t.jsx(a,{variant:"body2",component:"h3",sx:{mb:1,fontWeight:"bold",color:"#7c3aed"},children:"날짜 범위 필터링"}),t.jsx(a,{variant:"caption",sx:{display:"block",mb:1,color:"#666"},children:(()=>{const e=new Date(te);e.setDate(e.getDate()+Q[0]);const t=new Date(te);return t.setDate(t.getDate()+Q[1]-1),`${e.toLocaleDateString("ko-KR")} ~ ${t.toLocaleDateString("ko-KR")} (${Q[1]-Q[0]}일)`})()}),t.jsx(l,{"aria-label":"날짜 범위 선택",value:Q,onChange:(e,t)=>X(t),min:0,max:7,step:1,marks:[{value:0,label:"9/2"},{value:1,label:"9/3"},{value:2,label:"9/4"},{value:3,label:"9/5"},{value:4,label:"9/6"},{value:5,label:"9/7"},{value:6,label:"9/8"},{value:7,label:"9/9"}],valueLabelDisplay:"auto",valueLabelFormat:e=>{const t=new Date(te);return t.setDate(t.getDate()+e),t.toLocaleDateString("ko-KR",{month:"short",day:"numeric"})},sx:{color:"#7c3aed","& .MuiSlider-thumb":{backgroundColor:"#7c3aed","&:hover, &.Mui-focusVisible":{boxShadow:"0 0 0 8px rgba(124,58,237, 0.16)"}},"& .MuiSlider-track":{backgroundColor:"#7c3aed"},"& .MuiSlider-rail":{backgroundColor:"#d0c9f0"},"& .MuiSlider-mark":{backgroundColor:"#b8aee0"},"& .MuiSlider-markLabel":{color:"#666",fontSize:"9px"},"& .MuiSlider-valueLabel":{backgroundColor:"#7c3aed",color:"#fff"}}}),t.jsxs(a,{variant:"caption",sx:{display:"block",mt:1,color:"#888",fontSize:"10px"},children:["표시된 작전: ",$.length,"개 / 전체: ",q.length,"개 (하루당 최대 20개)"]})]})}),t.jsx(n,{component:"section","aria-label":"지도 범례",sx:{bgcolor:"#f0edfd",color:"#333",border:"1px solid #d0c9f0",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",flexShrink:0,minHeight:0},children:t.jsx(o,{children:t.jsxs(r,{component:"ul",role:"list",sx:{display:"flex",flexDirection:"column",gap:1,listStyle:"none",p:0,m:0},children:[t.jsxs(r,{component:"li",sx:{display:"flex",alignItems:"center",gap:1},children:[t.jsx(r,{"aria-hidden":"true",sx:{width:12,height:12,borderRadius:"50%",bgcolor:"#FFFF00",border:"2px solid #FF0000"}}),t.jsx(a,{variant:"caption",sx:{color:"#666"},children:"공격 출발지"})]}),t.jsxs(r,{component:"li",sx:{display:"flex",alignItems:"center",gap:1},children:[t.jsx(r,{"aria-hidden":"true",sx:{width:12,height:12,borderRadius:"50%",bgcolor:"#00FFFF",border:"2px solid #0000FF"}}),t.jsx(a,{variant:"caption",sx:{color:"#666"},children:"공격 목표지"})]}),t.jsxs(r,{component:"li",sx:{display:"flex",alignItems:"center",gap:1},children:[t.jsx(r,{"aria-hidden":"true",sx:{width:20,height:2,bgcolor:"#FF0000",borderRadius:1,boxShadow:"0 0 4px #FF0000"}}),t.jsx(a,{variant:"caption",sx:{color:"#666"},children:"🔴 사이버 작전"})]})]})})})]})]}),t.jsxs(c,{open:V,onClose:()=>J(!1),maxWidth:"lg",fullWidth:!0,PaperProps:{sx:{height:"80vh",maxHeight:"80vh",m:0}},children:[t.jsxs(d,{sx:{m:0,p:2,bgcolor:"#f0edfd",borderBottom:"2px solid #39306b",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(a,{variant:"h6",sx:{color:"#39306b",fontWeight:"bold"},children:"융합 데이터베이스 구축"}),t.jsx(i,{"aria-label":"닫기",onClick:()=>J(!1),sx:{color:"#39306b","&:hover":{bgcolor:"rgba(57, 48, 107, 0.1)"}},children:t.jsx(F,{})})]}),t.jsx(u,{sx:{p:0,height:"calc(100% - 64px)"},children:t.jsx(g,{open:V})})]})]})};export{$ as default};
