const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/index-DUFM6D8K.js","assets/js/mui-vendor-BDHQmYi7.js","assets/js/react-vendor-ClEFeRSO.js","assets/js/vis-network-CqERLR1V.js","assets/js/index-DkeeQhvO.js","assets/js/chart-vendor-CeJ1_NXY.js","assets/js/three-vendor-CtB2SH65.js","assets/css/index-vnMvSBSu.css","assets/js/ConsoleView-aonTYntr.js","assets/js/index-CGnjLyDv.js","assets/js/DataTable-CmQ9Ga0u.js","assets/js/TrendChart-BIFMg5Uo.js","assets/js/EventLog-CqnQRdSM.js","assets/js/ClusterOutlined-zSYz1TSF.js"])))=>i.map(i=>d[i]);
import{u as e,e as t,f as o,_ as r}from"./index-DkeeQhvO.js";import{j as i,o as s,t as a,B as n,I as l,a5 as c,a6 as d}from"./mui-vendor-BDHQmYi7.js";import{c as p,u as x,a as h}from"./react-vendor-ClEFeRSO.js";import{C as f}from"./ConsoleView-aonTYntr.js";function g(e,t,o){return"number"!=typeof e||isNaN(e)||t===o?1:Math.round(1+99*(e-t)/(o-t))}p.memo(({dbTitle:e,dbValue:t,dbSubtext:o,className:r})=>{const s=e||"Default Title",a=t||"Default Value",n=o||"Default Subtext";return i.jsxs("div",{className:r,children:[i.jsx("div",{className:"statistics-card-value",children:a}),i.jsx("div",{className:"statistics-card-title",children:s}),i.jsx("div",{className:"statistics-card-subtext",children:n})]})}).displayName="StatisticsCard";const u=e=>{if(!e)return[];const t=new Set;return e.forEach(e=>{[e.src_IP,e.dst_IP].forEach(e=>{e&&e.type&&t.add(e.type)})}),Array.from(t).sort()},m=({open:e=!0,isPopup:t=!1})=>i.jsx(f,{type:"targetIdentification",open:e,isPopup:t}),b=({open:e=!0,isPopup:t=!1})=>i.jsx(f,{type:"targetPriority",open:e,isPopup:t}),_=h.lazy(()=>r(()=>import("./index-DUFM6D8K.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),j=h.lazy(()=>r(()=>import("./index-CGnjLyDv.js"),__vite__mapDeps([9,4,1,2,5,6,7,8])));h.lazy(()=>r(()=>import("./DataTable-CmQ9Ga0u.js"),__vite__mapDeps([10,1,2,4,5,6,7,8]))),h.lazy(()=>r(()=>import("./TrendChart-BIFMg5Uo.js"),__vite__mapDeps([11,1,2,5])));const y=h.lazy(()=>r(()=>import("./EventLog-CqnQRdSM.js"),__vite__mapDeps([12,1,2,13,4,5,6,7]))),P=()=>i.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",color:"#666"},children:"Loading..."}),v=Object.freeze(Object.defineProperty({__proto__:null,default:function({onNodeClick:r,data:f,logs:g=[],activeView:v="target"}){const I=x(),[w,S]=h.useState(f||[]),[C,E]=h.useState([]),[k,D]=h.useState({}),[z,N]=h.useState(g),[M,T]=h.useState(null),{popups:A,openPopup:R,closePopup:V}=e(),L=A.targetIdentification,O=A.targetPriority;h.useEffect(()=>{A.targetIdentification||A.targetPriority},[A.targetIdentification,A.targetPriority]);const W=h.useMemo(()=>Array.isArray(w)?w:w?.nodes||w?.network||[],[w]),F=h.useMemo(()=>W.map(e=>({degree_score:e.src_IP?.degree_score||e.dst_IP?.degree_score||0,con_score:e.src_IP?.con_score||e.dst_IP?.con_score||0})),[W]),H=h.useMemo(()=>{const e=new Set;C.forEach(t=>{t.src_IP&&t.src_IP.ip&&e.add(t.src_IP.ip)});let t=0,o=0;e.forEach(e=>{const r=C.find(t=>t.src_IP&&t.src_IP.ip===e)?.src_IP;r&&"number"==typeof r.degree_score&&(r.degree_score>.5?t+=1:r.degree_score>0&&r.degree_score<=.5&&(o+=1))});const r={};C.forEach(e=>{[e.src_IP,e.dst_IP].forEach(e=>{e&&e.type&&(r[e.type]=(r[e.type]||0)+1)})});const i=[...W.map(e=>e.src_IP?.degree_score),...W.map(e=>e.dst_IP?.degree_score)].filter(e=>"number"==typeof e),s=[...W.map(e=>e.src_IP?.con_score),...W.map(e=>e.dst_IP?.con_score)].filter(e=>"number"==typeof e);return{directCurrent:t,indirectCurrent:o,typeCountMap:r,degreeScoreAvg:i.length?(i.reduce((e,t)=>e+t,0)/i.length).toFixed(3):"-",degreeScoreMax:i.length?Math.max(...i).toFixed(3):"-",conScoreAvg:s.length?(s.reduce((e,t)=>e+t,0)/s.length).toFixed(3):"-",conScoreMax:s.length?Math.max(...s).toFixed(3):"-",uniqueTypes:u(W).length}},[C,W]);h.useMemo(()=>[{category:"direct",current:H.directCurrent,total:H.directCurrent},{category:"indirect",current:H.indirectCurrent,total:H.indirectCurrent},...Object.entries(H.typeCountMap).map(([e,t])=>({category:e,current:t,total:t}))],[H]),p.useEffect(()=>{f?S(f):fetch("http://localhost:8000/neo4j/nodes?activeView=target").then(e=>e.json()).then(S).catch(()=>S([]))},[f]),p.useEffect(()=>{E(W)},[w,W]);const q=h.useCallback((e,t)=>{D(e),E(t)},[]),B=h.useCallback(e=>{T(e);const t={type:"node-click",message:`노드 클릭: ${e.label||e.id}`,connectedCount:e.connectedCount,connectedIps:e.connectedIps,dbInfo:e.dbInfo,timestamp:(new Date).toLocaleTimeString()};N([t]),r&&r(e)},[r]);return h.useCallback(()=>{M?I("/ActiveResponse/responseeffectvisualization",{state:{selectedNode:M}}):alert("먼저 노드를 선택해주세요.")},[I,M]),i.jsxs(s,{component:"main",role:"main","aria-label":"타겟 대시보드",sx:{width:"100%",height:"calc(100vh - 120px)",bgcolor:"background.paper",boxShadow:3,m:0},children:[i.jsxs(a,{sx:{p:1,height:"100%","&:last-child":{pb:1},display:"flex",flexDirection:{xs:"column",lg:"row"},gap:1,overflow:"hidden"},children:[i.jsx(n,{component:"aside","aria-label":"필터 조건 패널",sx:{width:{xs:"100%",lg:300},maxWidth:{xs:"100%",lg:300},display:"flex",flexDirection:"column",gap:2,flexShrink:0,overflow:"hidden"},children:i.jsx(s,{component:"section","aria-label":"필터 조건",sx:{flex:1,bgcolor:"#f0edfd",overflow:"auto",minHeight:0,borderRadius:"12px",boxShadow:"0 2px 8px rgba(57, 48, 107, 0.07)"},children:i.jsx(a,{sx:{height:"100%",display:"flex",flexDirection:"column",p:1.5,"&:last-child":{pb:1.5}},children:i.jsx(h.Suspense,{fallback:i.jsx(P,{}),children:i.jsx(j,{onConditionChange:q,data:W,trendData:F})})})})}),i.jsx(n,{component:"section","aria-label":"대시보드 메인 콘텐츠",sx:{flex:1,display:"flex",flexDirection:"column",gap:2,minWidth:0,overflow:"hidden"},children:i.jsx(s,{component:"section","aria-label":"네트워크 그래프 영역",sx:{flex:1,bgcolor:"#f0edfd",overflow:"hidden",minWidth:0,borderRadius:"12px",boxShadow:"0 2px 8px rgba(57, 48, 107, 0.07)"},children:i.jsx(a,{sx:{p:0,height:"100%","&:last-child":{pb:0}},children:i.jsx(h.Suspense,{fallback:i.jsx(P,{}),children:i.jsx(_,{dbNodes:C,onNodeClick:B})})})})}),i.jsx(n,{component:"aside","aria-label":"이벤트 로그 패널",sx:{width:{xs:"100%",lg:300},maxWidth:{xs:"100%",lg:320},display:"flex",flexDirection:"column",gap:2,flexShrink:0,overflow:"hidden"},children:i.jsx(s,{component:"section","aria-label":"이벤트 로그",sx:{flex:1,bgcolor:"#f0edfd",overflow:"auto",minHeight:0,borderRadius:"12px",boxShadow:"0 2px 8px rgba(57, 48, 107, 0.07)"},children:i.jsx(a,{sx:{height:"100%",display:"flex",flexDirection:"column","&:last-child":{pb:2}},children:i.jsx(h.Suspense,{fallback:i.jsx(P,{}),children:i.jsx(y,{logs:z,activeView:v,selectedNode:M})})})})})]}),i.jsx(l,{size:"small","aria-label":"네트워크 구조 분석 및 표적 식별",title:"네트워크 구조 분석 및 표적 식별",onClick:()=>R("targetPriority"),sx:{position:"absolute",bottom:40,right:100,zIndex:1e3,bgcolor:"rgba(124,58,237,0.8)",color:"#fff",borderRadius:"50%",width:48,height:48,boxShadow:"0 4px 12px rgba(124,58,237,0.5)","&:hover":{bgcolor:"#9333ea",color:"#fff",transform:"scale(1.1)"},transition:"all 0.3s ease"},children:i.jsx(t,{style:{fontSize:24}})}),i.jsx(l,{size:"small","aria-label":"핵심 표적 점수 분석",title:"핵심 표적 점수 분석",onClick:()=>R("targetPriority"),sx:{position:"absolute",bottom:40,right:40,zIndex:1e3,bgcolor:"rgba(124,58,237,0.8)",color:"#fff",borderRadius:"50%",width:48,height:48,boxShadow:"0 4px 12px rgba(124,58,237,0.5)","&:hover":{bgcolor:"#9333ea",color:"#fff",transform:"scale(1.1)"},transition:"all 0.3s ease"},children:i.jsx(o,{style:{fontSize:24}})}),i.jsxs(c,{open:L,onClose:()=>V("targetIdentification"),maxWidth:"md",fullWidth:!0,PaperProps:{sx:{height:"70vh",maxHeight:"70vh",m:0,position:"relative",overflow:"hidden"}},children:[i.jsx(l,{onClick:()=>V("targetIdentification"),sx:{position:"absolute",right:23,top:8.5,color:"#000000ff",zIndex:1,bgcolor:"#cac7d4ff","&:hover":{bgcolor:"#39306b",color:"#ffffffff"}},children:"✕"}),i.jsx(d,{sx:{p:0,height:"100%",overflow:"hidden"},children:i.jsx(m,{open:L,isPopup:!0})})]}),i.jsxs(c,{open:O,onClose:()=>V("targetPriority"),maxWidth:"md",fullWidth:!0,PaperProps:{sx:{height:"70vh",maxHeight:"70vh",m:0,position:"relative",overflow:"hidden"}},children:[i.jsx(l,{onClick:()=>V("targetPriority"),sx:{position:"absolute",right:23,top:8.5,color:"#666",zIndex:1,bgcolor:"#cac7d4ff","&:hover":{bgcolor:"rgba(255,255,255,1)",color:"#000"}},children:"✕"}),i.jsx(d,{sx:{p:0,height:"100%",overflow:"hidden"},children:i.jsx(b,{open:O,isPopup:!0})})]})]})}},Symbol.toStringTag,{value:"Module"}));export{u as e,v as i,g as n};
